const _0x53c22b=_0x527f;(function(_0x51fc49,_0x4ac870){const _0x417df8=_0x527f,_0x5e5dd2=_0x51fc49();while(!![]){try{const _0x1965f1=-parseInt(_0x417df8(0x157))/0x1+parseInt(_0x417df8(0x150))/0x2*(-parseInt(_0x417df8(0x151))/0x3)+parseInt(_0x417df8(0x18a))/0x4+parseInt(_0x417df8(0x1ee))/0x5*(parseInt(_0x417df8(0x199))/0x6)+-parseInt(_0x417df8(0x1ea))/0x7*(parseInt(_0x417df8(0x15f))/0x8)+parseInt(_0x417df8(0x1e8))/0x9*(parseInt(_0x417df8(0x17a))/0xa)+parseInt(_0x417df8(0x191))/0xb;if(_0x1965f1===_0x4ac870)break;else _0x5e5dd2['push'](_0x5e5dd2['shift']());}catch(_0x987b22){_0x5e5dd2['push'](_0x5e5dd2['shift']());}}}(_0xa4f2,0xb2e4f));const firebaseConfig={'apiKey':_0x53c22b(0x16b),'authDomain':_0x53c22b(0x16c),'databaseURL':_0x53c22b(0x1ce),'projectId':_0x53c22b(0x1d7),'storageBucket':_0x53c22b(0x161),'messagingSenderId':_0x53c22b(0x200),'appId':_0x53c22b(0x1b9),'measurementId':_0x53c22b(0x1d6)};firebase[_0x53c22b(0x1d2)](firebaseConfig);const db=firebase['database'](),roomUsers={};let messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math[_0x53c22b(0x1f7)]()[_0x53c22b(0x18e)](0x24)[_0x53c22b(0x1ca)](0x2,0x9),lastActivity=Date[_0x53c22b(0x1e3)](),typingTimeout,gr8stg='';const STATIC_ROOM=_0x53c22b(0x197),MAX_MESSAGES=0xfa,sound=new Audio(_0x53c22b(0x1a0));sound['volume']=0.3;let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x972696=_0x53c22b,_0x1778ba=db[_0x972696(0x201)](_0x972696(0x159)+roomCode+'/'+sanitizeUsername(username));return _0x1778ba[_0x972696(0x154)]('value')['then'](_0x2b67a5=>{const _0xefd3ca=_0x972696;isRoomAdmin=_0x2b67a5[_0xefd3ca(0x1de)]();});}function toggleRecording(){const _0x3ae648=_0x53c22b;isRecording?stopRecording():navigator['mediaDevices'][_0x3ae648(0x19d)]({'audio':!![]})['then'](_0x2e342f=>{const _0x3be746=_0x3ae648;mediaRecorder=new MediaRecorder(_0x2e342f),mediaRecorder['start'](),isRecording=!![],document['getElementById'](_0x3be746(0x1b2))['innerText']='⏹️',audioChunks=[],mediaRecorder[_0x3be746(0x188)]=_0x1b84dc=>audioChunks[_0x3be746(0x19b)](_0x1b84dc[_0x3be746(0x1b7)]),mediaRecorder[_0x3be746(0x19a)]=()=>{const _0x58fa9a=_0x3be746;clearTimeout(recordingTimer);const _0x4c02d9=new Blob(audioChunks,{'type':_0x58fa9a(0x1fd)}),_0x182129=new FileReader();_0x182129[_0x58fa9a(0x1f0)]=()=>{const _0x5e66a0=_0x58fa9a,_0xcbf069=_0x182129[_0x5e66a0(0x14a)][_0x5e66a0(0x19e)](',')[0x1],_0x4319c3=db[_0x5e66a0(0x201)]()[_0x5e66a0(0x19b)]()[_0x5e66a0(0x17c)];db[_0x5e66a0(0x201)]('rooms/'+roomCode+_0x5e66a0(0x182)+_0x4319c3)[_0x5e66a0(0x1d5)]({'msg':'[Voice\x20message]','audioBase64':_0xcbf069,'sender':username,'senderId':clientId,'timestamp':Date[_0x5e66a0(0x1e3)]()});},_0x182129['readAsDataURL'](_0x4c02d9);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0x3ae648(0x1eb)](_0x1baa88=>{alert('Microphone\x20permission\x20denied.');});}function stopRecording(){const _0x5a275b=_0x53c22b;mediaRecorder&&isRecording&&(mediaRecorder[_0x5a275b(0x179)](),isRecording=![],document[_0x5a275b(0x15c)](_0x5a275b(0x1b2))['innerText']=_0x5a275b(0x1a5));}window['onload']=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x1cdd60){return _0x1cdd60['replace'](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x53104b=_0x53c22b,_0x3983fc=document[_0x53104b(0x15c)]('profileUsernameInput')[_0x53104b(0x1a4)][_0x53104b(0x1e4)](),_0x53a712=document[_0x53104b(0x15c)]('profileDescriptionInput')[_0x53104b(0x1a4)][_0x53104b(0x1e4)](),_0x440602=document[_0x53104b(0x15c)](_0x53104b(0x1cb));if(!_0x3983fc||!_0x53a712){_0x440602[_0x53104b(0x184)]='Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.',_0x440602[_0x53104b(0x1f9)][_0x53104b(0x1c6)]='block';return;}const _0x424a14=sanitizeUsername(_0x3983fc),_0x15be8a=db[_0x53104b(0x201)](_0x53104b(0x19c)+_0x424a14);_0x15be8a['once'](_0x53104b(0x1a4))[_0x53104b(0x19f)](_0xaac807=>{const _0x1c10a1=_0x53104b;if(_0xaac807[_0x1c10a1(0x1de)]()){_0x440602[_0x1c10a1(0x184)]=_0x1c10a1(0x198),_0x440602[_0x1c10a1(0x1f9)]['display']=_0x1c10a1(0x1b4);return;}});}function saveProfile(_0x5aa059,_0x440dac,_0x4e3332){const _0x49fc7f=_0x53c22b,_0x501928=Date[_0x49fc7f(0x1e3)](),_0x67cd81=[_0x5aa059];db['ref'](_0x49fc7f(0x19c)+_0x4e3332)[_0x49fc7f(0x1d5)]({'username':_0x5aa059,'description':_0x440dac,'lastChanged':_0x501928,'usernameHistory':_0x67cd81}),localStorage[_0x49fc7f(0x155)](_0x49fc7f(0x189),_0x5aa059),localStorage[_0x49fc7f(0x155)](_0x49fc7f(0x1e6),_0x440dac),document[_0x49fc7f(0x15c)](_0x49fc7f(0x149))[_0x49fc7f(0x184)]=_0x5aa059,showScreen(_0x49fc7f(0x172));}function generateRoom(){const _0x1f32d1=_0x53c22b;roomCode=genRoomCode(),db[_0x1f32d1(0x201)](_0x1f32d1(0x17d)+roomCode)['set']({'active':!![],'created':Date[_0x1f32d1(0x1e3)]()}),startChat();}function joinRoom(){const _0x439dee=_0x53c22b,_0x25f9e1=roomCode||document[_0x439dee(0x15c)]('roomCodeInput')[_0x439dee(0x1a4)][_0x439dee(0x1e4)]()[_0x439dee(0x180)]();if(!_0x25f9e1)return alert(_0x439dee(0x1c0));roomCode=_0x25f9e1;if(roomCode===STATIC_ROOM){showScreen(_0x439dee(0x1f3));return;}db[_0x439dee(0x201)](_0x439dee(0x17d)+roomCode)['get']()['then'](_0x270290=>{const _0x331df0=_0x439dee;_0x270290[_0x331df0(0x1de)]()&&_0x270290[_0x331df0(0x168)]()['active']!==![]?startChat():alert(_0x331df0(0x1b1));});}function startChat(){const _0xb08c3b=_0x53c22b;if(!roomCode||!username)return alert('Missing\x20room\x20or\x20user\x20information.'),showScreen('roomChoiceScreen');checkIfAdmin()[_0xb08c3b(0x19f)](()=>{const _0x393537=_0xb08c3b,_0x418fb3=sanitizeUsername(username),_0x37e442=db[_0x393537(0x201)](_0x393537(0x1fb)+roomCode+'/'+_0x418fb3),_0x25d9b4={'username':username,'lastOnline':firebase[_0x393537(0x1d0)]['ServerValue'][_0x393537(0x1b6)],'online':!![]};db['ref'](_0x393537(0x159)+roomCode+'/'+_0x418fb3)[_0x393537(0x154)](_0x393537(0x1a4))[_0x393537(0x19f)](_0x6e3e15=>{_0x6e3e15['exists']()&&(_0x25d9b4['admin']=!![]),_0x37e442['set'](_0x25d9b4,_0x21db6e=>{const _0x576476=_0x527f;if(_0x21db6e)return alert('Failed\x20to\x20register\x20user\x20in\x20room.'),showScreen(_0x576476(0x172));_0x37e442[_0x576476(0x165)]()[_0x576476(0x169)]({'online':![],'lastOnline':Date[_0x576476(0x1e3)]()}),document[_0x576476(0x15c)](_0x576476(0x1dd))[_0x576476(0x184)]=username,roomCode===STATIC_ROOM?document['getElementById'](_0x576476(0x1ba))[_0x576476(0x184)]='No\x20room\x20code\x20available\x20for\x20private\x20rooms':document[_0x576476(0x15c)](_0x576476(0x1ba))[_0x576476(0x184)]=roomCode,showScreen('chatScreen'),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x403b36=_0x53c22b,_0x5bb969=document[_0x403b36(0x15c)]('staticPasswordInput')[_0x403b36(0x1a4)],_0x3efd01=document[_0x403b36(0x15c)]('passwordError');db[_0x403b36(0x201)](_0x403b36(0x16e))[_0x403b36(0x1d1)]()[_0x403b36(0x19f)](_0x1231d9=>{const _0x36c8fb=_0x403b36,_0x568174=_0x1231d9[_0x36c8fb(0x168)]();_0x5bb969===_0x568174?(_0x3efd01[_0x36c8fb(0x1f9)]['display']=_0x36c8fb(0x1c2),startChat()):_0x3efd01[_0x36c8fb(0x1f9)]['display']=_0x36c8fb(0x1b4);});}function sendMessage(){const _0x519246=_0x53c22b,_0x1be29a=document[_0x519246(0x15c)]('msgInput'),_0x35b9e2=_0x1be29a[_0x519246(0x1a4)][_0x519246(0x1e4)]();if(!_0x35b9e2)return;const _0x5a2a73=Date[_0x519246(0x1e3)](),_0x307492=sanitizeUsername(username);db[_0x519246(0x201)](_0x519246(0x1ef)+roomCode+'/'+_0x307492)[_0x519246(0x154)]('value')['then'](_0x5a1bdc=>{const _0xbdc67=_0x519246,_0x2c4044=_0x5a1bdc['val']();if(_0x2c4044&&_0x5a2a73<_0x2c4044){const _0x167202=Math[_0xbdc67(0x1fc)]((_0x2c4044-_0x5a2a73)/0x3e8);alert(_0xbdc67(0x1c4)+_0x167202+'s\x20due\x20to\x20spam.\x20Please\x20wait.');return;}const _0x5a3e59=db[_0xbdc67(0x201)](_0xbdc67(0x1a3)+roomCode+'/'+sanitizeUsername(username));_0x5a3e59[_0xbdc67(0x154)](_0xbdc67(0x1a4))[_0xbdc67(0x19f)](_0x14ee57=>{const _0x2c5d3b=_0xbdc67,_0x443fa9=_0x14ee57[_0x2c5d3b(0x168)]();if(_0x443fa9&&Date[_0x2c5d3b(0x1e3)]()<_0x443fa9){const _0xbbf0b8=Math[_0x2c5d3b(0x1fc)]((_0x443fa9-Date[_0x2c5d3b(0x1e3)]())/0x3e8);return alert(_0x2c5d3b(0x204)+_0xbbf0b8+_0x2c5d3b(0x156));}});const _0x2967cd=db[_0xbdc67(0x201)]('antispam/'+roomCode+'/'+_0x307492);_0x2967cd[_0xbdc67(0x154)](_0xbdc67(0x1a4))[_0xbdc67(0x19f)](_0x107d47=>{const _0x3e4d07=_0xbdc67,_0x3eb906=_0x107d47['val']()||[],_0x2b17c7=[..._0x3eb906,_0x5a2a73][_0x3e4d07(0x185)](_0x163157=>_0x5a2a73-_0x163157<0xbb8);if(_0x2b17c7[_0x3e4d07(0x158)]>=0x5){alert(_0x3e4d07(0x166)),db['ref'](_0x3e4d07(0x1ef)+roomCode+'/'+_0x307492)['set'](_0x5a2a73+0x7530);const _0xde2569=db['ref']('rooms/'+roomCode+'/messages');_0xde2569[_0x3e4d07(0x162)](_0x3e4d07(0x1bb))[_0x3e4d07(0x1c8)](clientId)['limitToLast'](0x5)[_0x3e4d07(0x154)](_0x3e4d07(0x1a4),_0x20688f=>{const _0x346ec9=_0x3e4d07;_0x20688f[_0x346ec9(0x173)](_0x80ea3e=>{const _0x29ed7d=_0x346ec9;_0xde2569[_0x29ed7d(0x177)](_0x80ea3e[_0x29ed7d(0x17c)])['remove']();});}),_0x2967cd[_0x3e4d07(0x1d5)]([]);return;}_0x2967cd['set'](_0x2b17c7);const _0x241d7d=localStorage[_0x3e4d07(0x1af)](_0x3e4d07(0x194))||'',_0x14f887=db[_0x3e4d07(0x201)]()[_0x3e4d07(0x19b)]()[_0x3e4d07(0x17c)];db[_0x3e4d07(0x201)](_0x3e4d07(0x17d)+roomCode+_0x3e4d07(0x182)+_0x14f887)[_0x3e4d07(0x1d5)]({'msg':_0x35b9e2,'sender':username,'senderId':clientId,'avatarBase64':_0x241d7d,'timestamp':_0x5a2a73}),_0x1be29a['value']='',sendTyping(!![]),lastActivity=_0x5a2a73;});});}function listenForMessages(){const _0x19ab60=_0x53c22b,_0x59b064=db['ref'](_0x19ab60(0x17d)+roomCode+_0x19ab60(0x174)),_0x331901=_0x59b064[_0x19ab60(0x193)](MAX_MESSAGES);_0x331901['on']('child_added',_0x4b9ade=>{const _0x3c8178=_0x19ab60,_0x169896=_0x4b9ade[_0x3c8178(0x168)](),{msg:_0x30d543,sender:_0x5bba52,senderId:_0x21f9a6,timestamp:_0x29bd11}=_0x169896,_0x26a609=_0x21f9a6===clientId,_0x77c20a=_0x169896[_0x3c8178(0x196)]||null,_0x4d3142=_0x169896[_0x3c8178(0x176)]||null;addMessage(_0x169896,_0x26a609,_0x4b9ade[_0x3c8178(0x17c)]),roomCode!==STATIC_ROOM&&db[_0x3c8178(0x201)]('rooms/'+roomCode+_0x3c8178(0x182)+_0x4b9ade[_0x3c8178(0x17c)])[_0x3c8178(0x163)](),!_0x26a609&&(sound['play'](),flagPageAttention());});}function addMessage(_0x5ce1b1,_0x5a731f,_0x3e11b7=null){const _0x37ce80=_0x53c22b,{msg:_0x18bc09,sender:_0x344c3f,senderId:_0x4e3296,timestamp:_0x498cb1,audioUrl:_0x4aa0bc,audioBase64:_0x546e29,imageBase64:_0x406de5,avatarBase64:_0x4a81cc}=_0x5ce1b1,_0x4532f1=document['createElement']('div');_0x4532f1[_0x37ce80(0x1da)][_0x37ce80(0x1e7)]('msg',_0x5a731f?'sent':_0x37ce80(0x18f));const _0x4b3cd2=new Date(_0x498cb1)['toLocaleTimeString']([],{'hour':'2-digit','minute':'2-digit'}),_0x189fc3=sanitizeUsername(_0x344c3f),_0x4d43cd=roomUsers[_0x189fc3]||{},_0x2d095d=_0x4d43cd[_0x37ce80(0x183)]?'<img\x20src=\x22data:image/png;base64,'+_0x4d43cd['avatarBase64']+_0x37ce80(0x171):_0x37ce80(0x1ab);let _0xf4b17f=_0x18bc09?.[_0x37ce80(0x15b)](new RegExp('@'+username+'\x5cb','gi'),_0x37ce80(0x1bd)),_0x4820b5=_0x2d095d+_0x37ce80(0x14e)+_0x344c3f+_0x37ce80(0x1aa);_0x5a731f?_0x4820b5+=_0x37ce80(0x1ed)+_0x4b3cd2+_0x37ce80(0x15a):_0x4820b5+=_0x37ce80(0x1ed)+_0x4b3cd2+_0x37ce80(0x1b5);if(_0x4aa0bc)_0x4820b5+=_0x37ce80(0x1f6)+_0x4aa0bc+'\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>';else{if(_0x546e29){const _0x418ccb=_0x37ce80(0x1c7)+_0x546e29;_0x4820b5+=_0x37ce80(0x1f6)+_0x418ccb+_0x37ce80(0x14b);}else{if(_0x406de5){const _0x2f4507='data:image/png;base64,'+_0x406de5;_0x4820b5+=_0x37ce80(0x190)+_0x2f4507+_0x37ce80(0x187);}else _0x4820b5+=_0x37ce80(0x1e1)+_0xf4b17f+'</div>';}}_0x4532f1[_0x37ce80(0x192)]=_0x4820b5;if(_0x4d43cd[_0x37ce80(0x1ec)]){const _0xb762cf=_0x4532f1[_0x37ce80(0x17e)](_0x37ce80(0x14c));_0xb762cf&&(_0xb762cf[_0x37ce80(0x192)]+=_0x37ce80(0x1a9));}const _0x2c7293=document[_0x37ce80(0x15c)](_0x37ce80(0x1b0));_0x2c7293[_0x37ce80(0x1e2)](_0x4532f1),_0x2c7293[_0x37ce80(0x1a8)]=_0x2c7293[_0x37ce80(0x1f5)];}function cleanupOldRooms(){const _0x3c200a=_0x53c22b;db[_0x3c200a(0x201)]('rooms')[_0x3c200a(0x154)](_0x3c200a(0x1a4))[_0x3c200a(0x19f)](_0x572670=>{const _0x148070=_0x3c200a,_0x16a016=_0x572670[_0x148070(0x168)]();if(!_0x16a016)return;const _0x18dea8=Date[_0x148070(0x1e3)]();for(const _0xc99dcf in _0x16a016){if(_0xc99dcf===STATIC_ROOM)continue;const _0xd1ac1d=_0x16a016[_0xc99dcf];_0x18dea8-(_0xd1ac1d[_0x148070(0x1d8)]||0x0)>0x2*0x3c*0x3e8&&db[_0x148070(0x201)](_0x148070(0x17d)+_0xc99dcf)[_0x148070(0x163)]();}db[_0x148070(0x201)](_0x148070(0x1be))[_0x148070(0x154)]('value')[_0x148070(0x19f)](_0x550939=>{const _0x5bdc04=_0x148070,_0x3ff7f5=_0x550939[_0x5bdc04(0x168)]();if(!_0x3ff7f5)return;for(const _0x5190e5 in _0x3ff7f5){if(_0x5190e5!==STATIC_ROOM)db[_0x5bdc04(0x201)](_0x5bdc04(0x1a2)+_0x5190e5)[_0x5bdc04(0x163)]();}}),db[_0x148070(0x201)]('antispamBlocked')['once']('value')[_0x148070(0x19f)](_0x3ae812=>{const _0xa8eb3c=_0x148070,_0xfddcc0=_0x3ae812[_0xa8eb3c(0x168)]();if(!_0xfddcc0)return;for(const _0x1bacb3 in _0xfddcc0){if(_0x1bacb3!==STATIC_ROOM)db[_0xa8eb3c(0x201)]('antispamBlocked/'+_0x1bacb3)[_0xa8eb3c(0x163)]();}});});}document[_0x53c22b(0x1fe)](_0x53c22b(0x202),()=>{const _0xc577ac=_0x53c22b,_0x26becb=document[_0xc577ac(0x15c)]('msgInput');_0x26becb&&_0x26becb['addEventListener'](_0xc577ac(0x203),function(_0x3e7c51){const _0x14b87e=_0xc577ac;_0x3e7c51['key']==='Enter'&&(_0x3e7c51[_0x14b87e(0x1ae)](),sendMessage());});});function showScreen(_0x3a5bf4){const _0x5e8758=_0x53c22b;['usernameScreen',_0x5e8758(0x172),'codeEntryScreen',_0x5e8758(0x14f),_0x5e8758(0x1f3),_0x5e8758(0x18c),'profileViewer']['forEach'](_0x1fb66b=>{const _0xe9897d=_0x5e8758;document[_0xe9897d(0x15c)](_0x1fb66b)[_0xe9897d(0x1f9)][_0xe9897d(0x1c6)]=_0xe9897d(0x1c2);}),document[_0x5e8758(0x15c)](_0x3a5bf4)[_0x5e8758(0x1f9)]['display']=_0x5e8758(0x17f);}function genRoomCode(){const _0x2c0ddd=_0x53c22b,_0x166b46=_0x2c0ddd(0x1fa),_0x1779dd=_0x2c0ddd(0x17b),_0x378da2=(_0x1c5058,_0x22d145)=>Array[_0x2c0ddd(0x1b8)]({'length':_0x22d145},()=>_0x1c5058[Math[_0x2c0ddd(0x175)](Math[_0x2c0ddd(0x1f7)]()*_0x1c5058[_0x2c0ddd(0x158)])])[_0x2c0ddd(0x164)]('');return _0x378da2(_0x1779dd,0x3)+_0x378da2(_0x166b46,0x3)+_0x378da2(_0x1779dd,0x2)+_0x378da2(_0x166b46,0x2);}function startInactivityTimer(){setInterval(()=>{const _0x4a6cfb=_0x527f;Date[_0x4a6cfb(0x1e3)]()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db['ref'](_0x4a6cfb(0x17d)+roomCode)['update']({'active':![]}),alert('Session\x20expired.'),location[_0x4a6cfb(0x16a)]());},0x7530);}function _0x527f(_0x5c87fc,_0x4dccec){const _0xa4f25a=_0xa4f2();return _0x527f=function(_0x527fd6,_0x5c37be){_0x527fd6=_0x527fd6-0x149;let _0xf31115=_0xa4f25a[_0x527fd6];return _0xf31115;},_0x527f(_0x5c87fc,_0x4dccec);}function setupSidebarBackHandler(){const _0x34aca7=_0x53c22b;window[_0x34aca7(0x1fe)]('popstate',()=>{const _0x245c59=_0x34aca7,_0x2c2210=document['getElementById'](_0x245c59(0x1c9));_0x2c2210?.[_0x245c59(0x1da)]['contains'](_0x245c59(0x1e9))&&_0x2c2210[_0x245c59(0x1da)][_0x245c59(0x163)](_0x245c59(0x1e9));});}function toggleSidebar(){const _0x4277f3=_0x53c22b,_0x50fa6e=document[_0x4277f3(0x15c)]('userSidebar');if(!_0x50fa6e['classList']['contains'](_0x4277f3(0x1e9)))_0x50fa6e[_0x4277f3(0x1da)][_0x4277f3(0x1e7)](_0x4277f3(0x1e9)),history['pushState']({'sidebarOpen':!![]},'');else{_0x50fa6e[_0x4277f3(0x1da)][_0x4277f3(0x163)](_0x4277f3(0x1e9));if(history[_0x4277f3(0x1cf)]?.[_0x4277f3(0x1f8)])history[_0x4277f3(0x1bc)]();}}function setupVisibilityAttention(){const _0x1fbaff=_0x53c22b;let _0x23f454=0x0,_0x3b1c16=document[_0x1fbaff(0x1d3)];document[_0x1fbaff(0x1fe)](_0x1fbaff(0x16f),()=>{const _0x5ba123=_0x1fbaff;!document[_0x5ba123(0x181)]&&(document[_0x5ba123(0x1d3)]=_0x3b1c16,_0x23f454=0x0);}),window['flagPageAttention']=function(){const _0x5bac2d=_0x1fbaff;document[_0x5bac2d(0x181)]&&(_0x23f454++,document['title']='('+_0x23f454+_0x5bac2d(0x1c1)+_0x3b1c16);};}function tryEditProfile(){const _0x6a1cda=_0x53c22b,_0xac44f3=sanitizeUsername(username);db[_0x6a1cda(0x201)](_0x6a1cda(0x19c)+_0xac44f3)['get']()[_0x6a1cda(0x19f)](_0x5593f6=>{const _0xb952c7=_0x6a1cda,_0x1ed50a=_0x5593f6['val']();if(!_0x1ed50a)return alert(_0xb952c7(0x1ff));const _0x56633f=_0x1ed50a[_0xb952c7(0x1f1)]||0x0,_0x32db6d=Date[_0xb952c7(0x1e3)](),_0x30b02a=0x18*0x3c*0x3c*0x3e8;if(_0x32db6d-_0x56633f<_0x30b02a){const _0xd890d3=Math['ceil']((_0x30b02a-(_0x32db6d-_0x56633f))/(0x3c*0x3e8));alert('You\x20can\x20change\x20your\x20profile\x20again\x20in\x20'+_0xd890d3+'\x20minutes.');}else showScreen(_0xb952c7(0x18c)),document[_0xb952c7(0x15c)](_0xb952c7(0x1cd))[_0xb952c7(0x1a4)]=username,document[_0xb952c7(0x15c)]('profileDescriptionInput')[_0xb952c7(0x1a4)]=_0x1ed50a[_0xb952c7(0x186)]||'';});}function listenForUserList(){const _0x421f23=_0x53c22b;db['ref']('users/'+roomCode)['on'](_0x421f23(0x1a4),_0x30f210=>{const _0x1d0d03=_0x421f23,_0x35ae69=_0x30f210[_0x1d0d03(0x168)]()||{};Object['entries'](_0x35ae69)['forEach'](([_0x2fdf30,_0x1144d3])=>{roomUsers[sanitizeUsername(_0x1144d3['username'])]=_0x1144d3;});const _0x4898b9=Date['now'](),_0x4088b9=Object['values'](_0x35ae69)[_0x1d0d03(0x1e5)](_0x1cbb12=>{const _0x41b6b9=_0x1d0d03,_0xe75a2f=_0x1cbb12['online'],_0x59fe7a=_0x4898b9-_0x1cbb12['lastOnline']<=0x1e*0x3c*0x3e8;if(!_0xe75a2f&&!_0x59fe7a)return'';const _0x451237=_0xe75a2f?_0x41b6b9(0x1a6):_0x41b6b9(0x1d9),_0x1c56d2=_0xe75a2f?'🟢':'🕒',_0x38b836=new Date(_0x1cbb12[_0x41b6b9(0x1a1)])[_0x41b6b9(0x153)]([],{'hour':_0x41b6b9(0x1f4),'minute':_0x41b6b9(0x1f4)}),_0x389610=_0x1cbb12[_0x41b6b9(0x183)]?_0x41b6b9(0x1b3)+_0x1cbb12[_0x41b6b9(0x183)]+_0x41b6b9(0x1c5):'<span\x20style=\x22margin-right:5px;\x22>👤</span>',_0x43f46f=_0x1cbb12[_0x41b6b9(0x1ec)]?_0x41b6b9(0x178):'';return _0x41b6b9(0x1ad)+_0x451237+';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27'+sanitizeUsername(_0x1cbb12[_0x41b6b9(0x1db)])+_0x41b6b9(0x1c3)+_0x389610+_0x1c56d2+'\x20'+_0x1cbb12['username']+_0x43f46f+_0x41b6b9(0x18d);})[_0x1d0d03(0x164)]('');document[_0x1d0d03(0x15c)](_0x1d0d03(0x1d4))[_0x1d0d03(0x192)]=_0x4088b9;});}function sendTyping(_0x3ece0f=![]){const _0x1d3da6=_0x53c22b,_0x468433=_0x1d3da6(0x17d)+roomCode+_0x1d3da6(0x1dc)+clientId;_0x3ece0f?db['ref'](_0x468433)[_0x1d3da6(0x163)]():(db[_0x1d3da6(0x201)](_0x468433)[_0x1d3da6(0x1d5)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x41e3ab=_0x1d3da6;db[_0x41e3ab(0x201)](_0x468433)['remove']();},0xbb8));}function listenForTyping(){const _0x507e55=_0x53c22b,_0x208ac4=document[_0x507e55(0x15c)](_0x507e55(0x160));db[_0x507e55(0x201)](_0x507e55(0x17d)+roomCode+_0x507e55(0x170))['on'](_0x507e55(0x1a4),_0x175b77=>{const _0x386390=_0x507e55,_0x1192ae=_0x175b77['val']();if(!_0x1192ae)return _0x208ac4[_0x386390(0x184)]='';const _0x18850d=Object['values'](_0x1192ae)['filter'](_0x26fe0a=>_0x26fe0a!==username);_0x208ac4[_0x386390(0x184)]=_0x18850d[_0x386390(0x158)]?_0x18850d[_0x386390(0x164)](',\x20')+'\x20typing...':'';});}function trackPresence(){const _0x5a8ca6=_0x53c22b;if(!username||!roomCode)return;const _0x1c116d=sanitizeUsername(username),_0x562515=db[_0x5a8ca6(0x201)](_0x5a8ca6(0x1fb)+roomCode+'/'+_0x1c116d),_0x1c88f8=localStorage[_0x5a8ca6(0x1af)](_0x5a8ca6(0x194))||'',_0x110c15={'username':username,'lastOnline':firebase[_0x5a8ca6(0x1d0)][_0x5a8ca6(0x18b)]['TIMESTAMP'],'online':!![],'avatarBase64':_0x1c88f8};db[_0x5a8ca6(0x201)](_0x5a8ca6(0x159)+roomCode+'/'+_0x1c116d)[_0x5a8ca6(0x154)](_0x5a8ca6(0x1a4))['then'](_0x2eee83=>{const _0x388c41=_0x5a8ca6;if(_0x2eee83[_0x388c41(0x1de)]())_0x110c15[_0x388c41(0x1ec)]=!![];_0x562515[_0x388c41(0x1d5)](_0x110c15),_0x562515[_0x388c41(0x165)]()[_0x388c41(0x169)]({'online':![],'lastOnline':Date['now']()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0x2a87c8){const _0x318e09=_0x53c22b;if(!_0x2a87c8[_0x318e09(0x1e0)]['length'])return;const _0x52a315=new FileReader();_0x52a315[_0x318e09(0x1f0)]=()=>{const _0x1a3dc6=_0x318e09,_0x59b417=_0x52a315['result'][_0x1a3dc6(0x19e)](',')[0x1];localStorage[_0x1a3dc6(0x155)](_0x1a3dc6(0x194),_0x59b417);const _0x317586=document[_0x1a3dc6(0x15c)](_0x1a3dc6(0x15e));_0x317586[_0x1a3dc6(0x16d)]='data:image/png;base64,'+_0x59b417,_0x317586[_0x1a3dc6(0x1f9)][_0x1a3dc6(0x1c6)]=_0x1a3dc6(0x1b4),trackPresence();},_0x52a315[_0x318e09(0x1a7)](_0x2a87c8[_0x318e09(0x1e0)][0x0]);}function muteUser(_0x35c073,_0x4c77d8){const _0x5dd0eb=_0x53c22b;if(!isRoomAdmin)return alert(_0x5dd0eb(0x1bf));const _0x32490e=Date[_0x5dd0eb(0x1e3)]()+_0x4c77d8*0x3c*0x3e8;db[_0x5dd0eb(0x201)](_0x5dd0eb(0x1a3)+roomCode+'/'+sanitizeUsername(_0x35c073))[_0x5dd0eb(0x1d5)](_0x32490e);}function unmuteUser(_0x53820b){const _0x499085=_0x53c22b;if(!isRoomAdmin)return alert(_0x499085(0x1bf));db['ref'](_0x499085(0x1a3)+roomCode+'/'+sanitizeUsername(_0x53820b))[_0x499085(0x163)]();}function updateOnlineIndicator(){const _0x1a9467=_0x53c22b,_0xa3088c=document['getElementById'](_0x1a9467(0x1f2));_0xa3088c[_0x1a9467(0x184)]=_0x1a9467(0x195),_0xa3088c['style']['color']=_0x1a9467(0x1a6);}setInterval(updateOnlineIndicator,0xbb8);function _0xa4f2(){const _0x425757=['avatar_base64','●\x20Online','audioUrl','050BBB66HH','❌\x20Username\x20already\x20taken.','159798gmNSUr','onstop','push','profiles/','getUserMedia','split','then','sounds/beep.mp3','lastOnline','antispam/','muted/','value','🎙️','#00ff88','readAsDataURL','scrollTop','\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>','</span>','<span\x20style=\x22margin-right:8px;\x22>👤</span>','No\x20bio\x20set','<li\x20style=\x22color:','preventDefault','getItem','messages','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','recordBtn','<img\x20src=\x22data:image/png;base64,','block','</small>','TIMESTAMP','data','from','1:985049198428:web:d0eb7e2de39887710c9b99','roomDisplay','senderId','back','<span\x20style=\x22color:#ff4081;\x22>@$&</span>','antispam','Admins\x20only.','Enter\x20a\x20valid\x20room\x20code',')\x20New\x20message\x20•\x20','none','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','⛔\x20You\x27re\x20blocked\x20for\x20','\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>','display','data:audio/webm;base64,','equalTo','userSidebar','substr','profileError','\x0aLast\x20Changed:\x20','profileUsernameInput','https://easy-chatroom-default-rtdb.firebaseio.com','state','database','get','initializeApp','title','userList','set','G-QDESJ2WR42','easy-chatroom','created','#888','classList','username','/typing/','userDisplay','exists','profileContent','files','<div>','appendChild','now','trim','map','profile_description','add','27GuNZFV','show','7557424pjLHGK','catch','admin','<small>','85pQVTZy','antispamBlocked/','onloadend','lastChanged','onlineStatus','passwordScreen','2-digit','scrollHeight','<audio\x20controls\x20src=\x22','random','sidebarOpen','style','ABCDEFGHIJKLMNOPQRSTUVWXYZ','users/','ceil','audio/webm','addEventListener','Profile\x20not\x20found.','985049198428','ref','DOMContentLoaded','keypress','You\x27re\x20muted\x20for\x20another\x20','namePreview','result','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','.sender-name','\x0aDescription:\x20','<span\x20class=\x22sender-name\x22>','chatScreen','38zbrlXb','31398fsAMxV','profileViewer','toLocaleTimeString','once','setItem','\x20seconds.','276562SYcEEn','length','admins/','\x20·\x20✓✓</small>','replace','getElementById','\x0a\x20\x20\x20\x20','sidebarAvatarPreview','8NJHBuG','typing','easy-chatroom.firebasestorage.app','orderByChild','remove','join','onDisconnect','🚫\x20You\x27ve\x20been\x20blocked\x20for\x2030\x20seconds\x20due\x20to\x20spamming.','\x0aName:\x20','val','update','reload','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','easy-chatroom.firebaseapp.com','src','gr8stg','visibilitychange','/typing','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','roomChoiceScreen','forEach','/messages','floor','audioBase64','child','\x20<span\x20style=\x22color:red;\x22>Admin</span>','stop','1469770bImJbi','0123456789','key','rooms/','querySelector','flex','toUpperCase','hidden','/messages/','avatarBase64','innerText','filter','description','\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>','ondataavailable','chat_username','3775440opnONx','ServerValue','profileScreen','\x0a\x20\x20\x20\x20\x20\x20</li>','toString','received','<img\x20src=\x22','4952717aHYLFB','innerHTML','limitToLast'];_0xa4f2=function(){return _0x425757;};return _0xa4f2();}function viewProfile(_0x1c4bb4){const _0x2da6a9=_0x53c22b;db['ref'](_0x2da6a9(0x19c)+_0x1c4bb4)['get']()[_0x2da6a9(0x19f)](_0xbaca89=>{const _0x3a6421=_0x2da6a9;if(!_0xbaca89[_0x3a6421(0x1de)]())return;const _0x57d57d=_0xbaca89[_0x3a6421(0x168)](),_0x3be987=(_0x3a6421(0x167)+_0x57d57d[_0x3a6421(0x1db)]+_0x3a6421(0x14d)+(_0x57d57d[_0x3a6421(0x186)]||_0x3a6421(0x1ac))+'\x0aHistory:\x0a'+(_0x57d57d['usernameHistory']||[])[_0x3a6421(0x164)]('\x0a')+_0x3a6421(0x1cc)+new Date(_0x57d57d[_0x3a6421(0x1f1)])['toLocaleString']()+_0x3a6421(0x15d))[_0x3a6421(0x1e4)]();document['getElementById'](_0x3a6421(0x1df))['innerText']=_0x3be987,document['getElementById']('profileViewer')[_0x3a6421(0x1f9)][_0x3a6421(0x1c6)]=_0x3a6421(0x1b4);});}function initUsernameFlow(){const _0x1b795c=_0x53c22b,_0x3cc3d3=localStorage[_0x1b795c(0x1af)](_0x1b795c(0x189));!_0x3cc3d3?showScreen(_0x1b795c(0x18c)):(username=_0x3cc3d3,document[_0x1b795c(0x15c)](_0x1b795c(0x149))['innerText']=username,showScreen(_0x1b795c(0x172)));}function closeProfile(){const _0x8b9100=_0x53c22b;document[_0x8b9100(0x15c)](_0x8b9100(0x152))['style']['display']=_0x8b9100(0x1c2);}