const _0x1f856b=_0x686e;(function(_0x2a087e,_0x3d58e6){const _0x40a78b=_0x686e,_0x882132=_0x2a087e();while(!![]){try{const _0x1b8406=-parseInt(_0x40a78b(0xf9))/0x1*(parseInt(_0x40a78b(0x19e))/0x2)+-parseInt(_0x40a78b(0x102))/0x3+parseInt(_0x40a78b(0xf5))/0x4+parseInt(_0x40a78b(0x147))/0x5*(-parseInt(_0x40a78b(0x14f))/0x6)+parseInt(_0x40a78b(0x131))/0x7*(parseInt(_0x40a78b(0x191))/0x8)+-parseInt(_0x40a78b(0x152))/0x9+parseInt(_0x40a78b(0xfc))/0xa;if(_0x1b8406===_0x3d58e6)break;else _0x882132['push'](_0x882132['shift']());}catch(_0x332583){_0x882132['push'](_0x882132['shift']());}}}(_0xb105,0xf3c99));const firebaseConfig={'apiKey':_0x1f856b(0x154),'authDomain':'easy-chatroom.firebaseapp.com','databaseURL':_0x1f856b(0x105),'projectId':_0x1f856b(0x161),'storageBucket':_0x1f856b(0x197),'messagingSenderId':'985049198428','appId':_0x1f856b(0x116),'measurementId':_0x1f856b(0xfe)};firebase[_0x1f856b(0x132)](firebaseConfig);const db=firebase[_0x1f856b(0x1a9)]();let messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math[_0x1f856b(0x12c)]()[_0x1f856b(0x12d)](0x24)['substr'](0x2,0x9),lastActivity=Date[_0x1f856b(0x123)](),typingTimeout,gr8stg='';const STATIC_ROOM=_0x1f856b(0x164),MAX_MESSAGES=0xfa,sound=new Audio(_0x1f856b(0x173));sound['volume']=0.3;function _0x686e(_0x47d6c2,_0x2ea48e){const _0xb105dc=_0xb105();return _0x686e=function(_0x686e39,_0x1515b2){_0x686e39=_0x686e39-0xf5;let _0x1f2c6c=_0xb105dc[_0x686e39];return _0x1f2c6c;},_0x686e(_0x47d6c2,_0x2ea48e);}let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x1fc510=_0x1f856b,_0x1b13d3=db[_0x1fc510(0x159)]('admins/'+roomCode+'/'+sanitizeUsername(username));return _0x1b13d3[_0x1fc510(0x111)](_0x1fc510(0x169))[_0x1fc510(0x1a3)](_0x5a8dfb=>{const _0x597654=_0x1fc510;isRoomAdmin=_0x5a8dfb[_0x597654(0x11d)]();});}function toggleRecording(){const _0x32f32d=_0x1f856b;isRecording?stopRecording():navigator[_0x32f32d(0x144)]['getUserMedia']({'audio':!![]})[_0x32f32d(0x1a3)](_0x2ade0b=>{const _0x59f9c0=_0x32f32d;mediaRecorder=new MediaRecorder(_0x2ade0b),mediaRecorder[_0x59f9c0(0x103)](),isRecording=!![],document['getElementById'](_0x59f9c0(0x127))[_0x59f9c0(0x170)]='‚èπÔ∏è',audioChunks=[],mediaRecorder[_0x59f9c0(0x17f)]=_0x3042b4=>audioChunks[_0x59f9c0(0x117)](_0x3042b4[_0x59f9c0(0x140)]),mediaRecorder[_0x59f9c0(0x192)]=()=>{const _0x4669ba=_0x59f9c0;clearTimeout(recordingTimer);const _0x1707ab=new Blob(audioChunks,{'type':_0x4669ba(0x149)}),_0xc7cce4=new FileReader();_0xc7cce4[_0x4669ba(0x17c)]=()=>{const _0xfd1fc=_0x4669ba,_0x527c0b=_0xc7cce4['result'][_0xfd1fc(0x183)](',')[0x1],_0x27beda=db[_0xfd1fc(0x159)]()[_0xfd1fc(0x117)]()[_0xfd1fc(0x177)];db['ref'](_0xfd1fc(0x163)+roomCode+_0xfd1fc(0xf7)+_0x27beda)[_0xfd1fc(0x194)]({'msg':_0xfd1fc(0x1a1),'audioBase64':_0x527c0b,'sender':username,'senderId':clientId,'timestamp':Date[_0xfd1fc(0x123)]()});},_0xc7cce4[_0x4669ba(0x15d)](_0x1707ab);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0x32f32d(0x17a)](_0x1b8887=>{const _0x4abcd4=_0x32f32d;alert(_0x4abcd4(0x124));});}function stopRecording(){const _0x4d6036=_0x1f856b;mediaRecorder&&isRecording&&(mediaRecorder[_0x4d6036(0x18f)](),isRecording=![],document[_0x4d6036(0xfa)](_0x4d6036(0x127))[_0x4d6036(0x170)]=_0x4d6036(0x142));}window['onload']=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x1de31c){return _0x1de31c['replace'](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x279d5b=_0x1f856b,_0x5dbbc0=document[_0x279d5b(0xfa)]('profileUsernameInput')[_0x279d5b(0x169)][_0x279d5b(0x158)](),_0x176908=document['getElementById'](_0x279d5b(0x14e))[_0x279d5b(0x169)][_0x279d5b(0x158)](),_0x2fa5d0=document['getElementById'](_0x279d5b(0x155));if(!_0x5dbbc0||!_0x176908){_0x2fa5d0[_0x279d5b(0x170)]=_0x279d5b(0x10a),_0x2fa5d0[_0x279d5b(0x180)]['display']=_0x279d5b(0x15e);return;}const _0x4c674a=sanitizeUsername(_0x5dbbc0),_0x24fad4=db[_0x279d5b(0x159)](_0x279d5b(0x13b)+_0x4c674a);_0x24fad4[_0x279d5b(0x111)](_0x279d5b(0x169))[_0x279d5b(0x1a3)](_0x8f4dc8=>{const _0x3876f9=_0x279d5b;if(_0x8f4dc8[_0x3876f9(0x11d)]()){_0x2fa5d0[_0x3876f9(0x170)]='‚ùå\x20Username\x20already\x20taken.',_0x2fa5d0['style'][_0x3876f9(0x184)]=_0x3876f9(0x15e);return;}});}function _0xb105(){const _0x4c9374=['set','No\x20bio\x20set','cssText','easy-chatroom.firebasestorage.app','reload','\x20seconds.','antispamBlocked/','result','#00ff88','Failed\x20to\x20register\x20user\x20in\x20room.','639922MoDdOd','/messages','passwordError','[Voice\x20message]','limitToLast','then','addEventListener','<img\x20src=\x22data:image/png;base64,','Enter','#888','/typing/','database','contains','child','replace','roomDisplay','<img\x20src=\x22','<small>','add','<span\x20style=\x22margin-right:8px;\x22>üë§</span>','profileUsernameInput','muted/','sidebarOpen','audioUrl','values','remove','admin','</small>','audioBase64','profileScreen','5952244YXlQwj','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','/messages/','innerHTML','2YvYEuZ','getElementById','getItem','8436940jRTGrm','userDisplay','G-QDESJ2WR42','\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>','sent','roomChoiceScreen','920409CfZemg','start','ServerValue','https://easy-chatroom-default-rtdb.firebaseio.com','flex','popstate','DOMContentLoaded','msgInput','Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.','data:image/png;base64,',')\x20New\x20message\x20‚Ä¢\x20','‚õî\x20You\x27re\x20blocked\x20for\x20','preventDefault','\x0aLast\x20Changed:\x20','keypress','once','antispam','margin-left:5px;background:none;border:none;color:red;cursor:pointer;','namePreview','\x20typing...','1:985049198428:web:d0eb7e2de39887710c9b99','push','üö´\x20You\x27ve\x20been\x20blocked\x20for\x2030\x20seconds\x20due\x20to\x20spamming.','\x20minutes.','senderId','state','orderByChild','exists','</span>','show','child_added','flagPageAttention','/typing','now','Microphone\x20permission\x20denied.','profile_description','onclick','recordBtn','classList','username','val','equalTo','random','toString','none','online','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','35smzdhz','initializeApp','You\x27re\x20muted\x20for\x20another\x20','passwordScreen','chatScreen','usernameScreen','\x0aDescription:\x20','<span\x20style=\x22margin-right:5px;\x22>üë§</span>','usernameHistory','get','profiles/','scrollHeight','rooms','onDisconnect','users/','data','2-digit','üéôÔ∏è','visibilitychange','mediaDevices','toLocaleTimeString','TIMESTAMP','3783415CFAJoE','querySelector','audio/webm','chat_username','‚óè\x20Online','s\x20due\x20to\x20spam.\x20Please\x20wait.','length','profileDescriptionInput','6jZWJQC','profileViewer','pushState','8275356dIzPoU','\x0aName:\x20','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','profileError','userList','roomCodeInput','trim','ref','msg','messages','typing','readAsDataURL','block',';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27','antispam/','easy-chatroom','hidden','rooms/','050BBB66HH','onlineStatus','title','appendChild','data:audio/webm;base64,','value','0123456789','update','userSidebar','ABCDEFGHIJKLMNOPQRSTUVWXYZ','\x0aHistory:\x0a','\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>','innerText','Admins\x20only.','avatarBase64','sounds/beep.mp3','\x0a\x20\x20\x20\x20\x20\x20</li>','lastChanged','gr8stg','key','setItem','createElement','catch','received','onloadend','.sender-name','filter','ondataavailable','style','lastOnline','<div>','split','display','scrollTop','<li\x20style=\x22color:','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','join','ceil','back','description','\x20¬∑\x20‚úì‚úì</small>','No\x20room\x20code\x20available\x20for\x20private\x20rooms','forEach','stop','Profile\x20not\x20found.','2063504FtDfsz','onstop','Delete\x20this\x20message?'];_0xb105=function(){return _0x4c9374;};return _0xb105();}function saveProfile(_0x4bc44a,_0x3fd915,_0x558e91){const _0x2ae612=_0x1f856b,_0x25e5f5=Date[_0x2ae612(0x123)](),_0x5346e4=[_0x4bc44a];db[_0x2ae612(0x159)](_0x2ae612(0x13b)+_0x558e91)[_0x2ae612(0x194)]({'username':_0x4bc44a,'description':_0x3fd915,'lastChanged':_0x25e5f5,'usernameHistory':_0x5346e4}),localStorage[_0x2ae612(0x178)]('chat_username',_0x4bc44a),localStorage['setItem'](_0x2ae612(0x125),_0x3fd915),document[_0x2ae612(0xfa)](_0x2ae612(0x114))[_0x2ae612(0x170)]=_0x4bc44a,showScreen(_0x2ae612(0x101));}function generateRoom(){const _0x5dd314=_0x1f856b;roomCode=genRoomCode(),db[_0x5dd314(0x159)]('rooms/'+roomCode)[_0x5dd314(0x194)]({'active':!![],'created':Date[_0x5dd314(0x123)]()}),startChat();}function joinRoom(){const _0x3b2a0a=_0x1f856b,_0x260d9a=roomCode||document['getElementById'](_0x3b2a0a(0x157))[_0x3b2a0a(0x169)][_0x3b2a0a(0x158)]()['toUpperCase']();if(!_0x260d9a)return alert('Enter\x20a\x20valid\x20room\x20code');roomCode=_0x260d9a;if(roomCode===STATIC_ROOM){showScreen(_0x3b2a0a(0x134));return;}db[_0x3b2a0a(0x159)](_0x3b2a0a(0x163)+roomCode)[_0x3b2a0a(0x13a)]()[_0x3b2a0a(0x1a3)](_0x576d49=>{const _0x2725ab=_0x3b2a0a;_0x576d49[_0x2725ab(0x11d)]()&&_0x576d49[_0x2725ab(0x12a)]()['active']!==![]?startChat():alert(_0x2725ab(0x130));});}function startChat(){const _0x1ce249=_0x1f856b;if(!roomCode||!username)return alert('Missing\x20room\x20or\x20user\x20information.'),showScreen(_0x1ce249(0x101));checkIfAdmin()[_0x1ce249(0x1a3)](()=>{const _0x599038=_0x1ce249,_0x1c6bd9=sanitizeUsername(username),_0xda222c=db[_0x599038(0x159)](_0x599038(0x13f)+roomCode+'/'+_0x1c6bd9),_0x1365d9={'username':username,'lastOnline':firebase[_0x599038(0x1a9)][_0x599038(0x104)][_0x599038(0x146)],'online':!![]};db[_0x599038(0x159)]('admins/'+roomCode+'/'+_0x1c6bd9)[_0x599038(0x111)](_0x599038(0x169))[_0x599038(0x1a3)](_0x1544dc=>{const _0x31e756=_0x599038;_0x1544dc[_0x31e756(0x11d)]()&&(_0x1365d9[_0x31e756(0x1b8)]=!![]),_0xda222c[_0x31e756(0x194)](_0x1365d9,_0x59fec1=>{const _0x5e54d7=_0x31e756;if(_0x59fec1)return alert(_0x5e54d7(0x19d)),showScreen('roomChoiceScreen');_0xda222c[_0x5e54d7(0x13e)]()['update']({'online':![],'lastOnline':Date['now']()}),document['getElementById'](_0x5e54d7(0xfd))[_0x5e54d7(0x170)]=username,roomCode===STATIC_ROOM?document['getElementById'](_0x5e54d7(0x1ad))['innerText']=_0x5e54d7(0x18d):document['getElementById']('roomDisplay')[_0x5e54d7(0x170)]=roomCode,showScreen(_0x5e54d7(0x135)),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x486343=_0x1f856b,_0x143fb9=document['getElementById']('staticPasswordInput')[_0x486343(0x169)],_0x25fae1=document[_0x486343(0xfa)](_0x486343(0x1a0));db[_0x486343(0x159)](_0x486343(0x176))[_0x486343(0x13a)]()[_0x486343(0x1a3)](_0x1c3100=>{const _0x5b40eb=_0x486343,_0x3a10f9=_0x1c3100[_0x5b40eb(0x12a)]();_0x143fb9===_0x3a10f9?(_0x25fae1[_0x5b40eb(0x180)][_0x5b40eb(0x184)]='none',startChat()):_0x25fae1[_0x5b40eb(0x180)]['display']=_0x5b40eb(0x15e);});}function sendMessage(){const _0x301981=_0x1f856b,_0x22688a=document[_0x301981(0xfa)](_0x301981(0x109)),_0x3cd128=_0x22688a[_0x301981(0x169)][_0x301981(0x158)]();if(!_0x3cd128)return;const _0x4fde92=Date['now'](),_0x4b42b5=sanitizeUsername(username);db[_0x301981(0x159)]('antispamBlocked/'+roomCode+'/'+_0x4b42b5)[_0x301981(0x111)](_0x301981(0x169))[_0x301981(0x1a3)](_0x74f4c2=>{const _0x3c5063=_0x301981,_0x27ce42=_0x74f4c2['val']();if(_0x27ce42&&_0x4fde92<_0x27ce42){const _0x566a08=Math[_0x3c5063(0x189)]((_0x27ce42-_0x4fde92)/0x3e8);alert(_0x3c5063(0x10d)+_0x566a08+_0x3c5063(0x14c));return;}const _0x2f9ac3=db[_0x3c5063(0x159)]('muted/'+roomCode+'/'+sanitizeUsername(username));_0x2f9ac3[_0x3c5063(0x111)](_0x3c5063(0x169))['then'](_0x5a0bf8=>{const _0x6706e6=_0x3c5063,_0x5bc09d=_0x5a0bf8[_0x6706e6(0x12a)]();if(_0x5bc09d&&Date[_0x6706e6(0x123)]()<_0x5bc09d){const _0x1efc36=Math[_0x6706e6(0x189)]((_0x5bc09d-Date[_0x6706e6(0x123)]())/0x3e8);return alert(_0x6706e6(0x133)+_0x1efc36+_0x6706e6(0x199));}});const _0xf8af02=db[_0x3c5063(0x159)](_0x3c5063(0x160)+roomCode+'/'+_0x4b42b5);_0xf8af02[_0x3c5063(0x111)](_0x3c5063(0x169))[_0x3c5063(0x1a3)](_0x1d938b=>{const _0x38babc=_0x3c5063,_0x3c9f2c=_0x1d938b[_0x38babc(0x12a)]()||[],_0xd5b3f1=[..._0x3c9f2c,_0x4fde92][_0x38babc(0x17e)](_0x2cc49a=>_0x4fde92-_0x2cc49a<0xbb8);if(_0xd5b3f1[_0x38babc(0x14d)]>=0x5){alert(_0x38babc(0x118)),db['ref'](_0x38babc(0x19a)+roomCode+'/'+_0x4b42b5)[_0x38babc(0x194)](_0x4fde92+0x7530);const _0x3bdfaa=db[_0x38babc(0x159)](_0x38babc(0x163)+roomCode+_0x38babc(0x19f));_0x3bdfaa[_0x38babc(0x11c)](_0x38babc(0x11a))[_0x38babc(0x12b)](clientId)['limitToLast'](0x5)[_0x38babc(0x111)]('value',_0x187a54=>{const _0x19c4d1=_0x38babc;_0x187a54[_0x19c4d1(0x18e)](_0x441a60=>{const _0x3f1719=_0x19c4d1;_0x3bdfaa[_0x3f1719(0x1ab)](_0x441a60['key'])['remove']();});}),_0xf8af02['set']([]);return;}_0xf8af02['set'](_0xd5b3f1);const _0x1cc36f=db[_0x38babc(0x159)]()[_0x38babc(0x117)]()[_0x38babc(0x177)];db[_0x38babc(0x159)](_0x38babc(0x163)+roomCode+_0x38babc(0xf7)+_0x1cc36f)[_0x38babc(0x194)]({'msg':_0x3cd128,'sender':username,'senderId':clientId,'timestamp':_0x4fde92}),_0x22688a[_0x38babc(0x169)]='',sendTyping(!![]),lastActivity=_0x4fde92;});});}function listenForMessages(){const _0xec4950=_0x1f856b,_0x578d83=db[_0xec4950(0x159)](_0xec4950(0x163)+roomCode+_0xec4950(0x19f)),_0x2afbb7=_0x578d83[_0xec4950(0x1a2)](MAX_MESSAGES);_0x2afbb7['on'](_0xec4950(0x120),_0x20b285=>{const _0x20ca10=_0xec4950,_0x3ae931=_0x20b285[_0x20ca10(0x12a)](),{msg:_0x8b3da0,sender:_0x3d9511,senderId:_0x279b1b,timestamp:_0x51e2de}=_0x3ae931,_0x4a14b1=_0x279b1b===clientId,_0x954407=_0x3ae931[_0x20ca10(0x1b5)]||null,_0x329b60=_0x3ae931[_0x20ca10(0x1ba)]||null;addMessage(_0x3ae931,_0x4a14b1,_0x20b285[_0x20ca10(0x177)]),roomCode!==STATIC_ROOM&&db[_0x20ca10(0x159)](_0x20ca10(0x163)+roomCode+'/messages/'+_0x20b285[_0x20ca10(0x177)])[_0x20ca10(0x1b7)](),!_0x4a14b1&&(sound['play'](),flagPageAttention());});}function addMessage(_0x40a4c5,_0x556081,_0x151c9e=null){const _0x1b8c2f=_0x1f856b,{msg:_0x154893,sender:_0x46f308,senderId:_0xf96fcd,timestamp:_0x437ba1,audioUrl:_0x3bde8f,audioBase64:_0x5aba9d,imageBase64:_0x3c9482,avatarBase64:_0x358b15}=_0x40a4c5,_0x23f910=document[_0x1b8c2f(0x179)]('div');_0x23f910[_0x1b8c2f(0x128)][_0x1b8c2f(0x1b0)](_0x1b8c2f(0x15a),_0x556081?_0x1b8c2f(0x100):_0x1b8c2f(0x17b));const _0x284fb0=new Date(_0x437ba1)[_0x1b8c2f(0x145)]([],{'hour':_0x1b8c2f(0x141),'minute':'2-digit'}),_0x4daf4b=_0x358b15?_0x1b8c2f(0x1a5)+_0x358b15+_0x1b8c2f(0xf6):_0x1b8c2f(0x1b1);let _0x423407=_0x4daf4b+'<span\x20class=\x22sender-name\x22>'+_0x46f308+_0x1b8c2f(0x11e);_0x556081?_0x423407+=_0x1b8c2f(0x1af)+_0x284fb0+_0x1b8c2f(0x18c):_0x423407+=_0x1b8c2f(0x1af)+_0x284fb0+_0x1b8c2f(0x1b9);const _0x2975a5=_0x154893?.[_0x1b8c2f(0x1ac)](new RegExp('@'+username+'\x5cb','gi'),'<span\x20style=\x22color:#ff4081;\x22>@$&</span>');if(_0x3bde8f)_0x423407+='<audio\x20controls\x20src=\x22'+_0x3bde8f+_0x1b8c2f(0x187);else{if(_0x5aba9d){const _0x2b999f=_0x1b8c2f(0x168)+_0x5aba9d;_0x423407+='<audio\x20controls\x20src=\x22'+_0x2b999f+_0x1b8c2f(0x187);}else{if(_0x3c9482){const _0x2551e=_0x1b8c2f(0x10b)+_0x3c9482;_0x423407+=_0x1b8c2f(0x1ae)+_0x2551e+_0x1b8c2f(0x16f);}else _0x423407+=_0x1b8c2f(0x182)+_0x2975a5+'</div>';}}const _0x342bd4=db['ref']('admins/'+roomCode+'/'+sanitizeUsername(_0x46f308));_0x342bd4[_0x1b8c2f(0x111)](_0x1b8c2f(0x169))[_0x1b8c2f(0x1a3)](_0x5aa3f4=>{const _0x34ace9=_0x1b8c2f;if(_0x5aa3f4['exists']()){const _0x4b06a2=_0x23f910[_0x34ace9(0x148)](_0x34ace9(0x17d));_0x4b06a2&&(_0x4b06a2[_0x34ace9(0xf8)]+=_0x34ace9(0xff));}});isRoomAdmin&&_0x151c9e&&(delBtn[_0x1b8c2f(0x180)][_0x1b8c2f(0x196)]=_0x1b8c2f(0x113),delBtn[_0x1b8c2f(0x126)]=()=>{const _0xd32c82=_0x1b8c2f;confirm(_0xd32c82(0x193))&&(db['ref'](_0xd32c82(0x163)+roomCode+_0xd32c82(0xf7)+_0x151c9e)[_0xd32c82(0x1b7)](),_0x23f910[_0xd32c82(0x1b7)]());},_0x23f910[_0x1b8c2f(0x167)](delBtn));_0x23f910[_0x1b8c2f(0xf8)]+=_0x1b8c2f(0x1af)+_0x284fb0+_0x1b8c2f(0x1b9);const _0x5bea98=document[_0x1b8c2f(0xfa)](_0x1b8c2f(0x15b));_0x5bea98['appendChild'](_0x23f910),_0x5bea98[_0x1b8c2f(0x185)]=_0x5bea98[_0x1b8c2f(0x13c)];}function cleanupOldRooms(){const _0x19d859=_0x1f856b;db[_0x19d859(0x159)](_0x19d859(0x13d))['once'](_0x19d859(0x169))[_0x19d859(0x1a3)](_0xdbdef2=>{const _0x25b87d=_0x19d859,_0x22b532=_0xdbdef2[_0x25b87d(0x12a)]();if(!_0x22b532)return;const _0x3296b3=Date[_0x25b87d(0x123)]();for(const _0x549060 in _0x22b532){if(_0x549060===STATIC_ROOM)continue;const _0x5acf3f=_0x22b532[_0x549060];_0x3296b3-(_0x5acf3f['created']||0x0)>0x2*0x3c*0x3e8&&db['ref']('rooms/'+_0x549060)[_0x25b87d(0x1b7)]();}db[_0x25b87d(0x159)](_0x25b87d(0x112))[_0x25b87d(0x111)]('value')[_0x25b87d(0x1a3)](_0x545659=>{const _0x34ab8e=_0x25b87d,_0x2e2d4b=_0x545659[_0x34ab8e(0x12a)]();if(!_0x2e2d4b)return;for(const _0x15a8a8 in _0x2e2d4b){if(_0x15a8a8!==STATIC_ROOM)db[_0x34ab8e(0x159)](_0x34ab8e(0x160)+_0x15a8a8)[_0x34ab8e(0x1b7)]();}}),db[_0x25b87d(0x159)]('antispamBlocked')['once']('value')[_0x25b87d(0x1a3)](_0x22208b=>{const _0x282c56=_0x25b87d,_0x48337e=_0x22208b[_0x282c56(0x12a)]();if(!_0x48337e)return;for(const _0x4ed334 in _0x48337e){if(_0x4ed334!==STATIC_ROOM)db['ref'](_0x282c56(0x19a)+_0x4ed334)['remove']();}});});}document[_0x1f856b(0x1a4)](_0x1f856b(0x108),()=>{const _0x25082f=_0x1f856b,_0x54818e=document[_0x25082f(0xfa)](_0x25082f(0x109));_0x54818e&&_0x54818e[_0x25082f(0x1a4)](_0x25082f(0x110),function(_0x26b505){const _0x12b8e5=_0x25082f;_0x26b505[_0x12b8e5(0x177)]===_0x12b8e5(0x1a6)&&(_0x26b505[_0x12b8e5(0x10e)](),sendMessage());});});function showScreen(_0x5290ea){const _0x1c00fc=_0x1f856b;[_0x1c00fc(0x136),_0x1c00fc(0x101),'codeEntryScreen','chatScreen',_0x1c00fc(0x134),'profileScreen'][_0x1c00fc(0x18e)](_0x54e864=>{const _0x5a4405=_0x1c00fc;document[_0x5a4405(0xfa)](_0x54e864)['style'][_0x5a4405(0x184)]=_0x5a4405(0x12e);}),document['getElementById'](_0x5290ea)[_0x1c00fc(0x180)][_0x1c00fc(0x184)]=_0x1c00fc(0x106);}function genRoomCode(){const _0x1808b6=_0x1f856b,_0x20e05e=_0x1808b6(0x16d),_0x58e47d=_0x1808b6(0x16a),_0x29fd7e=(_0x20ad4f,_0xda0d2c)=>Array['from']({'length':_0xda0d2c},()=>_0x20ad4f[Math['floor'](Math[_0x1808b6(0x12c)]()*_0x20ad4f[_0x1808b6(0x14d)])])[_0x1808b6(0x188)]('');return _0x29fd7e(_0x58e47d,0x3)+_0x29fd7e(_0x20e05e,0x3)+_0x29fd7e(_0x58e47d,0x2)+_0x29fd7e(_0x20e05e,0x2);}function startInactivityTimer(){setInterval(()=>{const _0x5b31cb=_0x686e;Date[_0x5b31cb(0x123)]()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db[_0x5b31cb(0x159)](_0x5b31cb(0x163)+roomCode)[_0x5b31cb(0x16b)]({'active':![]}),alert('Session\x20expired.'),location[_0x5b31cb(0x198)]());},0x7530);}function setupSidebarBackHandler(){const _0x41eece=_0x1f856b;window[_0x41eece(0x1a4)](_0x41eece(0x107),()=>{const _0x1ee8cd=_0x41eece,_0x23b77f=document['getElementById'](_0x1ee8cd(0x16c));_0x23b77f?.[_0x1ee8cd(0x128)][_0x1ee8cd(0x1aa)](_0x1ee8cd(0x11f))&&_0x23b77f[_0x1ee8cd(0x128)]['remove']('show');});}function toggleSidebar(){const _0x8433ce=_0x1f856b,_0x29a3ed=document['getElementById'](_0x8433ce(0x16c));if(!_0x29a3ed[_0x8433ce(0x128)]['contains']('show'))_0x29a3ed['classList'][_0x8433ce(0x1b0)](_0x8433ce(0x11f)),history[_0x8433ce(0x151)]({'sidebarOpen':!![]},'');else{_0x29a3ed['classList'][_0x8433ce(0x1b7)](_0x8433ce(0x11f));if(history[_0x8433ce(0x11b)]?.[_0x8433ce(0x1b4)])history[_0x8433ce(0x18a)]();}}function setupVisibilityAttention(){const _0x1b97ac=_0x1f856b;let _0x52f6ca=0x0,_0xd81ff=document[_0x1b97ac(0x166)];document[_0x1b97ac(0x1a4)](_0x1b97ac(0x143),()=>{const _0x39fe70=_0x1b97ac;!document[_0x39fe70(0x162)]&&(document[_0x39fe70(0x166)]=_0xd81ff,_0x52f6ca=0x0);}),window[_0x1b97ac(0x121)]=function(){const _0x198aa6=_0x1b97ac;document['hidden']&&(_0x52f6ca++,document[_0x198aa6(0x166)]='('+_0x52f6ca+_0x198aa6(0x10c)+_0xd81ff);};}function tryEditProfile(){const _0x28d158=_0x1f856b,_0x9a5124=sanitizeUsername(username);db[_0x28d158(0x159)](_0x28d158(0x13b)+_0x9a5124)[_0x28d158(0x13a)]()[_0x28d158(0x1a3)](_0x7f64f=>{const _0x3f5183=_0x28d158,_0x1bee2d=_0x7f64f[_0x3f5183(0x12a)]();if(!_0x1bee2d)return alert(_0x3f5183(0x190));const _0x26ceda=_0x1bee2d[_0x3f5183(0x175)]||0x0,_0x43bddb=Date[_0x3f5183(0x123)](),_0x740104=0x18*0x3c*0x3c*0x3e8;if(_0x43bddb-_0x26ceda<_0x740104){const _0xa18a85=Math['ceil']((_0x740104-(_0x43bddb-_0x26ceda))/(0x3c*0x3e8));alert('You\x20can\x20change\x20your\x20profile\x20again\x20in\x20'+_0xa18a85+_0x3f5183(0x119));}else showScreen(_0x3f5183(0x1bb)),document[_0x3f5183(0xfa)](_0x3f5183(0x1b2))[_0x3f5183(0x169)]=username,document[_0x3f5183(0xfa)]('profileDescriptionInput')[_0x3f5183(0x169)]=_0x1bee2d[_0x3f5183(0x18b)]||'';});}function listenForUserList(){const _0x1ca9e3=_0x1f856b;db[_0x1ca9e3(0x159)](_0x1ca9e3(0x13f)+roomCode)['on']('value',_0x3c5b67=>{const _0x1c8f9f=_0x1ca9e3,_0x21467c=_0x3c5b67[_0x1c8f9f(0x12a)]()||{},_0x474b08=Date[_0x1c8f9f(0x123)](),_0x313e27=Object[_0x1c8f9f(0x1b6)](_0x21467c)['map'](_0x27f9d2=>{const _0x107418=_0x1c8f9f,_0xd762b7=_0x27f9d2[_0x107418(0x12f)],_0x8d0aab=_0x474b08-_0x27f9d2['lastOnline']<=0x1e*0x3c*0x3e8;if(!_0xd762b7&&!_0x8d0aab)return'';const _0x3c8e98=_0xd762b7?_0x107418(0x19c):_0x107418(0x1a7),_0x1d73aa=_0xd762b7?'üü¢':'üïí',_0x52c318=new Date(_0x27f9d2[_0x107418(0x181)])[_0x107418(0x145)]([],{'hour':_0x107418(0x141),'minute':_0x107418(0x141)}),_0x222d33=_0x27f9d2[_0x107418(0x172)]?_0x107418(0x1a5)+_0x27f9d2[_0x107418(0x172)]+'\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>':_0x107418(0x138),_0x43a6b6=_0x27f9d2[_0x107418(0x1b8)]?'\x20<span\x20style=\x22color:red;\x22>Admin</span>':'';return _0x107418(0x186)+_0x3c8e98+_0x107418(0x15f)+sanitizeUsername(_0x27f9d2[_0x107418(0x129)])+'\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x222d33+_0x1d73aa+'\x20'+_0x27f9d2[_0x107418(0x129)]+_0x43a6b6+_0x107418(0x174);})[_0x1c8f9f(0x188)]('');document[_0x1c8f9f(0xfa)](_0x1c8f9f(0x156))[_0x1c8f9f(0xf8)]=_0x313e27;});}function sendTyping(_0x26b610=![]){const _0x220ace=_0x1f856b,_0x258edf='rooms/'+roomCode+_0x220ace(0x1a8)+clientId;_0x26b610?db['ref'](_0x258edf)[_0x220ace(0x1b7)]():(db[_0x220ace(0x159)](_0x258edf)['set'](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{db['ref'](_0x258edf)['remove']();},0xbb8));}function listenForTyping(){const _0x4efd9f=_0x1f856b,_0x676e38=document[_0x4efd9f(0xfa)](_0x4efd9f(0x15c));db[_0x4efd9f(0x159)](_0x4efd9f(0x163)+roomCode+_0x4efd9f(0x122))['on'](_0x4efd9f(0x169),_0x5a5b98=>{const _0x1b050b=_0x4efd9f,_0x20bd80=_0x5a5b98[_0x1b050b(0x12a)]();if(!_0x20bd80)return _0x676e38[_0x1b050b(0x170)]='';const _0x48db4b=Object['values'](_0x20bd80)[_0x1b050b(0x17e)](_0x4e8b10=>_0x4e8b10!==username);_0x676e38[_0x1b050b(0x170)]=_0x48db4b[_0x1b050b(0x14d)]?_0x48db4b['join'](',\x20')+_0x1b050b(0x115):'';});}function trackPresence(){const _0x415a17=_0x1f856b;if(!username||!roomCode)return;const _0x166dc4=sanitizeUsername(username),_0x32e358=db[_0x415a17(0x159)](_0x415a17(0x13f)+roomCode+'/'+_0x166dc4),_0x1b3c18=localStorage[_0x415a17(0xfb)]('avatar_base64')||'',_0x3310ca={'username':username,'lastOnline':firebase[_0x415a17(0x1a9)][_0x415a17(0x104)][_0x415a17(0x146)],'online':!![],'avatarBase64':_0x1b3c18};db[_0x415a17(0x159)]('admins/'+roomCode+'/'+_0x166dc4)[_0x415a17(0x111)](_0x415a17(0x169))['then'](_0x4a50bd=>{const _0x3b4175=_0x415a17;if(_0x4a50bd[_0x3b4175(0x11d)]())_0x3310ca[_0x3b4175(0x1b8)]=!![];_0x32e358['set'](_0x3310ca),_0x32e358[_0x3b4175(0x13e)]()[_0x3b4175(0x16b)]({'online':![],'lastOnline':Date['now']()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0x32f788){const _0x2ce520=_0x1f856b;if(!_0x32f788['files'][_0x2ce520(0x14d)])return;const _0x3f03cc=new FileReader();_0x3f03cc['onloadend']=()=>{const _0x1f8e12=_0x2ce520,_0x56c65c=_0x3f03cc[_0x1f8e12(0x19b)][_0x1f8e12(0x183)](',')[0x1];localStorage[_0x1f8e12(0x178)]('avatar_base64',_0x56c65c);const _0x1780f7=document[_0x1f8e12(0xfa)]('sidebarAvatarPreview');_0x1780f7['src']=_0x1f8e12(0x10b)+_0x56c65c,_0x1780f7[_0x1f8e12(0x180)][_0x1f8e12(0x184)]='block',trackPresence();},_0x3f03cc[_0x2ce520(0x15d)](_0x32f788['files'][0x0]);}function muteUser(_0x4f521e,_0x475c9e){const _0x166bde=_0x1f856b;if(!isRoomAdmin)return alert(_0x166bde(0x171));const _0x2653cc=Date[_0x166bde(0x123)]()+_0x475c9e*0x3c*0x3e8;db['ref'](_0x166bde(0x1b3)+roomCode+'/'+sanitizeUsername(_0x4f521e))[_0x166bde(0x194)](_0x2653cc);}function unmuteUser(_0xb917b2){const _0x38316f=_0x1f856b;if(!isRoomAdmin)return alert('Admins\x20only.');db['ref'](_0x38316f(0x1b3)+roomCode+'/'+sanitizeUsername(_0xb917b2))[_0x38316f(0x1b7)]();}function updateOnlineIndicator(){const _0x4cb224=_0x1f856b,_0x7afe86=document[_0x4cb224(0xfa)](_0x4cb224(0x165));_0x7afe86[_0x4cb224(0x170)]=_0x4cb224(0x14b),_0x7afe86[_0x4cb224(0x180)]['color']='#00ff88';}setInterval(updateOnlineIndicator,0xbb8);function viewProfile(_0x1d195f){const _0x108241=_0x1f856b;db['ref'](_0x108241(0x13b)+_0x1d195f)[_0x108241(0x13a)]()[_0x108241(0x1a3)](_0x3b92dc=>{const _0x293b38=_0x108241;if(!_0x3b92dc[_0x293b38(0x11d)]())return;const _0xbd18b9=_0x3b92dc[_0x293b38(0x12a)](),_0x33844e=(_0x293b38(0x153)+_0xbd18b9[_0x293b38(0x129)]+_0x293b38(0x137)+(_0xbd18b9[_0x293b38(0x18b)]||_0x293b38(0x195))+_0x293b38(0x16e)+(_0xbd18b9[_0x293b38(0x139)]||[])['join']('\x0a')+_0x293b38(0x10f)+new Date(_0xbd18b9['lastChanged'])['toLocaleString']()+'\x0a\x20\x20\x20\x20')[_0x293b38(0x158)]();document[_0x293b38(0xfa)]('profileContent')[_0x293b38(0x170)]=_0x33844e,document[_0x293b38(0xfa)](_0x293b38(0x150))['style'][_0x293b38(0x184)]=_0x293b38(0x15e);});}function initUsernameFlow(){const _0x41d8e2=_0x1f856b,_0x496053=localStorage[_0x41d8e2(0xfb)](_0x41d8e2(0x14a));!_0x496053?showScreen(_0x41d8e2(0x1bb)):(username=_0x496053,document[_0x41d8e2(0xfa)](_0x41d8e2(0x114))['innerText']=username,showScreen(_0x41d8e2(0x101)));}function closeProfile(){const _0x5de003=_0x1f856b;document[_0x5de003(0xfa)](_0x5de003(0x150))[_0x5de003(0x180)][_0x5de003(0x184)]=_0x5de003(0x12e);}