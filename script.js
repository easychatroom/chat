const _0x556394=_0xbf2e;function _0xbf2e(_0x1b57ad,_0xb134cb){const _0x58e4a0=_0x58e4();return _0xbf2e=function(_0xbf2e40,_0x18419b){_0xbf2e40=_0xbf2e40-0x121;let _0x465984=_0x58e4a0[_0xbf2e40];return _0x465984;},_0xbf2e(_0x1b57ad,_0xb134cb);}(function(_0x26d135,_0x37a755){const _0x190f30=_0xbf2e,_0x3fb4d5=_0x26d135();while(!![]){try{const _0x5b9739=parseInt(_0x190f30(0x130))/0x1*(parseInt(_0x190f30(0x126))/0x2)+-parseInt(_0x190f30(0x163))/0x3*(parseInt(_0x190f30(0x182))/0x4)+parseInt(_0x190f30(0x174))/0x5*(parseInt(_0x190f30(0x12e))/0x6)+parseInt(_0x190f30(0x12b))/0x7*(-parseInt(_0x190f30(0x159))/0x8)+-parseInt(_0x190f30(0x145))/0x9+-parseInt(_0x190f30(0x191))/0xa*(-parseInt(_0x190f30(0x18f))/0xb)+parseInt(_0x190f30(0x17e))/0xc;if(_0x5b9739===_0x37a755)break;else _0x3fb4d5['push'](_0x3fb4d5['shift']());}catch(_0x1d085d){_0x3fb4d5['push'](_0x3fb4d5['shift']());}}}(_0x58e4,0x2d747));const firebaseConfig={'apiKey':_0x556394(0x140),'authDomain':'easy-chatroom.firebaseapp.com','databaseURL':_0x556394(0x14b),'projectId':_0x556394(0x15c),'storageBucket':_0x556394(0x13d),'messagingSenderId':'985049198428','appId':'1:985049198428:web:d0eb7e2de39887710c9b99','measurementId':_0x556394(0x157)};firebase['initializeApp'](firebaseConfig);function _0x58e4(){const _0x588299=['11wOsift','rooms/','695820AfZsCZ','value','ABCDEFGHIJKLMNOPQRSTUVWXYZ','/typing','typing','from','2158lDvyzc','roomChoiceScreen','substr','active','#00ff88','4319UuoyeC','/messages','onDisconnect','6iskzYi','now','277mtsCir','messages','innerText','msgInput','exists','floor','usernameInput','pushState','050BBB66HH','/messages/','received','values','addEventListener','easy-chatroom.firebasestorage.app','remove','random','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','innerHTML','</span><br>','sent','system','2386674mMUYLG','TIMESTAMP','onload','appendChild','sidebarOpen','join','https://easy-chatroom-default-rtdb.firebaseio.com','reload','flex','state','trim','2-digit','rooms','userList','chat_username','div','none','toUpperCase','G-QDESJ2WR42','roomCodeInput','3952XPVMCW','namePreview','child_added','easy-chatroom','üóëÔ∏è\x20Deleted\x20expired\x20room:','Please\x20enter\x20your\x20name','limitToLast','online','users/','codeEntryScreen','9981fzTPPD','get','val','contains','push','add','createElement','ref','getElementById','System','\x20typing...','setItem','msg','filter','classList','<small>','then','619630aGYPAO','username','beforeunload','back','toString','length','userSidebar','display','update','show','6479004YLnPhB','entries','keypress','chatScreen','332fREmFk','set','lastOnline','DOMContentLoaded','key','database','map','#888','0123456789','once','style','/typing/','usernameScreen'];_0x58e4=function(){return _0x588299;};return _0x58e4();}const db=firebase[_0x556394(0x187)](),STATIC_ROOM=_0x556394(0x138),ROOM_TTL_MS=0x2*0x3c*0x3e8;let username=localStorage['getItem'](_0x556394(0x153)),roomCode='',clientId=generateClientId(),lastActivity=Date[_0x556394(0x12f)](),typingTimeout;const userKey=sanitizeUsername(username);window[_0x556394(0x147)]=()=>{initUsernameFlow(),cleanupOldRooms(),setupSidebarBackHandler();};function initUsernameFlow(){const _0x34768b=_0x556394;username=localStorage['getItem']('chat_username'),!username?showScreen(_0x34768b(0x18e)):(document['getElementById']('namePreview')[_0x34768b(0x132)]=username,showScreen('roomChoiceScreen'));}function saveUsername(){const _0x7f6993=_0x556394;username=document[_0x7f6993(0x16b)](_0x7f6993(0x136))[_0x7f6993(0x121)][_0x7f6993(0x14f)]();if(!username)return alert(_0x7f6993(0x15e));localStorage[_0x7f6993(0x16e)](_0x7f6993(0x153),username),document['getElementById'](_0x7f6993(0x15a))['innerText']=username,showScreen(_0x7f6993(0x127));}function generateRoom(){const _0x170180=_0x556394;roomCode=genRoomCode(),db[_0x170180(0x16a)](_0x170180(0x190)+roomCode)['set']({'active':!![],'created':Date[_0x170180(0x12f)]()}),startChat();}function joinRoom(){const _0x258166=_0x556394;roomCode=document[_0x258166(0x16b)](_0x258166(0x158))[_0x258166(0x121)][_0x258166(0x14f)]()[_0x258166(0x156)]();if(!roomCode)return alert('Enter\x20a\x20valid\x20room\x20code');db[_0x258166(0x16a)](_0x258166(0x190)+roomCode)[_0x258166(0x164)]()[_0x258166(0x173)](_0x464e9e=>{const _0x3b19f7=_0x258166;_0x464e9e[_0x3b19f7(0x134)]()&&_0x464e9e['val']()[_0x3b19f7(0x129)]!==![]?startChat():alert('Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.');});}function joinGlobalRoom(){const _0x116d9b=_0x556394;roomCode=_0x116d9b(0x138),db[_0x116d9b(0x16a)](_0x116d9b(0x190)+roomCode)[_0x116d9b(0x183)]({'active':!![],'created':Date['now']()}),startChat();}function startChat(){const _0x39f364=_0x556394;showScreen(_0x39f364(0x181)),document[_0x39f364(0x16b)]('userDisplay')['innerText']=username,document['getElementById']('roomDisplay')['innerText']=roomCode,listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList(),logSystemMessage(username+'\x20joined\x20the\x20room'),window['addEventListener'](_0x39f364(0x176),()=>{logSystemMessage(username+'\x20left\x20the\x20room');});}function trackPresence(){const _0x3a8d68=_0x556394,_0x1826a5=sanitizeUsername(username),_0x40ee54=db[_0x3a8d68(0x16a)](_0x3a8d68(0x161)+roomCode+'/'+_0x1826a5),_0x3645c0={'username':username,'lastOnline':firebase[_0x3a8d68(0x187)]['ServerValue'][_0x3a8d68(0x146)],'online':!![]};_0x40ee54[_0x3a8d68(0x183)](_0x3645c0),_0x40ee54[_0x3a8d68(0x12d)]()[_0x3a8d68(0x17c)]({'online':![],'lastOnline':Date[_0x3a8d68(0x12f)]()});}function listenForUserList(){const _0x3fa4de=_0x556394;db['ref'](_0x3fa4de(0x161)+roomCode)['on'](_0x3fa4de(0x121),_0x3a6905=>{const _0xd2bff1=_0x3fa4de,_0x566589=_0x3a6905['val']()||{},_0xf92eb=Date[_0xd2bff1(0x12f)](),_0x4f49a6=Object[_0xd2bff1(0x13b)](_0x566589)[_0xd2bff1(0x170)](_0x5c83fb=>_0x5c83fb[_0xd2bff1(0x175)])[_0xd2bff1(0x188)](_0x484373=>{const _0x325836=_0xd2bff1,_0x38b9eb=_0x484373[_0x325836(0x160)],_0x211c67=_0xf92eb-_0x484373[_0x325836(0x184)]<=0x1e*0x3c*0x3e8;if(!_0x38b9eb&&!_0x211c67)return'';const _0x275a4d=_0x38b9eb?_0x325836(0x12a):_0x325836(0x189),_0x3edc98=_0x38b9eb?'üü¢':'üïí';return'<li\x20style=\x22color:'+_0x275a4d+'\x22>'+_0x3edc98+'\x20'+_0x484373[_0x325836(0x175)]+'</li>';})[_0xd2bff1(0x14a)]('');document[_0xd2bff1(0x16b)](_0xd2bff1(0x152))[_0xd2bff1(0x141)]=_0x4f49a6;});}function logSystemMessage(_0xc2695d){const _0x5ca84c=_0x556394,_0x4d8ccb=db[_0x5ca84c(0x16a)]()[_0x5ca84c(0x167)]()[_0x5ca84c(0x186)];db[_0x5ca84c(0x16a)](_0x5ca84c(0x190)+roomCode+_0x5ca84c(0x139)+_0x4d8ccb)[_0x5ca84c(0x183)]({'msg':_0xc2695d,'sender':_0x5ca84c(0x16c),'senderId':_0x5ca84c(0x144),'timestamp':Date[_0x5ca84c(0x12f)]()});}function setupSidebarBackHandler(){const _0x2a1eed=_0x556394;window[_0x2a1eed(0x13c)]('popstate',()=>{const _0x3633d0=_0x2a1eed,_0x2e77de=document[_0x3633d0(0x16b)](_0x3633d0(0x17a));_0x2e77de?.[_0x3633d0(0x171)][_0x3633d0(0x166)](_0x3633d0(0x17d))&&_0x2e77de[_0x3633d0(0x171)][_0x3633d0(0x13e)](_0x3633d0(0x17d));});}function toggleSidebar(){const _0x3e0cc8=_0x556394,_0xe26d4f=document[_0x3e0cc8(0x16b)](_0x3e0cc8(0x17a));if(!_0xe26d4f[_0x3e0cc8(0x171)][_0x3e0cc8(0x166)]('show'))_0xe26d4f['classList']['add'](_0x3e0cc8(0x17d)),history[_0x3e0cc8(0x137)]({'sidebarOpen':!![]},'');else{_0xe26d4f['classList'][_0x3e0cc8(0x13e)](_0x3e0cc8(0x17d));if(history[_0x3e0cc8(0x14e)]?.[_0x3e0cc8(0x149)])history[_0x3e0cc8(0x177)]();}}document['addEventListener'](_0x556394(0x185),()=>{const _0x168948=_0x556394,_0x17b65d=document[_0x168948(0x16b)](_0x168948(0x133));_0x17b65d&&_0x17b65d[_0x168948(0x13c)](_0x168948(0x180),function(_0x48dbcd){const _0x40dafd=_0x168948;_0x48dbcd[_0x40dafd(0x186)]==='Enter'&&(_0x48dbcd['preventDefault'](),sendMessage());});});function showScreen(_0x49091f){const _0x547fc7=_0x556394;['usernameScreen',_0x547fc7(0x127),_0x547fc7(0x162),'chatScreen']['forEach'](_0xd0974=>{const _0x2bb020=_0x547fc7;document[_0x2bb020(0x16b)](_0xd0974)[_0x2bb020(0x18c)][_0x2bb020(0x17b)]=_0x2bb020(0x155);}),document['getElementById'](_0x49091f)[_0x547fc7(0x18c)][_0x547fc7(0x17b)]=_0x547fc7(0x14d);}function sendMessage(){const _0x5b50f4=_0x556394,_0x5d3644=document['getElementById'](_0x5b50f4(0x133)),_0x1b7351=_0x5d3644[_0x5b50f4(0x121)][_0x5b50f4(0x14f)]();if(!_0x1b7351)return;const _0xc39a2c=db['ref']()['push']()[_0x5b50f4(0x186)];db[_0x5b50f4(0x16a)](_0x5b50f4(0x190)+roomCode+_0x5b50f4(0x139)+_0xc39a2c)[_0x5b50f4(0x183)]({'msg':_0x1b7351,'sender':username,'senderId':clientId,'timestamp':Date['now']()}),_0x5d3644[_0x5b50f4(0x121)]='',sendTyping(!![]),lastActivity=Date['now']();}function listenForMessages(){const _0x33c655=_0x556394,_0x99174f=db[_0x33c655(0x16a)]('rooms/'+roomCode+_0x33c655(0x12c)),_0x2849e5=roomCode===STATIC_ROOM?_0x99174f[_0x33c655(0x15f)](0x50):_0x99174f;_0x2849e5['on'](_0x33c655(0x15b),_0x18e67b=>{const _0x5f5241=_0x33c655,{msg:_0x1359ff,sender:_0x4efa06,senderId:_0x4ea257,timestamp:_0xc07f4b}=_0x18e67b[_0x5f5241(0x165)](),_0x2f8252=_0x4ea257===clientId;addMessage(_0x1359ff,_0x4efa06,_0xc07f4b,_0x2f8252),roomCode!==STATIC_ROOM&&db[_0x5f5241(0x16a)]('rooms/'+roomCode+'/messages/'+_0x18e67b[_0x5f5241(0x186)])[_0x5f5241(0x13e)]();});}function addMessage(_0x1408dd,_0x157496,_0x4f79ae,_0xe1dd2){const _0x3bfd2b=_0x556394,_0x2e4b84=document[_0x3bfd2b(0x169)](_0x3bfd2b(0x154));_0x2e4b84[_0x3bfd2b(0x171)][_0x3bfd2b(0x168)](_0x3bfd2b(0x16f),_0xe1dd2?_0x3bfd2b(0x143):_0x3bfd2b(0x13a));const _0x11126c=new Date(_0x4f79ae)['toLocaleTimeString']([],{'hour':_0x3bfd2b(0x150),'minute':_0x3bfd2b(0x150)});_0x2e4b84[_0x3bfd2b(0x141)]='<span\x20class=\x22sender-name\x22>'+_0x157496+_0x3bfd2b(0x142)+_0x1408dd+_0x3bfd2b(0x172)+_0x11126c+'</small>',document[_0x3bfd2b(0x16b)](_0x3bfd2b(0x131))[_0x3bfd2b(0x148)](_0x2e4b84),document['getElementById']('messages')['scrollTop']=0x1869f;}function sendTyping(_0x50641c=![]){const _0x2b4a7b=_0x556394;_0x50641c?db['ref']('rooms/'+roomCode+_0x2b4a7b(0x18d)+clientId)['remove']():(db['ref']('rooms/'+roomCode+_0x2b4a7b(0x18d)+clientId)[_0x2b4a7b(0x183)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x412b9c=_0x2b4a7b;db[_0x412b9c(0x16a)](_0x412b9c(0x190)+roomCode+_0x412b9c(0x18d)+clientId)[_0x412b9c(0x13e)]();},0xbb8));}function listenForTyping(){const _0x5db485=_0x556394,_0x34b1f7=document['getElementById'](_0x5db485(0x124));db[_0x5db485(0x16a)](_0x5db485(0x190)+roomCode+_0x5db485(0x123))['on'](_0x5db485(0x121),_0x37c135=>{const _0x56499e=_0x5db485,_0x3a8f95=_0x37c135[_0x56499e(0x165)]();if(!_0x3a8f95)return _0x34b1f7[_0x56499e(0x132)]='';const _0x14100e=Object[_0x56499e(0x13b)](_0x3a8f95)[_0x56499e(0x170)](_0x2840f3=>_0x2840f3!==username);_0x34b1f7[_0x56499e(0x132)]=_0x14100e[_0x56499e(0x179)]?_0x14100e['join'](',\x20')+_0x56499e(0x16d):'';});}function startInactivityTimer(){setInterval(()=>{const _0x2ba9d9=_0xbf2e;Date['now']()-lastActivity>0x5*0x3c*0x3e8&&(db[_0x2ba9d9(0x16a)](_0x2ba9d9(0x190)+roomCode)[_0x2ba9d9(0x17c)]({'active':![]}),alert('Session\x20expired.'),location[_0x2ba9d9(0x14c)]());},0x7530);}function genRoomCode(){const _0x418c1d=_0x556394,_0xa10940=_0x418c1d(0x122),_0x2ff9d9=_0x418c1d(0x18a),_0x56ade3=(_0x102f78,_0x4ba3a9)=>Array[_0x418c1d(0x125)]({'length':_0x4ba3a9},()=>_0x102f78[Math[_0x418c1d(0x135)](Math[_0x418c1d(0x13f)]()*_0x102f78[_0x418c1d(0x179)])])['join']('');return _0x56ade3(_0x2ff9d9,0x3)+_0x56ade3(_0xa10940,0x3)+_0x56ade3(_0x2ff9d9,0x2)+_0x56ade3(_0xa10940,0x2);}function generateClientId(){const _0x1f2ae9=_0x556394;return'_'+Math[_0x1f2ae9(0x13f)]()[_0x1f2ae9(0x178)](0x24)[_0x1f2ae9(0x128)](0x2,0x9);}function cleanupOldRooms(){const _0x139ccd=_0x556394;db[_0x139ccd(0x16a)](_0x139ccd(0x151))[_0x139ccd(0x18b)](_0x139ccd(0x121))[_0x139ccd(0x173)](_0xa8798=>{const _0x427fde=_0x139ccd,_0x327039=_0xa8798[_0x427fde(0x165)]();if(!_0x327039)return;const _0x2346c1=Date['now']();Object[_0x427fde(0x17f)](_0x327039)['forEach'](([_0x4c2693,_0x34e93b])=>{const _0x2fc33d=_0x427fde;if(_0x4c2693===STATIC_ROOM)return;const _0x14acbf=_0x34e93b['created']||0x0,_0x2d6a6f=_0x2346c1-_0x14acbf>ROOM_TTL_MS;_0x2d6a6f&&(db[_0x2fc33d(0x16a)](_0x2fc33d(0x190)+_0x4c2693)[_0x2fc33d(0x13e)](),console['log'](_0x2fc33d(0x15d),_0x4c2693));});});}function sanitizeUsername(_0x211bb9){return _0x211bb9['replace'](/[.#$\[\]]/g,'_');}