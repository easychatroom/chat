const _0x474db9=_0x13bf;(function(_0x1d0022,_0x209ad1){const _0x549516=_0x13bf,_0x334672=_0x1d0022();while(!![]){try{const _0x40589d=-parseInt(_0x549516(0x184))/0x1*(-parseInt(_0x549516(0x19b))/0x2)+-parseInt(_0x549516(0x1d5))/0x3*(-parseInt(_0x549516(0x1a1))/0x4)+parseInt(_0x549516(0x1a3))/0x5+parseInt(_0x549516(0x1b8))/0x6+-parseInt(_0x549516(0x1d3))/0x7*(-parseInt(_0x549516(0x1d9))/0x8)+-parseInt(_0x549516(0x1e2))/0x9*(parseInt(_0x549516(0x185))/0xa)+-parseInt(_0x549516(0x192))/0xb;if(_0x40589d===_0x209ad1)break;else _0x334672['push'](_0x334672['shift']());}catch(_0xd59e06){_0x334672['push'](_0x334672['shift']());}}}(_0x494a,0x752c7));const firebaseConfig={'apiKey':_0x474db9(0x20c),'authDomain':_0x474db9(0x226),'databaseURL':_0x474db9(0x19a),'projectId':'easy-chatroom','storageBucket':_0x474db9(0x17a),'messagingSenderId':'985049198428','appId':_0x474db9(0x212),'measurementId':_0x474db9(0x16e)};firebase[_0x474db9(0x183)](firebaseConfig);const db=firebase[_0x474db9(0x1da)]();let roomUsers={},userListReady=![],pendingMessages=[],messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math[_0x474db9(0x1cb)]()[_0x474db9(0x224)](0x24)[_0x474db9(0x1e6)](0x2,0x9),lastActivity=Date[_0x474db9(0x18f)](),typingTimeout,gr8stg='';const STATIC_ROOM='050BBB66HH',MAX_MESSAGES=0xfa,sound=new Audio(_0x474db9(0x1bf));sound[_0x474db9(0x1ac)]=0.3;function _0x494a(){const _0x2c01b7=['easy-chatroom.firebaseapp.com','passwordError','push','onloadend','classList','userList','[Voice\x20message]','getItem','No\x20bio\x20set','\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>','forEach','G-QDESJ2WR42','toUpperCase','then','data:audio/webm;base64,','<span\x20style=\x22margin-right:5px;\x22>üë§</span>','filter','rooms/','get','antispam','antispam/','values','</div>','easy-chatroom.firebasestorage.app','.sender-name','ref','</small>','lastChanged','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','profileContent','Profile\x20not\x20found.','üéôÔ∏è','initializeApp','8791yYNDQd','14230NgXQlS','<span\x20style=\x22color:#ff4081;\x22>@$&</span>','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','avatarBase64','addEventListener','from','placeholder','staticPasswordInput','Session\x20expired.','join','now','<img\x20src=\x22data:image/png;base64,','profileUsernameInput','14671173acZGSS','reload','color','trim','createElement','start',';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27','audio/webm','https://easy-chatroom-default-rtdb.firebaseio.com','90KyVaIz','profileScreen','usernameHistory','\x0aDescription:\x20','/messages/','audioUrl','15788EkAxNG','key','2747080eHNIjQ','online','Admins\x20only.','appendChild','received','data:image/png;base64,','style','setItem','limitToLast','volume','stop','<li\x20style=\x22color:','scrollTop','Microphone\x20permission\x20denied.','antispamBlocked','Missing\x20room\x20or\x20user\x20information.','profile_description','</span>','disabled','value','profileViewer','3001302WMUQdB','onload','admin','remove','innerHTML','keypress','onstop','sounds/beep.mp3','scrollHeight','admins/','2-digit','innerText','<audio\x20controls\x20src=\x22','display','once','profileDescriptionInput','/typing/','popstate','muted/','random','TIMESTAMP','ondataavailable','onDisconnect','‚ùå\x20Username\x20already\x20taken.','<span\x20style=\x22margin-right:8px;\x22>üë§</span>','Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.','block','7oPTqBf','‚ö†Ô∏è\x20Could\x20not\x20check\x20username.\x20Try\x20again.','288kAXaYT','description','title','\x20minutes.','5847432CEkUrC','database','/typing','created','replace','back','namePreview','contains','You\x20can\x20change\x20your\x20profile\x20again\x20in\x20','4689RBTKZb','audioBase64','active','sent','substr','#888','chatScreen','update','set','pushState','\x0aLast\x20Changed:\x20','error','none','avatar_base64','chat_username','files','codeEntryScreen','\x0a\x20\x20\x20\x20\x20\x20</li>','map','typing','catch','add','<img\x20src=\x22','0123456789','roomChoiceScreen','msgInput','<small>',')\x20New\x20message\x20‚Ä¢\x20','profiles/','rooms','src','roomCodeInput','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','length','data','child_added','mediaDevices','roomDisplay','floor','show','split','msg','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','userSidebar','exists','No\x20room\x20code\x20available\x20for\x20private\x20rooms','ABCDEFGHIJKLMNOPQRSTUVWXYZ','Error\x20checking\x20username:','1:985049198428:web:d0eb7e2de39887710c9b99','Enter','<div>','username','\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>','ServerValue','div','passwordScreen','val','getElementById','Enter\x20a\x20valid\x20room\x20code','#00ff88','profileError','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toLocaleString','users/','usernameScreen','play','toString','gr8stg'];_0x494a=function(){return _0x2c01b7;};return _0x494a();}let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x32266e=db['ref']('admins/'+roomCode+'/'+sanitizeUsername(username));return _0x32266e['once']('value')['then'](_0x416bd5=>{const _0x18ceaa=_0x13bf;isRoomAdmin=_0x416bd5[_0x18ceaa(0x20e)]();});}function toggleRecording(){const _0xce9fd1=_0x474db9;isRecording?stopRecording():navigator[_0xce9fd1(0x206)]['getUserMedia']({'audio':!![]})['then'](_0x56997e=>{const _0x8c1c3a=_0xce9fd1;mediaRecorder=new MediaRecorder(_0x56997e),mediaRecorder[_0x8c1c3a(0x197)](),isRecording=!![],document[_0x8c1c3a(0x21b)]('recordBtn')[_0x8c1c3a(0x1c3)]='‚èπÔ∏è',audioChunks=[],mediaRecorder[_0x8c1c3a(0x1cd)]=_0x2c31aa=>audioChunks[_0x8c1c3a(0x228)](_0x2c31aa[_0x8c1c3a(0x204)]),mediaRecorder[_0x8c1c3a(0x1be)]=()=>{const _0x3d0bf1=_0x8c1c3a;clearTimeout(recordingTimer);const _0xc73ea0=new Blob(audioChunks,{'type':_0x3d0bf1(0x199)}),_0x25be62=new FileReader();_0x25be62['onloadend']=()=>{const _0x375ce3=_0x3d0bf1,_0x57cdf9=_0x25be62['result']['split'](',')[0x1],_0x317352=db['ref']()[_0x375ce3(0x228)]()[_0x375ce3(0x1a2)];db[_0x375ce3(0x17c)](_0x375ce3(0x174)+roomCode+_0x375ce3(0x19f)+_0x317352)[_0x375ce3(0x1ea)]({'msg':_0x375ce3(0x169),'audioBase64':_0x57cdf9,'sender':username,'senderId':clientId,'timestamp':Date[_0x375ce3(0x18f)]()});},_0x25be62['readAsDataURL'](_0xc73ea0);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0xce9fd1(0x1f6)](_0x1d5c5e=>{const _0x3fe807=_0xce9fd1;alert(_0x3fe807(0x1b0));});}function stopRecording(){const _0x47152f=_0x474db9;mediaRecorder&&isRecording&&(mediaRecorder[_0x47152f(0x1ad)](),isRecording=![],document['getElementById']('recordBtn')[_0x47152f(0x1c3)]=_0x47152f(0x182));}window[_0x474db9(0x1b9)]=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x28d6c3){const _0x13abe5=_0x474db9;return _0x28d6c3[_0x13abe5(0x1dd)](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x2ba553=_0x474db9,_0xe574e6=document[_0x2ba553(0x21b)](_0x2ba553(0x191))[_0x2ba553(0x1b6)][_0x2ba553(0x195)](),_0x4ddf80=document[_0x2ba553(0x21b)](_0x2ba553(0x1c7))[_0x2ba553(0x1b6)][_0x2ba553(0x195)](),_0xbd3bed=document[_0x2ba553(0x21b)](_0x2ba553(0x21e));if(!_0xe574e6||!_0x4ddf80){_0xbd3bed[_0x2ba553(0x1c3)]=_0x2ba553(0x1d1),_0xbd3bed[_0x2ba553(0x1a9)][_0x2ba553(0x1c5)]=_0x2ba553(0x1d2);return;}const _0x9f3668=sanitizeUsername(_0xe574e6),_0x2898f3=db[_0x2ba553(0x17c)]('profiles/'+_0x9f3668);_0x2898f3[_0x2ba553(0x1c6)]('value')[_0x2ba553(0x170)](_0x16b69a=>{const _0x5c007b=_0x2ba553;if(_0x16b69a[_0x5c007b(0x20e)]())_0xbd3bed[_0x5c007b(0x1c3)]=_0x5c007b(0x1cf),_0xbd3bed[_0x5c007b(0x1a9)][_0x5c007b(0x1c5)]='block';else{const _0xa6a008={'username':_0xe574e6,'description':_0x4ddf80,'lastChanged':Date[_0x5c007b(0x18f)](),'usernameHistory':[_0xe574e6]};_0x2898f3[_0x5c007b(0x1ea)](_0xa6a008,_0x429221=>{const _0x10d7d5=_0x5c007b;_0x429221?(console[_0x10d7d5(0x1ed)]('Failed\x20to\x20save\x20profile:',_0x429221),_0xbd3bed[_0x10d7d5(0x1c3)]='‚ö†Ô∏è\x20Failed\x20to\x20save\x20profile.\x20Try\x20again.',_0xbd3bed['style'][_0x10d7d5(0x1c5)]='block'):(localStorage[_0x10d7d5(0x1aa)](_0x10d7d5(0x1f0),_0xe574e6),localStorage[_0x10d7d5(0x1aa)](_0x10d7d5(0x1b3),_0x4ddf80),username=_0xe574e6,document[_0x10d7d5(0x21b)](_0x10d7d5(0x1df))[_0x10d7d5(0x1c3)]=_0xe574e6,showScreen('roomChoiceScreen'));});}})['catch'](_0x261f18=>{const _0x48d847=_0x2ba553;console[_0x48d847(0x1ed)](_0x48d847(0x211),_0x261f18),_0xbd3bed[_0x48d847(0x1c3)]=_0x48d847(0x1d4),_0xbd3bed[_0x48d847(0x1a9)][_0x48d847(0x1c5)]=_0x48d847(0x1d2);});}function saveProfile(_0x45b123,_0x527e9d,_0x23b8b0){const _0x484230=_0x474db9,_0x11dfd7=Date[_0x484230(0x18f)](),_0x39e339=[_0x45b123];db[_0x484230(0x17c)](_0x484230(0x1fe)+_0x23b8b0)['set']({'username':_0x45b123,'description':_0x527e9d,'lastChanged':_0x11dfd7,'usernameHistory':_0x39e339}),localStorage[_0x484230(0x1aa)](_0x484230(0x1f0),_0x45b123),localStorage[_0x484230(0x1aa)](_0x484230(0x1b3),_0x527e9d),document[_0x484230(0x21b)](_0x484230(0x1df))[_0x484230(0x1c3)]=_0x45b123,showScreen(_0x484230(0x1fa));}function generateRoom(){const _0x3b365e=_0x474db9;roomCode=genRoomCode(),db[_0x3b365e(0x17c)]('rooms/'+roomCode)[_0x3b365e(0x1ea)]({'active':!![],'created':Date['now']()}),startChat();}function joinRoom(){const _0x438769=_0x474db9,_0x86d4a1=roomCode||document['getElementById'](_0x438769(0x201))[_0x438769(0x1b6)][_0x438769(0x195)]()[_0x438769(0x16f)]();if(!_0x86d4a1)return alert(_0x438769(0x21c));roomCode=_0x86d4a1;if(roomCode===STATIC_ROOM){showScreen(_0x438769(0x219));return;}db[_0x438769(0x17c)](_0x438769(0x174)+roomCode)[_0x438769(0x175)]()['then'](_0x1b58a5=>{const _0x25be84=_0x438769;_0x1b58a5[_0x25be84(0x20e)]()&&_0x1b58a5[_0x25be84(0x21a)]()[_0x25be84(0x1e4)]!==![]?startChat():alert(_0x25be84(0x202));});}function _0x13bf(_0x555872,_0x19722f){const _0x494a6=_0x494a();return _0x13bf=function(_0x13bf3a,_0x36fd18){_0x13bf3a=_0x13bf3a-0x167;let _0x376919=_0x494a6[_0x13bf3a];return _0x376919;},_0x13bf(_0x555872,_0x19722f);}function startChat(){const _0x1e605c=_0x474db9;if(!roomCode||!username)return alert(_0x1e605c(0x1b2)),showScreen(_0x1e605c(0x1fa));checkIfAdmin()['then'](()=>{const _0x54028e=_0x1e605c,_0x17d980=sanitizeUsername(username),_0xc0a245=db[_0x54028e(0x17c)](_0x54028e(0x221)+roomCode+'/'+_0x17d980),_0x33a2e3={'username':username,'lastOnline':firebase['database'][_0x54028e(0x217)][_0x54028e(0x1cc)],'online':!![]};db[_0x54028e(0x17c)](_0x54028e(0x1c1)+roomCode+'/'+_0x17d980)[_0x54028e(0x1c6)]('value')[_0x54028e(0x170)](_0x1d5bd9=>{const _0x523af8=_0x54028e;_0x1d5bd9[_0x523af8(0x20e)]()&&(_0x33a2e3[_0x523af8(0x1ba)]=!![]),_0xc0a245['set'](_0x33a2e3,_0x2ca2bd=>{const _0x3c2e45=_0x523af8;if(_0x2ca2bd)return alert('Failed\x20to\x20register\x20user\x20in\x20room.'),showScreen(_0x3c2e45(0x1fa));_0xc0a245[_0x3c2e45(0x1ce)]()[_0x3c2e45(0x1e9)]({'online':![],'lastOnline':Date[_0x3c2e45(0x18f)]()}),document[_0x3c2e45(0x21b)]('userDisplay')['innerText']=username,roomCode===STATIC_ROOM?document[_0x3c2e45(0x21b)]('roomDisplay')[_0x3c2e45(0x1c3)]=_0x3c2e45(0x20f):document[_0x3c2e45(0x21b)](_0x3c2e45(0x207))[_0x3c2e45(0x1c3)]=roomCode,showScreen('chatScreen'),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x5cb725=_0x474db9,_0x4330b5=document[_0x5cb725(0x21b)](_0x5cb725(0x18c))['value'],_0x6064bf=document[_0x5cb725(0x21b)](_0x5cb725(0x227));db[_0x5cb725(0x17c)](_0x5cb725(0x225))[_0x5cb725(0x175)]()[_0x5cb725(0x170)](_0x450a52=>{const _0x10adc3=_0x5cb725,_0x59ad6a=_0x450a52[_0x10adc3(0x21a)]();_0x4330b5===_0x59ad6a?(_0x6064bf[_0x10adc3(0x1a9)]['display']=_0x10adc3(0x1ee),startChat()):_0x6064bf['style'][_0x10adc3(0x1c5)]='block';});}const spamTimestamps=[];function sendMessage(){const _0x514c77=_0x474db9,_0x2a59a5=document[_0x514c77(0x21b)](_0x514c77(0x1fb)),_0x2ebfae=_0x2a59a5[_0x514c77(0x1b6)][_0x514c77(0x195)]();if(!_0x2ebfae||isBlocked)return;const _0x23a936=Date[_0x514c77(0x18f)]();spamTimestamps[_0x514c77(0x228)](_0x23a936);const _0xc9f147=spamTimestamps[_0x514c77(0x173)](_0x501207=>_0x23a936-_0x501207<0x1b58);if(_0xc9f147[_0x514c77(0x203)]>0x5){isBlocked=!![],_0x2a59a5['disabled']=!![],_0x2a59a5[_0x514c77(0x18b)]='‚õî\x20You\x27re\x20blocked\x20for\x20spamming\x20(30s)',alert('‚õî\x20You‚Äôve\x20been\x20muted\x20for\x20spamming.\x20Please\x20wait\x2030\x20seconds.'),setTimeout(()=>{const _0x2b0ee9=_0x514c77;isBlocked=![],_0x2a59a5[_0x2b0ee9(0x1b5)]=![],_0x2a59a5['placeholder']='Type\x20a\x20message...',spamTimestamps[_0x2b0ee9(0x203)]=0x0;},0x7530);return;}const _0xefca25=localStorage[_0x514c77(0x16a)](_0x514c77(0x1ef))||'',_0x26d878=db[_0x514c77(0x17c)]()[_0x514c77(0x228)]()[_0x514c77(0x1a2)];db[_0x514c77(0x17c)](_0x514c77(0x174)+roomCode+_0x514c77(0x19f)+_0x26d878)[_0x514c77(0x1ea)]({'msg':_0x2ebfae,'sender':username,'senderId':clientId,'avatarBase64':_0xefca25,'timestamp':_0x23a936}),_0x2a59a5[_0x514c77(0x1b6)]='',sendTyping(!![]),lastActivity=_0x23a936;}function listenForMessages(){const _0x4fe241=_0x474db9,_0x1c4483=db[_0x4fe241(0x17c)]('rooms/'+roomCode+'/messages'),_0x248f51=_0x1c4483[_0x4fe241(0x1ab)](MAX_MESSAGES);_0x248f51['on'](_0x4fe241(0x205),_0x52196a=>{const _0x2b75ae=_0x4fe241,_0x429061=_0x52196a[_0x2b75ae(0x21a)](),{senderId:_0x2246e5}=_0x429061,_0xa4146d=_0x2246e5===clientId;if(!userListReady){pendingMessages['push']({'data':_0x429061,'sent':_0xa4146d,'key':_0x52196a[_0x2b75ae(0x1a2)]});return;}const _0x3e3fe3=_0x429061[_0x2b75ae(0x1a0)]||null,_0x2fff3b=_0x429061[_0x2b75ae(0x1e3)]||null;addMessage(_0x429061,_0xa4146d,_0x52196a['key']),roomCode!==STATIC_ROOM&&db[_0x2b75ae(0x17c)]('rooms/'+roomCode+'/messages/'+_0x52196a['key'])['remove'](),!_0xa4146d&&(sound[_0x2b75ae(0x223)](),flagPageAttention());});}function addMessage(_0x25a06d,_0x5a620f,_0x57c7ef=null){const _0x23f687=_0x474db9,{msg:_0x28a1a8,sender:_0x38d1b9,senderId:_0x2929d8,timestamp:_0x6b4aca,audioUrl:_0x2d2fe1,audioBase64:_0x5cb17b,imageBase64:_0x293fd1,avatarBase64:_0x2cbf29}=_0x25a06d,_0x4ca469=document[_0x23f687(0x196)](_0x23f687(0x218));_0x4ca469[_0x23f687(0x167)][_0x23f687(0x1f7)](_0x23f687(0x20b),_0x5a620f?_0x23f687(0x1e5):_0x23f687(0x1a7));const _0x426c52=new Date(_0x6b4aca)['toLocaleTimeString']([],{'hour':'2-digit','minute':_0x23f687(0x1c2)}),_0x2b9aee=sanitizeUsername(_0x38d1b9),_0x2adb4f=roomUsers[_0x2b9aee]||{},_0x311dbf=_0x2adb4f[_0x23f687(0x188)]?_0x23f687(0x190)+_0x2adb4f['avatarBase64']+_0x23f687(0x17f):_0x23f687(0x1d0);let _0x4c4847=_0x28a1a8?.[_0x23f687(0x1dd)](new RegExp('@'+username+'\x5cb','gi'),_0x23f687(0x186)),_0x269229=_0x311dbf+'<span\x20class=\x22sender-name\x22>'+_0x38d1b9+_0x23f687(0x1b4);_0x5a620f?_0x269229+=_0x23f687(0x1fc)+_0x426c52+'\x20¬∑\x20‚úì‚úì</small>':_0x269229+='<small>'+_0x426c52+_0x23f687(0x17d);if(_0x2d2fe1)_0x269229+=_0x23f687(0x1c4)+_0x2d2fe1+_0x23f687(0x187);else{if(_0x5cb17b){const _0x51547a=_0x23f687(0x171)+_0x5cb17b;_0x269229+='<audio\x20controls\x20src=\x22'+_0x51547a+_0x23f687(0x187);}else{if(_0x293fd1){const _0x35c677=_0x23f687(0x1a8)+_0x293fd1;_0x269229+=_0x23f687(0x1f8)+_0x35c677+_0x23f687(0x216);}else _0x269229+=_0x23f687(0x214)+_0x4c4847+_0x23f687(0x179);}}_0x4ca469[_0x23f687(0x1bc)]=_0x269229;if(_0x2adb4f[_0x23f687(0x1ba)]){const _0x55fe56=_0x4ca469['querySelector'](_0x23f687(0x17b));_0x55fe56&&(_0x55fe56['innerHTML']+='\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>');}const _0xb9bda2=document[_0x23f687(0x21b)]('messages');_0xb9bda2[_0x23f687(0x1a6)](_0x4ca469),_0xb9bda2[_0x23f687(0x1af)]=_0xb9bda2[_0x23f687(0x1c0)];}function cleanupOldRooms(){const _0x45dd7e=_0x474db9;db[_0x45dd7e(0x17c)](_0x45dd7e(0x1ff))['once'](_0x45dd7e(0x1b6))['then'](_0x3491d5=>{const _0x1de5be=_0x45dd7e,_0x3fd3d6=_0x3491d5[_0x1de5be(0x21a)]();if(!_0x3fd3d6)return;const _0x32bf60=Date[_0x1de5be(0x18f)]();for(const _0x27b334 in _0x3fd3d6){if(_0x27b334===STATIC_ROOM)continue;const _0x18c966=_0x3fd3d6[_0x27b334];_0x32bf60-(_0x18c966[_0x1de5be(0x1dc)]||0x0)>0x2*0x3c*0x3e8&&db[_0x1de5be(0x17c)]('rooms/'+_0x27b334)['remove']();}db[_0x1de5be(0x17c)](_0x1de5be(0x176))[_0x1de5be(0x1c6)]('value')['then'](_0x5c7f5a=>{const _0x2941c0=_0x1de5be,_0x3852b3=_0x5c7f5a[_0x2941c0(0x21a)]();if(!_0x3852b3)return;for(const _0x87741e in _0x3852b3){if(_0x87741e!==STATIC_ROOM)db[_0x2941c0(0x17c)](_0x2941c0(0x177)+_0x87741e)['remove']();}}),db[_0x1de5be(0x17c)](_0x1de5be(0x1b1))[_0x1de5be(0x1c6)](_0x1de5be(0x1b6))['then'](_0x5a6a0a=>{const _0xbd4bbf=_0x1de5be,_0x573b87=_0x5a6a0a[_0xbd4bbf(0x21a)]();if(!_0x573b87)return;for(const _0x3efd44 in _0x573b87){if(_0x3efd44!==STATIC_ROOM)db[_0xbd4bbf(0x17c)]('antispamBlocked/'+_0x3efd44)['remove']();}});});}document['addEventListener']('DOMContentLoaded',()=>{const _0x37b719=_0x474db9,_0x2251c8=document['getElementById']('msgInput');_0x2251c8&&_0x2251c8['addEventListener'](_0x37b719(0x1bd),function(_0x572a25){const _0x1e6c94=_0x37b719;_0x572a25['key']===_0x1e6c94(0x213)&&(_0x572a25['preventDefault'](),sendMessage());});});function showScreen(_0x1c3d60){const _0xd0e8d2=_0x474db9;[_0xd0e8d2(0x222),_0xd0e8d2(0x1fa),_0xd0e8d2(0x1f2),_0xd0e8d2(0x1e8),_0xd0e8d2(0x219),_0xd0e8d2(0x19c),_0xd0e8d2(0x1b7)][_0xd0e8d2(0x16d)](_0x168f6f=>{const _0x3c6608=_0xd0e8d2;document['getElementById'](_0x168f6f)[_0x3c6608(0x1a9)][_0x3c6608(0x1c5)]=_0x3c6608(0x1ee);}),document[_0xd0e8d2(0x21b)](_0x1c3d60)['style'][_0xd0e8d2(0x1c5)]='flex';}function genRoomCode(){const _0x37a69b=_0x474db9,_0x262298=_0x37a69b(0x210),_0x29c208=_0x37a69b(0x1f9),_0x23229c=(_0x2da549,_0x51a2c7)=>Array[_0x37a69b(0x18a)]({'length':_0x51a2c7},()=>_0x2da549[Math[_0x37a69b(0x208)](Math[_0x37a69b(0x1cb)]()*_0x2da549['length'])])[_0x37a69b(0x18e)]('');return _0x23229c(_0x29c208,0x3)+_0x23229c(_0x262298,0x3)+_0x23229c(_0x29c208,0x2)+_0x23229c(_0x262298,0x2);}function startInactivityTimer(){setInterval(()=>{const _0x428f10=_0x13bf;Date[_0x428f10(0x18f)]()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db[_0x428f10(0x17c)](_0x428f10(0x174)+roomCode)[_0x428f10(0x1e9)]({'active':![]}),alert(_0x428f10(0x18d)),location[_0x428f10(0x193)]());},0x7530);}function setupSidebarBackHandler(){const _0x3f6d95=_0x474db9;window[_0x3f6d95(0x189)](_0x3f6d95(0x1c9),()=>{const _0x578fd6=_0x3f6d95,_0x3e9aca=document[_0x578fd6(0x21b)](_0x578fd6(0x20d));_0x3e9aca?.[_0x578fd6(0x167)][_0x578fd6(0x1e0)]('show')&&_0x3e9aca[_0x578fd6(0x167)][_0x578fd6(0x1bb)]('show');});}function toggleSidebar(){const _0x43c84c=_0x474db9,_0x2eab3=document[_0x43c84c(0x21b)]('userSidebar');if(!_0x2eab3[_0x43c84c(0x167)][_0x43c84c(0x1e0)](_0x43c84c(0x209)))_0x2eab3['classList'][_0x43c84c(0x1f7)](_0x43c84c(0x209)),history[_0x43c84c(0x1eb)]({'sidebarOpen':!![]},'');else{_0x2eab3[_0x43c84c(0x167)][_0x43c84c(0x1bb)](_0x43c84c(0x209));if(history['state']?.['sidebarOpen'])history[_0x43c84c(0x1de)]();}}function setupVisibilityAttention(){const _0x4d1d06=_0x474db9;let _0xdee0b3=0x0,_0x378767=document[_0x4d1d06(0x1d7)];document[_0x4d1d06(0x189)]('visibilitychange',()=>{const _0x27f831=_0x4d1d06;!document['hidden']&&(document[_0x27f831(0x1d7)]=_0x378767,_0xdee0b3=0x0);}),window['flagPageAttention']=function(){const _0x2d5d24=_0x4d1d06;document['hidden']&&(_0xdee0b3++,document[_0x2d5d24(0x1d7)]='('+_0xdee0b3+_0x2d5d24(0x1fd)+_0x378767);};}function tryEditProfile(){const _0x11ae72=_0x474db9,_0x2f7305=sanitizeUsername(username);db[_0x11ae72(0x17c)](_0x11ae72(0x1fe)+_0x2f7305)[_0x11ae72(0x175)]()['then'](_0x2621c8=>{const _0x202550=_0x11ae72,_0xc1f7e1=_0x2621c8[_0x202550(0x21a)]();if(!_0xc1f7e1)return alert(_0x202550(0x181));const _0x3e65ba=_0xc1f7e1[_0x202550(0x17e)]||0x0,_0x4fc3c7=Date[_0x202550(0x18f)](),_0x54c881=0x18*0x3c*0x3c*0x3e8;if(_0x4fc3c7-_0x3e65ba<_0x54c881){const _0x25154e=Math['ceil']((_0x54c881-(_0x4fc3c7-_0x3e65ba))/(0x3c*0x3e8));alert(_0x202550(0x1e1)+_0x25154e+_0x202550(0x1d8));}else showScreen(_0x202550(0x19c)),document[_0x202550(0x21b)](_0x202550(0x191))[_0x202550(0x1b6)]=username,document[_0x202550(0x21b)](_0x202550(0x1c7))[_0x202550(0x1b6)]=_0xc1f7e1['description']||'';});}function listenForUserList(){const _0x3baafd=_0x474db9;db[_0x3baafd(0x17c)](_0x3baafd(0x221)+roomCode)['on'](_0x3baafd(0x1b6),_0x2f8e49=>{const _0x1c025d=_0x3baafd,_0x2493b2=_0x2f8e49[_0x1c025d(0x21a)]()||{},_0x34c32f=Date[_0x1c025d(0x18f)]();roomUsers={},Object['entries'](_0x2493b2)['forEach'](([_0x1139c1,_0x1bb6f4])=>{const _0x55c5c3=_0x1c025d;roomUsers[sanitizeUsername(_0x1bb6f4[_0x55c5c3(0x215)])]=_0x1bb6f4;}),userListReady=!![],pendingMessages[_0x1c025d(0x16d)](({data:_0xea1bfe,sent:_0x5771c2,key:_0x391ea3})=>{addMessage(_0xea1bfe,_0x5771c2,_0x391ea3);}),pendingMessages=[];const _0x22bd88=Object[_0x1c025d(0x178)](_0x2493b2)[_0x1c025d(0x1f4)](_0x1133c8=>{const _0x4f060b=_0x1c025d,_0x1759cc=_0x1133c8[_0x4f060b(0x1a4)],_0x4001f6=_0x34c32f-_0x1133c8['lastOnline']<=0x1e*0x3c*0x3e8;if(!_0x1759cc&&!_0x4001f6)return'';const _0x10513b=_0x1759cc?_0x4f060b(0x21d):_0x4f060b(0x1e7),_0x5e7575=_0x1759cc?'üü¢':'üïí',_0x5b6290=_0x1133c8[_0x4f060b(0x188)]?'<img\x20src=\x22data:image/png;base64,'+_0x1133c8['avatarBase64']+_0x4f060b(0x16c):_0x4f060b(0x172),_0x407ecd=_0x1133c8[_0x4f060b(0x1ba)]?'\x20<span\x20style=\x22color:red;\x22>Admin</span>':'';return _0x4f060b(0x1ae)+_0x10513b+_0x4f060b(0x198)+sanitizeUsername(_0x1133c8['username'])+_0x4f060b(0x21f)+_0x5b6290+_0x5e7575+'\x20'+_0x1133c8[_0x4f060b(0x215)]+_0x407ecd+_0x4f060b(0x1f3);})[_0x1c025d(0x18e)]('');document[_0x1c025d(0x21b)](_0x1c025d(0x168))['innerHTML']=_0x22bd88;});}function sendTyping(_0x5256ce=![]){const _0x251a18=_0x474db9;if(isBlocked)return;const _0x219134=_0x251a18(0x174)+roomCode+_0x251a18(0x1c8)+clientId;_0x5256ce?db['ref'](_0x219134)['remove']():(db[_0x251a18(0x17c)](_0x219134)[_0x251a18(0x1ea)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x235b0c=_0x251a18;db['ref'](_0x219134)[_0x235b0c(0x1bb)]();},0xbb8));}function listenForTyping(){const _0x40b84b=_0x474db9,_0x9d024e=document[_0x40b84b(0x21b)](_0x40b84b(0x1f5));db[_0x40b84b(0x17c)](_0x40b84b(0x174)+roomCode+_0x40b84b(0x1db))['on'](_0x40b84b(0x1b6),_0x50c330=>{const _0x42eac9=_0x40b84b,_0x28863f=_0x50c330[_0x42eac9(0x21a)]();if(!_0x28863f)return _0x9d024e[_0x42eac9(0x1c3)]='';const _0x5d9031=Object[_0x42eac9(0x178)](_0x28863f)[_0x42eac9(0x173)](_0x297b5d=>_0x297b5d!==username);_0x9d024e['innerText']=_0x5d9031[_0x42eac9(0x203)]?_0x5d9031[_0x42eac9(0x18e)](',\x20')+'\x20typing...':'';});}function trackPresence(){const _0x2cc347=_0x474db9;if(!username||!roomCode)return;const _0x533faf=sanitizeUsername(username),_0xcf4fe2=db[_0x2cc347(0x17c)]('users/'+roomCode+'/'+_0x533faf),_0x36650c=localStorage[_0x2cc347(0x16a)](_0x2cc347(0x1ef))||'',_0x4c1ce6={'username':username,'lastOnline':firebase[_0x2cc347(0x1da)][_0x2cc347(0x217)][_0x2cc347(0x1cc)],'online':!![],'avatarBase64':_0x36650c};db[_0x2cc347(0x17c)](_0x2cc347(0x1c1)+roomCode+'/'+_0x533faf)[_0x2cc347(0x1c6)]('value')[_0x2cc347(0x170)](_0x22f387=>{const _0x4f1180=_0x2cc347;if(_0x22f387[_0x4f1180(0x20e)]())_0x4c1ce6[_0x4f1180(0x1ba)]=!![];_0xcf4fe2[_0x4f1180(0x1ea)](_0x4c1ce6),_0xcf4fe2[_0x4f1180(0x1ce)]()['update']({'online':![],'lastOnline':Date['now']()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0x353ff5){const _0x25e9e6=_0x474db9;if(!_0x353ff5['files'][_0x25e9e6(0x203)])return;const _0x3291e2=new FileReader();_0x3291e2[_0x25e9e6(0x229)]=()=>{const _0x47be09=_0x25e9e6,_0xd4cbda=_0x3291e2['result'][_0x47be09(0x20a)](',')[0x1];localStorage[_0x47be09(0x1aa)](_0x47be09(0x1ef),_0xd4cbda);const _0x8ca39=document[_0x47be09(0x21b)]('sidebarAvatarPreview');_0x8ca39[_0x47be09(0x200)]='data:image/png;base64,'+_0xd4cbda,_0x8ca39[_0x47be09(0x1a9)][_0x47be09(0x1c5)]=_0x47be09(0x1d2),trackPresence();},_0x3291e2['readAsDataURL'](_0x353ff5[_0x25e9e6(0x1f1)][0x0]);}function muteUser(_0x182dee,_0x162877){const _0x34531c=_0x474db9;if(!isRoomAdmin)return alert(_0x34531c(0x1a5));const _0x1373d1=Date[_0x34531c(0x18f)]()+_0x162877*0x3c*0x3e8;db[_0x34531c(0x17c)]('muted/'+roomCode+'/'+sanitizeUsername(_0x182dee))[_0x34531c(0x1ea)](_0x1373d1);}function unmuteUser(_0xb21e47){const _0xa1810=_0x474db9;if(!isRoomAdmin)return alert(_0xa1810(0x1a5));db[_0xa1810(0x17c)](_0xa1810(0x1ca)+roomCode+'/'+sanitizeUsername(_0xb21e47))[_0xa1810(0x1bb)]();}function updateOnlineIndicator(){const _0xadff1=_0x474db9,_0x499b25=document[_0xadff1(0x21b)]('onlineStatus');_0x499b25[_0xadff1(0x1c3)]='‚óè\x20Online',_0x499b25[_0xadff1(0x1a9)][_0xadff1(0x194)]=_0xadff1(0x21d);}setInterval(updateOnlineIndicator,0xbb8);function viewProfile(_0x45083d){const _0x52425f=_0x474db9;db[_0x52425f(0x17c)]('profiles/'+_0x45083d)['get']()[_0x52425f(0x170)](_0x45f7bf=>{const _0x25004c=_0x52425f;if(!_0x45f7bf[_0x25004c(0x20e)]())return;const _0x1cfff8=_0x45f7bf['val'](),_0x2ec366=('\x0aName:\x20'+_0x1cfff8[_0x25004c(0x215)]+_0x25004c(0x19e)+(_0x1cfff8[_0x25004c(0x1d6)]||_0x25004c(0x16b))+'\x0aHistory:\x0a'+(_0x1cfff8[_0x25004c(0x19d)]||[])[_0x25004c(0x18e)]('\x0a')+_0x25004c(0x1ec)+new Date(_0x1cfff8[_0x25004c(0x17e)])[_0x25004c(0x220)]()+'\x0a\x20\x20\x20\x20')['trim']();document['getElementById'](_0x25004c(0x180))[_0x25004c(0x1c3)]=_0x2ec366,document[_0x25004c(0x21b)](_0x25004c(0x1b7))[_0x25004c(0x1a9)][_0x25004c(0x1c5)]='block';});}function initUsernameFlow(){const _0x4d7bf3=_0x474db9,_0x214757=localStorage[_0x4d7bf3(0x16a)]('chat_username');!_0x214757?showScreen(_0x4d7bf3(0x19c)):(username=_0x214757,document['getElementById'](_0x4d7bf3(0x1df))[_0x4d7bf3(0x1c3)]=username,showScreen(_0x4d7bf3(0x1fa)));}function closeProfile(){const _0x51b3fc=_0x474db9;document[_0x51b3fc(0x21b)](_0x51b3fc(0x1b7))[_0x51b3fc(0x1a9)][_0x51b3fc(0x1c5)]=_0x51b3fc(0x1ee);}