const _0x272768=_0x2a55;(function(_0x25920a,_0x2a79c7){const _0x3db565=_0x2a55,_0x49ce93=_0x25920a();while(!![]){try{const _0x319254=-parseInt(_0x3db565(0x1f8))/0x1+-parseInt(_0x3db565(0x287))/0x2+parseInt(_0x3db565(0x1f1))/0x3+parseInt(_0x3db565(0x228))/0x4+parseInt(_0x3db565(0x2a6))/0x5+-parseInt(_0x3db565(0x293))/0x6+parseInt(_0x3db565(0x251))/0x7*(parseInt(_0x3db565(0x253))/0x8);if(_0x319254===_0x2a79c7)break;else _0x49ce93['push'](_0x49ce93['shift']());}catch(_0x3d1879){_0x49ce93['push'](_0x49ce93['shift']());}}}(_0xd4e8,0xda1aa));const firebaseConfig={'apiKey':_0x272768(0x298),'authDomain':'easy-chatroom.firebaseapp.com','databaseURL':'https://easy-chatroom-default-rtdb.firebaseio.com','projectId':_0x272768(0x254),'storageBucket':_0x272768(0x214),'messagingSenderId':_0x272768(0x22d),'appId':_0x272768(0x281),'measurementId':'G-QDESJ2WR42'};firebase['initializeApp'](firebaseConfig);function _0xd4e8(){const _0x17c273=['●\x20Online','Admins\x20only.','color','entries','scrollTop','⚠️\x20Could\x20not\x20check\x20username.\x20Try\x20again.','preventDefault','error','none','lastOnline','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','received','data:image/png;base64,','userSidebar','exists','⛔\x20You\x27re\x20blocked\x20for\x20spamming\x20(30s)','<small>','div','floor','remove','setItem','🎙️','once','database','⚠️\x20Failed\x20to\x20save\x20profile.\x20Try\x20again.','val','profileViewer','<span\x20style=\x22margin-right:5px;\x22>👤</span>','getUserMedia','\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>','codeEntryScreen','result','0123456789','\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>','description','audioBase64','Failed\x20to\x20save\x20profile:','\x0aDescription:\x20','1:985049198428:web:d0eb7e2de39887710c9b99','random','contains','map','toLocaleTimeString','#888','3046888CDpJQB','onloadend','/typing/','\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>','addEventListener','update','onload','<audio\x20controls\x20src=\x22','</div>','flagPageAttention','onlineStatus','replace','2049504QVTQRR','join','muted/','\x0aName:\x20','<span\x20style=\x22margin-right:8px;\x22>👤</span>','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','profileUsernameInput','then','Missing\x20room\x20or\x20user\x20information.','Enter\x20a\x20valid\x20room\x20code','ondataavailable',')\x20New\x20message\x20•\x20','msgInput','start','active','staticPasswordInput','profiles/','Type\x20a\x20message...','audioUrl','22485uYvGDK','block','msg','<li\x20style=\x22color:','admin','onDisconnect','ref','filter','\x0aLast\x20Changed:\x20','Error\x20checking\x20username:','antispam','placeholder','forEach','DOMContentLoaded','title','lastChanged','\x0a\x20\x20\x20\x20','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','popstate','messages','username','<img\x20src=\x22','data','rooms','flex','902442iQTwex','show','2-digit','state','No\x20room\x20code\x20available\x20for\x20private\x20rooms','display','reload','1210475mZDIBr','<img\x20src=\x22data:image/png;base64,','profileScreen','/messages/','keypress','child_added','src','limitToLast','rooms/','catch','chatScreen','trim','antispamBlocked','ceil','substr','/messages','passwordScreen','\x0aHistory:\x0a','stop','profileDescriptionInput','#00ff88','hidden','userList','set','Profile\x20not\x20found.',';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27','⛔\x20You’ve\x20been\x20muted\x20for\x20spamming.\x20Please\x20wait\x2030\x20seconds.','sidebarOpen','easy-chatroom.firebasestorage.app','pushState','mediaDevices','users/','sounds/beep.mp3','</span>','You\x20can\x20change\x20your\x20profile\x20again\x20in\x20','profileError','toString','\x20·\x20✓✓</small>','profileContent','gr8stg','Failed\x20to\x20register\x20user\x20in\x20room.','values','now','createElement','profile_description','getElementById','avatar_base64','[Voice\x20message]','2152076tfVUrl','050BBB66HH','innerHTML','classList','recordBtn','985049198428','visibilitychange','data:audio/webm;base64,','volume','admins/','back','online','getItem','length','roomDisplay','avatarBase64','get','files','/typing','ServerValue','typing','antispam/','passwordError','readAsDataURL','innerText','usernameScreen','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','❌\x20Username\x20already\x20taken.','toUpperCase','\x0a\x20\x20\x20\x20\x20\x20</li>','TIMESTAMP','key','\x20minutes.','Enter','push','<div>','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ABCDEFGHIJKLMNOPQRSTUVWXYZ','antispamBlocked/','usernameHistory','disabled','21878689pYuKyo','play','8WIKBZT','easy-chatroom','roomChoiceScreen','Session\x20expired.','add','value','namePreview','style'];_0xd4e8=function(){return _0x17c273;};return _0xd4e8();}const db=firebase['database'](),roomUsers={};let messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math[_0x272768(0x282)]()[_0x272768(0x21c)](0x24)[_0x272768(0x206)](0x2,0x9),lastActivity=Date['now'](),typingTimeout,gr8stg='';const STATIC_ROOM=_0x272768(0x229),MAX_MESSAGES=0xfa,sound=new Audio(_0x272768(0x218));sound[_0x272768(0x230)]=0.3;let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x4bb574=_0x272768,_0x1ea3ab=db[_0x4bb574(0x2ac)]('admins/'+roomCode+'/'+sanitizeUsername(username));return _0x1ea3ab['once'](_0x4bb574(0x258))[_0x4bb574(0x29a)](_0x48ccf8=>{isRoomAdmin=_0x48ccf8['exists']();});}function toggleRecording(){const _0x330135=_0x272768;isRecording?stopRecording():navigator[_0x330135(0x216)][_0x330135(0x277)]({'audio':!![]})[_0x330135(0x29a)](_0x360a93=>{const _0x5e5153=_0x330135;mediaRecorder=new MediaRecorder(_0x360a93),mediaRecorder[_0x5e5153(0x2a0)](),isRecording=!![],document[_0x5e5153(0x225)](_0x5e5153(0x22c))[_0x5e5153(0x240)]='⏹️',audioChunks=[],mediaRecorder[_0x5e5153(0x29d)]=_0x3e5db5=>audioChunks['push'](_0x3e5db5[_0x5e5153(0x1ee)]),mediaRecorder['onstop']=()=>{const _0x232ce3=_0x5e5153;clearTimeout(recordingTimer);const _0x2676d8=new Blob(audioChunks,{'type':'audio/webm'}),_0x2f6301=new FileReader();_0x2f6301[_0x232ce3(0x288)]=()=>{const _0x4992bc=_0x232ce3,_0x1376d3=_0x2f6301[_0x4992bc(0x27a)]['split'](',')[0x1],_0x160797=db['ref']()[_0x4992bc(0x24a)]()[_0x4992bc(0x247)];db[_0x4992bc(0x2ac)]('rooms/'+roomCode+_0x4992bc(0x1fb)+_0x160797)['set']({'msg':_0x4992bc(0x227),'audioBase64':_0x1376d3,'sender':username,'senderId':clientId,'timestamp':Date[_0x4992bc(0x222)]()});},_0x2f6301[_0x232ce3(0x23f)](_0x2676d8);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0x330135(0x201)](_0x11e9cd=>{alert('Microphone\x20permission\x20denied.');});}function stopRecording(){const _0x4bfbca=_0x272768;mediaRecorder&&isRecording&&(mediaRecorder[_0x4bfbca(0x20a)](),isRecording=![],document[_0x4bfbca(0x225)](_0x4bfbca(0x22c))['innerText']=_0x4bfbca(0x270));}window[_0x272768(0x28d)]=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x2202ed){const _0x150d7c=_0x272768;return _0x2202ed[_0x150d7c(0x292)](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x2c0029=_0x272768,_0x509fac=document[_0x2c0029(0x225)](_0x2c0029(0x299))['value'][_0x2c0029(0x203)](),_0x87d30=document[_0x2c0029(0x225)](_0x2c0029(0x20b))[_0x2c0029(0x258)]['trim'](),_0x3cfba5=document['getElementById'](_0x2c0029(0x21b));if(!_0x509fac||!_0x87d30){_0x3cfba5[_0x2c0029(0x240)]='Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.',_0x3cfba5[_0x2c0029(0x25a)][_0x2c0029(0x1f6)]=_0x2c0029(0x2a7);return;}const _0x5055a0=sanitizeUsername(_0x509fac),_0x4043c4=db[_0x2c0029(0x2ac)](_0x2c0029(0x2a3)+_0x5055a0);_0x4043c4[_0x2c0029(0x271)](_0x2c0029(0x258))[_0x2c0029(0x29a)](_0x2f383b=>{const _0x322b44=_0x2c0029;if(_0x2f383b[_0x322b44(0x269)]())_0x3cfba5['innerText']=_0x322b44(0x243),_0x3cfba5['style'][_0x322b44(0x1f6)]=_0x322b44(0x2a7);else{const _0x5445a1={'username':_0x509fac,'description':_0x87d30,'lastChanged':Date[_0x322b44(0x222)](),'usernameHistory':[_0x509fac]};_0x4043c4[_0x322b44(0x20f)](_0x5445a1,_0x5bf0d9=>{const _0x4d99f1=_0x322b44;_0x5bf0d9?(console[_0x4d99f1(0x262)](_0x4d99f1(0x27f),_0x5bf0d9),_0x3cfba5['innerText']=_0x4d99f1(0x273),_0x3cfba5[_0x4d99f1(0x25a)][_0x4d99f1(0x1f6)]=_0x4d99f1(0x2a7)):(localStorage[_0x4d99f1(0x26f)]('chat_username',_0x509fac),localStorage[_0x4d99f1(0x26f)](_0x4d99f1(0x224),_0x87d30),username=_0x509fac,document[_0x4d99f1(0x225)]('namePreview')[_0x4d99f1(0x240)]=_0x509fac,showScreen(_0x4d99f1(0x255)));});}})[_0x2c0029(0x201)](_0xf6f8c7=>{const _0x13dbb2=_0x2c0029;console['error'](_0x13dbb2(0x2af),_0xf6f8c7),_0x3cfba5[_0x13dbb2(0x240)]=_0x13dbb2(0x260),_0x3cfba5[_0x13dbb2(0x25a)][_0x13dbb2(0x1f6)]='block';});}function saveProfile(_0x4e830b,_0x368ef1,_0x55c697){const _0x5986c6=_0x272768,_0x9f9f98=Date[_0x5986c6(0x222)](),_0x33b36f=[_0x4e830b];db[_0x5986c6(0x2ac)](_0x5986c6(0x2a3)+_0x55c697)[_0x5986c6(0x20f)]({'username':_0x4e830b,'description':_0x368ef1,'lastChanged':_0x9f9f98,'usernameHistory':_0x33b36f}),localStorage[_0x5986c6(0x26f)]('chat_username',_0x4e830b),localStorage['setItem'](_0x5986c6(0x224),_0x368ef1),document[_0x5986c6(0x225)](_0x5986c6(0x259))['innerText']=_0x4e830b,showScreen(_0x5986c6(0x255));}function generateRoom(){const _0x2cbd6c=_0x272768;roomCode=genRoomCode(),db['ref'](_0x2cbd6c(0x200)+roomCode)[_0x2cbd6c(0x20f)]({'active':!![],'created':Date['now']()}),startChat();}function joinRoom(){const _0x1528cb=_0x272768,_0x583ab0=roomCode||document['getElementById']('roomCodeInput')[_0x1528cb(0x258)]['trim']()[_0x1528cb(0x244)]();if(!_0x583ab0)return alert(_0x1528cb(0x29c));roomCode=_0x583ab0;if(roomCode===STATIC_ROOM){showScreen(_0x1528cb(0x208));return;}db[_0x1528cb(0x2ac)](_0x1528cb(0x200)+roomCode)[_0x1528cb(0x238)]()[_0x1528cb(0x29a)](_0x4b8381=>{const _0x535e41=_0x1528cb;_0x4b8381[_0x535e41(0x269)]()&&_0x4b8381['val']()[_0x535e41(0x2a1)]!==![]?startChat():alert(_0x535e41(0x242));});}function startChat(){const _0x1fee54=_0x272768;if(!roomCode||!username)return alert(_0x1fee54(0x29b)),showScreen('roomChoiceScreen');checkIfAdmin()[_0x1fee54(0x29a)](()=>{const _0x12dfc2=_0x1fee54,_0x511e67=sanitizeUsername(username),_0x5a1a1a=db[_0x12dfc2(0x2ac)]('users/'+roomCode+'/'+_0x511e67),_0x4f5cdd={'username':username,'lastOnline':firebase[_0x12dfc2(0x272)][_0x12dfc2(0x23b)][_0x12dfc2(0x246)],'online':!![]};db['ref'](_0x12dfc2(0x231)+roomCode+'/'+_0x511e67)[_0x12dfc2(0x271)]('value')[_0x12dfc2(0x29a)](_0xcb798d=>{const _0x5dc493=_0x12dfc2;_0xcb798d['exists']()&&(_0x4f5cdd[_0x5dc493(0x2aa)]=!![]),_0x5a1a1a[_0x5dc493(0x20f)](_0x4f5cdd,_0x56fde1=>{const _0x588e28=_0x5dc493;if(_0x56fde1)return alert(_0x588e28(0x220)),showScreen('roomChoiceScreen');_0x5a1a1a['onDisconnect']()['update']({'online':![],'lastOnline':Date[_0x588e28(0x222)]()}),document[_0x588e28(0x225)]('userDisplay')['innerText']=username,roomCode===STATIC_ROOM?document['getElementById'](_0x588e28(0x236))['innerText']=_0x588e28(0x1f5):document['getElementById'](_0x588e28(0x236))['innerText']=roomCode,showScreen(_0x588e28(0x202)),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x23f900=_0x272768,_0x9790c9=document[_0x23f900(0x225)](_0x23f900(0x2a2))[_0x23f900(0x258)],_0x4ce467=document[_0x23f900(0x225)](_0x23f900(0x23e));db['ref'](_0x23f900(0x21f))[_0x23f900(0x238)]()[_0x23f900(0x29a)](_0xde4ccc=>{const _0x4789f2=_0x23f900,_0x37d12e=_0xde4ccc[_0x4789f2(0x274)]();_0x9790c9===_0x37d12e?(_0x4ce467[_0x4789f2(0x25a)][_0x4789f2(0x1f6)]=_0x4789f2(0x263),startChat()):_0x4ce467[_0x4789f2(0x25a)]['display']='block';});}function _0x2a55(_0x5e461b,_0x524252){const _0xd4e85b=_0xd4e8();return _0x2a55=function(_0x2a5589,_0xf0edb6){_0x2a5589=_0x2a5589-0x1ea;let _0x981070=_0xd4e85b[_0x2a5589];return _0x981070;},_0x2a55(_0x5e461b,_0x524252);}const spamTimestamps=[];function sendMessage(){const _0x1a04a4=_0x272768,_0x144d1c=document['getElementById'](_0x1a04a4(0x29f)),_0x46c11f=_0x144d1c[_0x1a04a4(0x258)][_0x1a04a4(0x203)]();if(!_0x46c11f||isBlocked)return;const _0x4ae3f4=Date[_0x1a04a4(0x222)]();spamTimestamps[_0x1a04a4(0x24a)](_0x4ae3f4);const _0x40a19d=spamTimestamps[_0x1a04a4(0x2ad)](_0x42f86c=>_0x4ae3f4-_0x42f86c<0x1b58);if(_0x40a19d[_0x1a04a4(0x235)]>0x5){isBlocked=!![],_0x144d1c[_0x1a04a4(0x250)]=!![],_0x144d1c[_0x1a04a4(0x2b1)]=_0x1a04a4(0x26a),alert(_0x1a04a4(0x212)),setTimeout(()=>{const _0x1a959e=_0x1a04a4;isBlocked=![],_0x144d1c[_0x1a959e(0x250)]=![],_0x144d1c[_0x1a959e(0x2b1)]=_0x1a959e(0x2a4),spamTimestamps[_0x1a959e(0x235)]=0x0;},0x7530);return;}const _0x574289=localStorage['getItem'](_0x1a04a4(0x226))||'',_0x4a15d7=db[_0x1a04a4(0x2ac)]()[_0x1a04a4(0x24a)]()[_0x1a04a4(0x247)];db[_0x1a04a4(0x2ac)](_0x1a04a4(0x200)+roomCode+_0x1a04a4(0x1fb)+_0x4a15d7)[_0x1a04a4(0x20f)]({'msg':_0x46c11f,'sender':username,'senderId':clientId,'avatarBase64':_0x574289,'timestamp':_0x4ae3f4}),_0x144d1c[_0x1a04a4(0x258)]='',sendTyping(!![]),lastActivity=_0x4ae3f4;}function listenForMessages(){const _0x379a64=_0x272768,_0x5a34e3=db[_0x379a64(0x2ac)](_0x379a64(0x200)+roomCode+_0x379a64(0x207)),_0x3a03ba=_0x5a34e3[_0x379a64(0x1ff)](MAX_MESSAGES);_0x3a03ba['on'](_0x379a64(0x1fd),_0x4e7bf8=>{const _0x47e504=_0x379a64,_0x4f24c0=_0x4e7bf8[_0x47e504(0x274)](),{msg:_0xe4e405,sender:_0x52a3af,senderId:_0x5d72f0,timestamp:_0x2cd8ef}=_0x4f24c0,_0x30fd49=_0x5d72f0===clientId,_0x20be69=_0x4f24c0[_0x47e504(0x2a5)]||null,_0x2c744c=_0x4f24c0[_0x47e504(0x27e)]||null;addMessage(_0x4f24c0,_0x30fd49,_0x4e7bf8[_0x47e504(0x247)]),roomCode!==STATIC_ROOM&&db['ref'](_0x47e504(0x200)+roomCode+_0x47e504(0x1fb)+_0x4e7bf8[_0x47e504(0x247)])[_0x47e504(0x26e)](),!_0x30fd49&&(sound[_0x47e504(0x252)](),flagPageAttention());});}function addMessage(_0x2671d7,_0x275b25,_0x3c689a=null){const _0x4ad181=_0x272768,{msg:_0x7043eb,sender:_0x25bff9,senderId:_0x3553a8,timestamp:_0x3615b6,audioUrl:_0x3fe0b8,audioBase64:_0x56b51e,imageBase64:_0x12d137,avatarBase64:_0x394144}=_0x2671d7,_0x53332e=document[_0x4ad181(0x223)](_0x4ad181(0x26c));_0x53332e['classList'][_0x4ad181(0x257)](_0x4ad181(0x2a8),_0x275b25?'sent':_0x4ad181(0x266));const _0x52a973=new Date(_0x3615b6)[_0x4ad181(0x285)]([],{'hour':_0x4ad181(0x1f3),'minute':'2-digit'}),_0x5ab8ae=sanitizeUsername(_0x25bff9),_0x41791d=roomUsers[_0x5ab8ae]||{},_0x54db5e=_0x41791d[_0x4ad181(0x237)]?_0x4ad181(0x1f9)+_0x41791d['avatarBase64']+_0x4ad181(0x265):_0x4ad181(0x297);let _0x9b7fef=_0x7043eb?.[_0x4ad181(0x292)](new RegExp('@'+username+'\x5cb','gi'),'<span\x20style=\x22color:#ff4081;\x22>@$&</span>'),_0x190278=_0x54db5e+'<span\x20class=\x22sender-name\x22>'+_0x25bff9+_0x4ad181(0x219);_0x275b25?_0x190278+='<small>'+_0x52a973+_0x4ad181(0x21d):_0x190278+=_0x4ad181(0x26b)+_0x52a973+'</small>';if(_0x3fe0b8)_0x190278+='<audio\x20controls\x20src=\x22'+_0x3fe0b8+_0x4ad181(0x2b7);else{if(_0x56b51e){const _0x16f210=_0x4ad181(0x22f)+_0x56b51e;_0x190278+=_0x4ad181(0x28e)+_0x16f210+_0x4ad181(0x2b7);}else{if(_0x12d137){const _0x577e27=_0x4ad181(0x267)+_0x12d137;_0x190278+=_0x4ad181(0x1ed)+_0x577e27+_0x4ad181(0x278);}else _0x190278+=_0x4ad181(0x24b)+_0x9b7fef+_0x4ad181(0x28f);}}_0x53332e[_0x4ad181(0x22a)]=_0x190278;if(_0x41791d[_0x4ad181(0x2aa)]){const _0x16525e=_0x53332e['querySelector']('.sender-name');_0x16525e&&(_0x16525e['innerHTML']+=_0x4ad181(0x27c));}const _0x590363=document[_0x4ad181(0x225)](_0x4ad181(0x1eb));_0x590363['appendChild'](_0x53332e),_0x590363[_0x4ad181(0x25f)]=_0x590363['scrollHeight'];}function cleanupOldRooms(){const _0x4edbd1=_0x272768;db[_0x4edbd1(0x2ac)](_0x4edbd1(0x1ef))[_0x4edbd1(0x271)](_0x4edbd1(0x258))[_0x4edbd1(0x29a)](_0x150ef4=>{const _0x5fb75f=_0x4edbd1,_0x505a65=_0x150ef4[_0x5fb75f(0x274)]();if(!_0x505a65)return;const _0x5dbf19=Date[_0x5fb75f(0x222)]();for(const _0x27ebbe in _0x505a65){if(_0x27ebbe===STATIC_ROOM)continue;const _0x2b4815=_0x505a65[_0x27ebbe];_0x5dbf19-(_0x2b4815['created']||0x0)>0x2*0x3c*0x3e8&&db[_0x5fb75f(0x2ac)](_0x5fb75f(0x200)+_0x27ebbe)[_0x5fb75f(0x26e)]();}db[_0x5fb75f(0x2ac)](_0x5fb75f(0x2b0))['once']('value')[_0x5fb75f(0x29a)](_0x11dc35=>{const _0x4d6164=_0x5fb75f,_0x39074d=_0x11dc35[_0x4d6164(0x274)]();if(!_0x39074d)return;for(const _0x1f5d5c in _0x39074d){if(_0x1f5d5c!==STATIC_ROOM)db[_0x4d6164(0x2ac)](_0x4d6164(0x23d)+_0x1f5d5c)[_0x4d6164(0x26e)]();}}),db[_0x5fb75f(0x2ac)](_0x5fb75f(0x204))['once'](_0x5fb75f(0x258))[_0x5fb75f(0x29a)](_0x5286df=>{const _0x24b66a=_0x5fb75f,_0x359dc0=_0x5286df['val']();if(!_0x359dc0)return;for(const _0x1b761b in _0x359dc0){if(_0x1b761b!==STATIC_ROOM)db[_0x24b66a(0x2ac)](_0x24b66a(0x24e)+_0x1b761b)[_0x24b66a(0x26e)]();}});});}document[_0x272768(0x28b)](_0x272768(0x2b3),()=>{const _0x28d2bf=_0x272768,_0x4b0383=document[_0x28d2bf(0x225)](_0x28d2bf(0x29f));_0x4b0383&&_0x4b0383[_0x28d2bf(0x28b)](_0x28d2bf(0x1fc),function(_0x2e1782){const _0x5bf049=_0x28d2bf;_0x2e1782[_0x5bf049(0x247)]===_0x5bf049(0x249)&&(_0x2e1782[_0x5bf049(0x261)](),sendMessage());});});function showScreen(_0x14e1c9){const _0x37a648=_0x272768;[_0x37a648(0x241),_0x37a648(0x255),_0x37a648(0x279),_0x37a648(0x202),_0x37a648(0x208),'profileScreen',_0x37a648(0x275)][_0x37a648(0x2b2)](_0x3f7e30=>{const _0x58e9f1=_0x37a648;document['getElementById'](_0x3f7e30)[_0x58e9f1(0x25a)]['display']=_0x58e9f1(0x263);}),document['getElementById'](_0x14e1c9)[_0x37a648(0x25a)][_0x37a648(0x1f6)]=_0x37a648(0x1f0);}function genRoomCode(){const _0x2e611a=_0x272768,_0x4a4139=_0x2e611a(0x24d),_0x1c0e3a=_0x2e611a(0x27b),_0x125cdc=(_0x5bf3fd,_0xc7f80b)=>Array['from']({'length':_0xc7f80b},()=>_0x5bf3fd[Math[_0x2e611a(0x26d)](Math[_0x2e611a(0x282)]()*_0x5bf3fd[_0x2e611a(0x235)])])['join']('');return _0x125cdc(_0x1c0e3a,0x3)+_0x125cdc(_0x4a4139,0x3)+_0x125cdc(_0x1c0e3a,0x2)+_0x125cdc(_0x4a4139,0x2);}function startInactivityTimer(){setInterval(()=>{const _0x5ca760=_0x2a55;Date[_0x5ca760(0x222)]()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db[_0x5ca760(0x2ac)](_0x5ca760(0x200)+roomCode)[_0x5ca760(0x28c)]({'active':![]}),alert(_0x5ca760(0x256)),location[_0x5ca760(0x1f7)]());},0x7530);}function setupSidebarBackHandler(){const _0x2c3a7a=_0x272768;window[_0x2c3a7a(0x28b)](_0x2c3a7a(0x1ea),()=>{const _0x2d978f=_0x2c3a7a,_0x4ae7c5=document[_0x2d978f(0x225)]('userSidebar');_0x4ae7c5?.['classList']['contains']('show')&&_0x4ae7c5[_0x2d978f(0x22b)]['remove'](_0x2d978f(0x1f2));});}function toggleSidebar(){const _0x5de70b=_0x272768,_0x25b4ef=document[_0x5de70b(0x225)](_0x5de70b(0x268));if(!_0x25b4ef[_0x5de70b(0x22b)][_0x5de70b(0x283)](_0x5de70b(0x1f2)))_0x25b4ef[_0x5de70b(0x22b)][_0x5de70b(0x257)](_0x5de70b(0x1f2)),history[_0x5de70b(0x215)]({'sidebarOpen':!![]},'');else{_0x25b4ef['classList'][_0x5de70b(0x26e)](_0x5de70b(0x1f2));if(history[_0x5de70b(0x1f4)]?.[_0x5de70b(0x213)])history[_0x5de70b(0x232)]();}}function setupVisibilityAttention(){const _0x51e0cc=_0x272768;let _0x1d123b=0x0,_0x4668b8=document[_0x51e0cc(0x2b4)];document[_0x51e0cc(0x28b)](_0x51e0cc(0x22e),()=>{const _0xd3dc90=_0x51e0cc;!document[_0xd3dc90(0x20d)]&&(document['title']=_0x4668b8,_0x1d123b=0x0);}),window[_0x51e0cc(0x290)]=function(){const _0x1cc9d8=_0x51e0cc;document['hidden']&&(_0x1d123b++,document[_0x1cc9d8(0x2b4)]='('+_0x1d123b+_0x1cc9d8(0x29e)+_0x4668b8);};}function tryEditProfile(){const _0x3aa515=_0x272768,_0x5a4edc=sanitizeUsername(username);db[_0x3aa515(0x2ac)](_0x3aa515(0x2a3)+_0x5a4edc)[_0x3aa515(0x238)]()[_0x3aa515(0x29a)](_0x5c6405=>{const _0x3e0028=_0x3aa515,_0x5b2ebf=_0x5c6405[_0x3e0028(0x274)]();if(!_0x5b2ebf)return alert(_0x3e0028(0x210));const _0x476f61=_0x5b2ebf[_0x3e0028(0x2b5)]||0x0,_0x4b3ca5=Date[_0x3e0028(0x222)](),_0x34c88a=0x18*0x3c*0x3c*0x3e8;if(_0x4b3ca5-_0x476f61<_0x34c88a){const _0x1174b6=Math[_0x3e0028(0x205)]((_0x34c88a-(_0x4b3ca5-_0x476f61))/(0x3c*0x3e8));alert(_0x3e0028(0x21a)+_0x1174b6+_0x3e0028(0x248));}else showScreen(_0x3e0028(0x1fa)),document['getElementById']('profileUsernameInput')[_0x3e0028(0x258)]=username,document[_0x3e0028(0x225)](_0x3e0028(0x20b))[_0x3e0028(0x258)]=_0x5b2ebf[_0x3e0028(0x27d)]||'';});}function listenForUserList(){const _0xd6769f=_0x272768;db[_0xd6769f(0x2ac)]('users/'+roomCode)['on']('value',_0x5eea0e=>{const _0x5d084d=_0xd6769f,_0x42321a=_0x5eea0e[_0x5d084d(0x274)]()||{};Object[_0x5d084d(0x25e)](_0x42321a)[_0x5d084d(0x2b2)](([_0x11da8f,_0x3fa22d])=>{roomUsers[sanitizeUsername(_0x3fa22d['username'])]=_0x3fa22d;});const _0x4044fa=Date[_0x5d084d(0x222)](),_0x2a8d5d=Object[_0x5d084d(0x221)](_0x42321a)[_0x5d084d(0x284)](_0x220fa8=>{const _0x42a169=_0x5d084d,_0xccd700=_0x220fa8[_0x42a169(0x233)],_0x22bd12=_0x4044fa-_0x220fa8[_0x42a169(0x264)]<=0x1e*0x3c*0x3e8;if(!_0xccd700&&!_0x22bd12)return'';const _0x1c5687=_0xccd700?_0x42a169(0x20c):_0x42a169(0x286),_0x56ee85=_0xccd700?'🟢':'🕒',_0x2261bf=new Date(_0x220fa8[_0x42a169(0x264)])[_0x42a169(0x285)]([],{'hour':_0x42a169(0x1f3),'minute':_0x42a169(0x1f3)}),_0x2bdf82=_0x220fa8[_0x42a169(0x237)]?'<img\x20src=\x22data:image/png;base64,'+_0x220fa8[_0x42a169(0x237)]+_0x42a169(0x28a):_0x42a169(0x276),_0x13891d=_0x220fa8['admin']?'\x20<span\x20style=\x22color:red;\x22>Admin</span>':'';return _0x42a169(0x2a9)+_0x1c5687+_0x42a169(0x211)+sanitizeUsername(_0x220fa8[_0x42a169(0x1ec)])+_0x42a169(0x24c)+_0x2bdf82+_0x56ee85+'\x20'+_0x220fa8[_0x42a169(0x1ec)]+_0x13891d+_0x42a169(0x245);})['join']('');document[_0x5d084d(0x225)](_0x5d084d(0x20e))[_0x5d084d(0x22a)]=_0x2a8d5d;});}function sendTyping(_0x138752=![]){const _0x5b8481=_0x272768;if(isBlocked)return;const _0x11f3b7=_0x5b8481(0x200)+roomCode+_0x5b8481(0x289)+clientId;_0x138752?db['ref'](_0x11f3b7)[_0x5b8481(0x26e)]():(db['ref'](_0x11f3b7)[_0x5b8481(0x20f)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x4be0af=_0x5b8481;db['ref'](_0x11f3b7)[_0x4be0af(0x26e)]();},0xbb8));}function listenForTyping(){const _0xca7fb5=_0x272768,_0x5c05a3=document[_0xca7fb5(0x225)](_0xca7fb5(0x23c));db['ref'](_0xca7fb5(0x200)+roomCode+_0xca7fb5(0x23a))['on'](_0xca7fb5(0x258),_0x4f3df=>{const _0x21eab7=_0xca7fb5,_0x32b352=_0x4f3df[_0x21eab7(0x274)]();if(!_0x32b352)return _0x5c05a3[_0x21eab7(0x240)]='';const _0x41e988=Object['values'](_0x32b352)[_0x21eab7(0x2ad)](_0x422cb2=>_0x422cb2!==username);_0x5c05a3[_0x21eab7(0x240)]=_0x41e988[_0x21eab7(0x235)]?_0x41e988[_0x21eab7(0x294)](',\x20')+'\x20typing...':'';});}function trackPresence(){const _0x1124b5=_0x272768;if(!username||!roomCode)return;const _0x4bcde5=sanitizeUsername(username),_0x406977=db[_0x1124b5(0x2ac)](_0x1124b5(0x217)+roomCode+'/'+_0x4bcde5),_0xe52143=localStorage['getItem'](_0x1124b5(0x226))||'',_0x44e6b1={'username':username,'lastOnline':firebase[_0x1124b5(0x272)][_0x1124b5(0x23b)]['TIMESTAMP'],'online':!![],'avatarBase64':_0xe52143};db[_0x1124b5(0x2ac)](_0x1124b5(0x231)+roomCode+'/'+_0x4bcde5)[_0x1124b5(0x271)](_0x1124b5(0x258))[_0x1124b5(0x29a)](_0x461d1b=>{const _0x5aa49c=_0x1124b5;if(_0x461d1b['exists']())_0x44e6b1[_0x5aa49c(0x2aa)]=!![];_0x406977[_0x5aa49c(0x20f)](_0x44e6b1),_0x406977[_0x5aa49c(0x2ab)]()['update']({'online':![],'lastOnline':Date[_0x5aa49c(0x222)]()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0xdc057b){const _0x3dedfe=_0x272768;if(!_0xdc057b[_0x3dedfe(0x239)][_0x3dedfe(0x235)])return;const _0x56a5db=new FileReader();_0x56a5db[_0x3dedfe(0x288)]=()=>{const _0x3e09df=_0x3dedfe,_0x1639df=_0x56a5db[_0x3e09df(0x27a)]['split'](',')[0x1];localStorage[_0x3e09df(0x26f)](_0x3e09df(0x226),_0x1639df);const _0x311bef=document[_0x3e09df(0x225)]('sidebarAvatarPreview');_0x311bef[_0x3e09df(0x1fe)]='data:image/png;base64,'+_0x1639df,_0x311bef[_0x3e09df(0x25a)][_0x3e09df(0x1f6)]=_0x3e09df(0x2a7),trackPresence();},_0x56a5db[_0x3dedfe(0x23f)](_0xdc057b[_0x3dedfe(0x239)][0x0]);}function muteUser(_0x52ecb7,_0x77dbe2){const _0x3c4fc7=_0x272768;if(!isRoomAdmin)return alert('Admins\x20only.');const _0x40a6b9=Date[_0x3c4fc7(0x222)]()+_0x77dbe2*0x3c*0x3e8;db['ref']('muted/'+roomCode+'/'+sanitizeUsername(_0x52ecb7))[_0x3c4fc7(0x20f)](_0x40a6b9);}function unmuteUser(_0x4d0c6f){const _0x4c6bdf=_0x272768;if(!isRoomAdmin)return alert(_0x4c6bdf(0x25c));db[_0x4c6bdf(0x2ac)](_0x4c6bdf(0x295)+roomCode+'/'+sanitizeUsername(_0x4d0c6f))[_0x4c6bdf(0x26e)]();}function updateOnlineIndicator(){const _0x18b6b8=_0x272768,_0x2d0ed3=document[_0x18b6b8(0x225)](_0x18b6b8(0x291));_0x2d0ed3[_0x18b6b8(0x240)]=_0x18b6b8(0x25b),_0x2d0ed3[_0x18b6b8(0x25a)][_0x18b6b8(0x25d)]='#00ff88';}setInterval(updateOnlineIndicator,0xbb8);function viewProfile(_0xc6522e){const _0x153077=_0x272768;db['ref']('profiles/'+_0xc6522e)[_0x153077(0x238)]()['then'](_0x4623c9=>{const _0x541281=_0x153077;if(!_0x4623c9[_0x541281(0x269)]())return;const _0xf0b1c2=_0x4623c9[_0x541281(0x274)](),_0x359ed8=(_0x541281(0x296)+_0xf0b1c2[_0x541281(0x1ec)]+_0x541281(0x280)+(_0xf0b1c2[_0x541281(0x27d)]||'No\x20bio\x20set')+_0x541281(0x209)+(_0xf0b1c2[_0x541281(0x24f)]||[])['join']('\x0a')+_0x541281(0x2ae)+new Date(_0xf0b1c2['lastChanged'])['toLocaleString']()+_0x541281(0x2b6))['trim']();document[_0x541281(0x225)](_0x541281(0x21e))[_0x541281(0x240)]=_0x359ed8,document[_0x541281(0x225)](_0x541281(0x275))[_0x541281(0x25a)][_0x541281(0x1f6)]=_0x541281(0x2a7);});}function initUsernameFlow(){const _0x1680c8=_0x272768,_0x40ddf5=localStorage[_0x1680c8(0x234)]('chat_username');!_0x40ddf5?showScreen(_0x1680c8(0x1fa)):(username=_0x40ddf5,document['getElementById']('namePreview')['innerText']=username,showScreen(_0x1680c8(0x255)));}function closeProfile(){const _0x2ed54c=_0x272768;document[_0x2ed54c(0x225)](_0x2ed54c(0x275))[_0x2ed54c(0x25a)][_0x2ed54c(0x1f6)]=_0x2ed54c(0x263);}