const _0xdf9d64=_0x2071;(function(_0x555bf0,_0x30a0a2){const _0x5c86cc=_0x2071,_0x36139b=_0x555bf0();while(!![]){try{const _0x18dc02=-parseInt(_0x5c86cc(0x241))/0x1+-parseInt(_0x5c86cc(0x1f4))/0x2+parseInt(_0x5c86cc(0x20a))/0x3*(parseInt(_0x5c86cc(0x1f8))/0x4)+-parseInt(_0x5c86cc(0x25d))/0x5+-parseInt(_0x5c86cc(0x22d))/0x6*(parseInt(_0x5c86cc(0x29d))/0x7)+-parseInt(_0x5c86cc(0x211))/0x8*(parseInt(_0x5c86cc(0x1ed))/0x9)+parseInt(_0x5c86cc(0x23f))/0xa;if(_0x18dc02===_0x30a0a2)break;else _0x36139b['push'](_0x36139b['shift']());}catch(_0x1bdecb){_0x36139b['push'](_0x36139b['shift']());}}}(_0x1ee9,0x9814f));const firebaseConfig={'apiKey':_0xdf9d64(0x283),'authDomain':'easy-chatroom.firebaseapp.com','databaseURL':'https://easy-chatroom-default-rtdb.firebaseio.com','projectId':_0xdf9d64(0x1fc),'storageBucket':_0xdf9d64(0x29f),'messagingSenderId':_0xdf9d64(0x27a),'appId':_0xdf9d64(0x2a0),'measurementId':_0xdf9d64(0x268)};firebase[_0xdf9d64(0x21d)](firebaseConfig);const db=firebase[_0xdf9d64(0x226)]();let roomUsers={},userListReady=![],pendingMessages=[],messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math['random']()['toString'](0x24)[_0xdf9d64(0x23c)](0x2,0x9),lastActivity=Date[_0xdf9d64(0x22b)](),typingTimeout,gr8stg='';const STATIC_ROOM=_0xdf9d64(0x26f),MAX_MESSAGES=0xfa,sound=new Audio('sounds/beep.mp3');sound[_0xdf9d64(0x262)]=0.3;let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x213d0d=_0xdf9d64,_0xe7eecc=db[_0x213d0d(0x1ea)]('admins/'+roomCode+'/'+sanitizeUsername(username));return _0xe7eecc[_0x213d0d(0x255)](_0x213d0d(0x216))[_0x213d0d(0x276)](_0x1b3def=>{const _0x1dc5bd=_0x213d0d;isRoomAdmin=_0x1b3def[_0x1dc5bd(0x24f)]();});}function toggleRecording(){const _0x4faf35=_0xdf9d64;isRecording?stopRecording():navigator[_0x4faf35(0x254)]['getUserMedia']({'audio':!![]})['then'](_0x328a22=>{const _0x56f1aa=_0x4faf35;mediaRecorder=new MediaRecorder(_0x328a22),mediaRecorder[_0x56f1aa(0x298)](),isRecording=!![],document['getElementById'](_0x56f1aa(0x294))[_0x56f1aa(0x220)]='‚èπÔ∏è',audioChunks=[],mediaRecorder[_0x56f1aa(0x24c)]=_0x4a0de7=>audioChunks[_0x56f1aa(0x2a4)](_0x4a0de7[_0x56f1aa(0x267)]),mediaRecorder[_0x56f1aa(0x29a)]=()=>{const _0x1ffc82=_0x56f1aa;clearTimeout(recordingTimer);const _0x40f254=new Blob(audioChunks,{'type':_0x1ffc82(0x1fb)}),_0xd1a909=new FileReader();_0xd1a909[_0x1ffc82(0x219)]=()=>{const _0x319d19=_0x1ffc82,_0x38edb0=_0xd1a909[_0x319d19(0x261)][_0x319d19(0x27b)](',')[0x1],_0x596fe0=db[_0x319d19(0x1ea)]()[_0x319d19(0x2a4)]()[_0x319d19(0x230)];db['ref'](_0x319d19(0x232)+roomCode+'/messages/'+_0x596fe0)['set']({'msg':_0x319d19(0x28c),'audioBase64':_0x38edb0,'sender':username,'senderId':clientId,'timestamp':Date[_0x319d19(0x22b)]()});},_0xd1a909['readAsDataURL'](_0x40f254);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0x4faf35(0x25e)](_0x816ddb=>{alert('Microphone\x20permission\x20denied.');});}function stopRecording(){const _0x5d1184=_0xdf9d64;mediaRecorder&&isRecording&&(mediaRecorder['stop'](),isRecording=![],document['getElementById'](_0x5d1184(0x294))['innerText']=_0x5d1184(0x1f7));}window[_0xdf9d64(0x285)]=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x214256){const _0x5bd6ce=_0xdf9d64;return _0x214256[_0x5bd6ce(0x264)](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x50f7bd=_0xdf9d64,_0x6d91e7=document[_0x50f7bd(0x286)](_0x50f7bd(0x2a5))['value']['trim'](),_0x4500f4=document['getElementById'](_0x50f7bd(0x1f6))[_0x50f7bd(0x216)][_0x50f7bd(0x1f5)](),_0x1f1825=document[_0x50f7bd(0x286)](_0x50f7bd(0x22a));if(!_0x6d91e7||!_0x4500f4){_0x1f1825[_0x50f7bd(0x220)]=_0x50f7bd(0x263),_0x1f1825[_0x50f7bd(0x25b)]['display']=_0x50f7bd(0x296);return;}const _0x5948a3=sanitizeUsername(_0x6d91e7),_0xf85faf=db['ref'](_0x50f7bd(0x1ec)+_0x5948a3);_0xf85faf[_0x50f7bd(0x255)](_0x50f7bd(0x216))['then'](_0x203ac5=>{const _0x41b281=_0x50f7bd;if(_0x203ac5[_0x41b281(0x24f)]())_0x1f1825[_0x41b281(0x220)]='‚ùå\x20Username\x20already\x20taken.',_0x1f1825['style']['display']=_0x41b281(0x296);else{const _0x242710={'username':_0x6d91e7,'description':_0x4500f4,'lastChanged':Date[_0x41b281(0x22b)](),'usernameHistory':[_0x6d91e7]};_0xf85faf['set'](_0x242710,_0x23b34e=>{const _0x5c578c=_0x41b281;_0x23b34e?(console['error'](_0x5c578c(0x1e7),_0x23b34e),_0x1f1825['innerText']='‚ö†Ô∏è\x20Failed\x20to\x20save\x20profile.\x20Try\x20again.',_0x1f1825['style'][_0x5c578c(0x218)]=_0x5c578c(0x296)):(localStorage[_0x5c578c(0x272)](_0x5c578c(0x2a1),_0x6d91e7),localStorage[_0x5c578c(0x272)]('profile_description',_0x4500f4),username=_0x6d91e7,document[_0x5c578c(0x286)](_0x5c578c(0x21a))['innerText']=_0x6d91e7,showScreen('roomChoiceScreen'));});}})['catch'](_0x564598=>{const _0x490563=_0x50f7bd;console[_0x490563(0x239)](_0x490563(0x21b),_0x564598),_0x1f1825[_0x490563(0x220)]=_0x490563(0x24d),_0x1f1825[_0x490563(0x25b)][_0x490563(0x218)]=_0x490563(0x296);});}function _0x1ee9(){const _0x22038b=['recordBtn','profile_description','block','state','start','createElement','onstop','keypress','\x0aDescription:\x20','1678915LoKKhk','forEach','easy-chatroom.firebasestorage.app','1:985049198428:web:d0eb7e2de39887710c9b99','chat_username','onlineStatus','sidebarOpen','push','profileUsernameInput','</span>','<div>','toLocaleString','contains','scrollHeight','chatScreen','Failed\x20to\x20save\x20profile:','\x20typing...','update','ref','addEventListener','profiles/','9846bWnfMi','sent','TIMESTAMP','filter','admin','No\x20room\x20code\x20available\x20for\x20private\x20rooms','admins/','491634PiHdHF','trim','profileDescriptionInput','üéôÔ∏è','3185388bBsUbs','toLocaleTimeString','set','audio/webm','easy-chatroom','hidden','<small>','profileScreen','antispamBlocked','files','rooms','Enter','\x20minutes.','username','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','child_added','created','avatar_base64','3XjHLJu','join','roomDisplay','roomChoiceScreen','Type\x20a\x20message...','msgInput','placeholder','696KiVQHC','/typing/','data:image/png;base64,','title','codeEntryScreen','value','#00ff88','display','onloadend','namePreview','Error\x20checking\x20username:','play','initializeApp','\x0aName:\x20','‚õî\x20You\x27re\x20blocked\x20for\x20spamming\x20(30s)','innerText','</div>','\x0aLast\x20Changed:\x20','msg','limitToLast','entries','database','getItem','onDisconnect','<span\x20style=\x22margin-right:5px;\x22>üë§</span>','profileError','now','appendChild','30NaCTbI','innerHTML','popstate','key','floor','rooms/','classList','ceil','/messages/','<span\x20style=\x22margin-right:8px;\x22>üë§</span>','typing','gr8stg','error','messages','<img\x20src=\x22','substr','#888','remove','21307040qdGmFu','antispamBlocked/','413493BEQusx','passwordScreen','val','0123456789','active','add','profileViewer','lastOnline','<audio\x20controls\x20src=\x22','DOMContentLoaded','from','ondataavailable','‚ö†Ô∏è\x20Could\x20not\x20check\x20username.\x20Try\x20again.','map','exists','passwordError','Admins\x20only.','You\x20can\x20change\x20your\x20profile\x20again\x20in\x20','<span\x20class=\x22sender-name\x22>','mediaDevices','once','Missing\x20room\x20or\x20user\x20information.','2-digit','color','‚õî\x20You‚Äôve\x20been\x20muted\x20for\x20spamming.\x20Please\x20wait\x2030\x20seconds.','audioUrl','style','Failed\x20to\x20register\x20user\x20in\x20room.','1752055eYtcfe','catch','\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>','\x20<span\x20style=\x22color:red;\x22>Admin</span>','result','volume','Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.','replace','length','/messages','data','G-QDESJ2WR42','userSidebar','<li\x20style=\x22color:','scrollTop','avatarBase64','antispam','readAsDataURL','050BBB66HH','No\x20bio\x20set','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','setItem','ABCDEFGHIJKLMNOPQRSTUVWXYZ',')\x20New\x20message\x20‚Ä¢\x20','roomCodeInput','then','back','\x0aHistory:\x0a','‚óè\x20Online','985049198428','split','flex','antispam/','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','show','<img\x20src=\x22data:image/png;base64,','users/','usernameHistory','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','toUpperCase','onload','getElementById','none','description','ServerValue','get','staticPasswordInput','[Voice\x20message]','profileContent','Profile\x20not\x20found.','pushState','sidebarAvatarPreview','usernameScreen','userList','disabled'];_0x1ee9=function(){return _0x22038b;};return _0x1ee9();}function saveProfile(_0xcad55a,_0x5316d5,_0x487632){const _0x2c25ef=_0xdf9d64,_0x45cbd1=Date['now'](),_0x2895cc=[_0xcad55a];db[_0x2c25ef(0x1ea)](_0x2c25ef(0x1ec)+_0x487632)[_0x2c25ef(0x1fa)]({'username':_0xcad55a,'description':_0x5316d5,'lastChanged':_0x45cbd1,'usernameHistory':_0x2895cc}),localStorage['setItem'](_0x2c25ef(0x2a1),_0xcad55a),localStorage[_0x2c25ef(0x272)](_0x2c25ef(0x295),_0x5316d5),document[_0x2c25ef(0x286)](_0x2c25ef(0x21a))[_0x2c25ef(0x220)]=_0xcad55a,showScreen(_0x2c25ef(0x20d));}function generateRoom(){const _0x178652=_0xdf9d64;roomCode=genRoomCode(),db[_0x178652(0x1ea)](_0x178652(0x232)+roomCode)[_0x178652(0x1fa)]({'active':!![],'created':Date[_0x178652(0x22b)]()}),startChat();}function joinRoom(){const _0x12452b=_0xdf9d64,_0x17bf0b=roomCode||document[_0x12452b(0x286)](_0x12452b(0x275))[_0x12452b(0x216)][_0x12452b(0x1f5)]()[_0x12452b(0x284)]();if(!_0x17bf0b)return alert('Enter\x20a\x20valid\x20room\x20code');roomCode=_0x17bf0b;if(roomCode===STATIC_ROOM){showScreen(_0x12452b(0x242));return;}db[_0x12452b(0x1ea)]('rooms/'+roomCode)['get']()[_0x12452b(0x276)](_0x281b91=>{const _0x41217a=_0x12452b;_0x281b91[_0x41217a(0x24f)]()&&_0x281b91[_0x41217a(0x243)]()[_0x41217a(0x245)]!==![]?startChat():alert('Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.');});}function startChat(){const _0x2e0d1e=_0xdf9d64;if(!roomCode||!username)return alert(_0x2e0d1e(0x256)),showScreen('roomChoiceScreen');checkIfAdmin()['then'](()=>{const _0x2827b4=_0x2e0d1e,_0x4f5c97=sanitizeUsername(username),_0x1aa5d3=db[_0x2827b4(0x1ea)](_0x2827b4(0x281)+roomCode+'/'+_0x4f5c97),_0x550c5c={'username':username,'lastOnline':firebase[_0x2827b4(0x226)][_0x2827b4(0x289)][_0x2827b4(0x1ef)],'online':!![]};db['ref'](_0x2827b4(0x1f3)+roomCode+'/'+_0x4f5c97)['once'](_0x2827b4(0x216))[_0x2827b4(0x276)](_0x3e573a=>{const _0x4b5552=_0x2827b4;_0x3e573a[_0x4b5552(0x24f)]()&&(_0x550c5c[_0x4b5552(0x1f1)]=!![]),_0x1aa5d3[_0x4b5552(0x1fa)](_0x550c5c,_0x5378cf=>{const _0x2b7ccc=_0x4b5552;if(_0x5378cf)return alert(_0x2b7ccc(0x25c)),showScreen(_0x2b7ccc(0x20d));_0x1aa5d3[_0x2b7ccc(0x228)]()[_0x2b7ccc(0x1e9)]({'online':![],'lastOnline':Date[_0x2b7ccc(0x22b)]()}),document[_0x2b7ccc(0x286)]('userDisplay')[_0x2b7ccc(0x220)]=username,roomCode===STATIC_ROOM?document[_0x2b7ccc(0x286)](_0x2b7ccc(0x20c))['innerText']=_0x2b7ccc(0x1f2):document['getElementById']('roomDisplay')['innerText']=roomCode,showScreen(_0x2b7ccc(0x2ab)),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x470ff6=_0xdf9d64,_0x225459=document[_0x470ff6(0x286)](_0x470ff6(0x28b))[_0x470ff6(0x216)],_0x4a0fc6=document['getElementById'](_0x470ff6(0x250));db[_0x470ff6(0x1ea)](_0x470ff6(0x238))['get']()[_0x470ff6(0x276)](_0x4b4325=>{const _0x2ee6af=_0x470ff6,_0x5b8c1f=_0x4b4325[_0x2ee6af(0x243)]();_0x225459===_0x5b8c1f?(_0x4a0fc6['style'][_0x2ee6af(0x218)]='none',startChat()):_0x4a0fc6[_0x2ee6af(0x25b)][_0x2ee6af(0x218)]='block';});}const spamTimestamps=[];function sendMessage(){const _0xacc9dc=_0xdf9d64,_0x48bbf3=document['getElementById'](_0xacc9dc(0x20f)),_0x2ac739=_0x48bbf3[_0xacc9dc(0x216)][_0xacc9dc(0x1f5)]();if(!_0x2ac739||isBlocked)return;const _0x209257=Date[_0xacc9dc(0x22b)]();spamTimestamps[_0xacc9dc(0x2a4)](_0x209257);const _0xd438c=spamTimestamps['filter'](_0x43b80d=>_0x209257-_0x43b80d<0x1b58);if(_0xd438c[_0xacc9dc(0x265)]>0x5){isBlocked=!![],_0x48bbf3[_0xacc9dc(0x293)]=!![],_0x48bbf3[_0xacc9dc(0x210)]=_0xacc9dc(0x21f),alert(_0xacc9dc(0x259)),setTimeout(()=>{const _0x3a3539=_0xacc9dc;isBlocked=![],_0x48bbf3[_0x3a3539(0x293)]=![],_0x48bbf3[_0x3a3539(0x210)]=_0x3a3539(0x20e),spamTimestamps[_0x3a3539(0x265)]=0x0;},0x7530);return;}const _0x2349ca=localStorage[_0xacc9dc(0x227)](_0xacc9dc(0x209))||'',_0xfa3120=db[_0xacc9dc(0x1ea)]()['push']()[_0xacc9dc(0x230)];db[_0xacc9dc(0x1ea)](_0xacc9dc(0x232)+roomCode+_0xacc9dc(0x235)+_0xfa3120)[_0xacc9dc(0x1fa)]({'msg':_0x2ac739,'sender':username,'senderId':clientId,'avatarBase64':_0x2349ca,'timestamp':_0x209257}),_0x48bbf3[_0xacc9dc(0x216)]='',sendTyping(!![]),lastActivity=_0x209257;}function listenForMessages(){const _0x144b6e=_0xdf9d64,_0x418608=db['ref'](_0x144b6e(0x232)+roomCode+_0x144b6e(0x266)),_0x2fdcbe=_0x418608[_0x144b6e(0x224)](MAX_MESSAGES);_0x2fdcbe['on'](_0x144b6e(0x207),_0x420faf=>{const _0x50f5ff=_0x144b6e,_0x4612e2=_0x420faf['val'](),{senderId:_0x4f1e6b}=_0x4612e2,_0x34094f=_0x4f1e6b===clientId;if(!userListReady){pendingMessages[_0x50f5ff(0x2a4)]({'data':_0x4612e2,'sent':_0x34094f,'key':_0x420faf[_0x50f5ff(0x230)]});return;}const _0x456731=_0x4612e2[_0x50f5ff(0x25a)]||null,_0x4d7d64=_0x4612e2['audioBase64']||null;addMessage(_0x4612e2,_0x34094f,_0x420faf[_0x50f5ff(0x230)]),roomCode!==STATIC_ROOM&&db[_0x50f5ff(0x1ea)]('rooms/'+roomCode+_0x50f5ff(0x235)+_0x420faf[_0x50f5ff(0x230)])[_0x50f5ff(0x23e)](),!_0x34094f&&(sound[_0x50f5ff(0x21c)](),flagPageAttention());});}function addMessage(_0x35626f,_0x4bf22c,_0x5e69c1=null){const _0x22ce9d=_0xdf9d64,{msg:_0x45fe21,sender:_0xdbc983,senderId:_0x57d05b,timestamp:_0x4e9b75,audioUrl:_0x308566,audioBase64:_0x1a78f6,imageBase64:_0x11ceb4}=_0x35626f,_0x464b6d=document[_0x22ce9d(0x299)]('div');_0x464b6d[_0x22ce9d(0x233)]['add'](_0x22ce9d(0x223),_0x4bf22c?_0x22ce9d(0x1ee):'received');const _0x2a247d=new Date(_0x4e9b75)[_0x22ce9d(0x1f9)]([],{'hour':'2-digit','minute':_0x22ce9d(0x257)}),_0x5ccb16=sanitizeUsername(_0xdbc983),_0x11b8a1=roomUsers[_0x5ccb16]||{},_0x4f7adf=_0x11b8a1['avatarBase64']?_0x22ce9d(0x280)+_0x11b8a1[_0x22ce9d(0x26c)]+_0x22ce9d(0x27e):_0x22ce9d(0x236);let _0x5fab47=_0x4f7adf+_0x22ce9d(0x253)+_0xdbc983+_0x22ce9d(0x2a6);_0x11b8a1['admin']&&(_0x5fab47+=_0x22ce9d(0x25f));_0x5fab47+='<br>';const _0x177c4c=_0x45fe21?.[_0x22ce9d(0x264)](new RegExp('@'+username+'\x5cb','gi'),'<span\x20style=\x22color:#ff4081;\x22>@$&</span>');if(_0x308566)_0x5fab47+='<audio\x20controls\x20src=\x22'+_0x308566+_0x22ce9d(0x271);else{if(_0x1a78f6){const _0x8cc8a3='data:audio/webm;base64,'+_0x1a78f6;_0x5fab47+=_0x22ce9d(0x249)+_0x8cc8a3+_0x22ce9d(0x271);}else{if(_0x11ceb4){const _0x321967=_0x22ce9d(0x213)+_0x11ceb4;_0x5fab47+=_0x22ce9d(0x23b)+_0x321967+'\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>';}else _0x5fab47+=_0x22ce9d(0x2a7)+_0x177c4c+_0x22ce9d(0x221);}}_0x5fab47+=_0x22ce9d(0x1fe)+_0x2a247d+'</small>',_0x464b6d[_0x22ce9d(0x22e)]=_0x5fab47;const _0x4363e4=document[_0x22ce9d(0x286)](_0x22ce9d(0x23a));_0x4363e4[_0x22ce9d(0x22c)](_0x464b6d),_0x4363e4[_0x22ce9d(0x26b)]=_0x4363e4[_0x22ce9d(0x2aa)];}function cleanupOldRooms(){const _0x1c8eb6=_0xdf9d64;db['ref'](_0x1c8eb6(0x202))[_0x1c8eb6(0x255)](_0x1c8eb6(0x216))['then'](_0x2cba45=>{const _0x8ec0b2=_0x1c8eb6,_0x57833b=_0x2cba45['val']();if(!_0x57833b)return;const _0x1933f0=Date[_0x8ec0b2(0x22b)]();for(const _0xe67c2b in _0x57833b){if(_0xe67c2b===STATIC_ROOM)continue;const _0x43804d=_0x57833b[_0xe67c2b];_0x1933f0-(_0x43804d[_0x8ec0b2(0x208)]||0x0)>0x2*0x3c*0x3e8&&db[_0x8ec0b2(0x1ea)](_0x8ec0b2(0x232)+_0xe67c2b)['remove']();}db[_0x8ec0b2(0x1ea)](_0x8ec0b2(0x26d))['once']('value')[_0x8ec0b2(0x276)](_0x50b5c7=>{const _0x557615=_0x8ec0b2,_0x16dcf=_0x50b5c7[_0x557615(0x243)]();if(!_0x16dcf)return;for(const _0xf631ef in _0x16dcf){if(_0xf631ef!==STATIC_ROOM)db['ref'](_0x557615(0x27d)+_0xf631ef)[_0x557615(0x23e)]();}}),db[_0x8ec0b2(0x1ea)](_0x8ec0b2(0x200))[_0x8ec0b2(0x255)]('value')[_0x8ec0b2(0x276)](_0x22111c=>{const _0x143007=_0x8ec0b2,_0x538887=_0x22111c[_0x143007(0x243)]();if(!_0x538887)return;for(const _0x5af964 in _0x538887){if(_0x5af964!==STATIC_ROOM)db['ref'](_0x143007(0x240)+_0x5af964)[_0x143007(0x23e)]();}});});}document[_0xdf9d64(0x1eb)](_0xdf9d64(0x24a),()=>{const _0x276066=_0xdf9d64,_0x4baf20=document[_0x276066(0x286)](_0x276066(0x20f));_0x4baf20&&_0x4baf20[_0x276066(0x1eb)](_0x276066(0x29b),function(_0x50195d){const _0x5bb1c9=_0x276066;_0x50195d[_0x5bb1c9(0x230)]===_0x5bb1c9(0x203)&&(_0x50195d['preventDefault'](),sendMessage());});});function showScreen(_0x24b3e8){const _0x2c0007=_0xdf9d64;[_0x2c0007(0x291),_0x2c0007(0x20d),_0x2c0007(0x215),'chatScreen',_0x2c0007(0x242),_0x2c0007(0x1ff),'profileViewer']['forEach'](_0x1714fa=>{const _0x484cff=_0x2c0007;document['getElementById'](_0x1714fa)[_0x484cff(0x25b)][_0x484cff(0x218)]=_0x484cff(0x287);}),document[_0x2c0007(0x286)](_0x24b3e8)[_0x2c0007(0x25b)][_0x2c0007(0x218)]=_0x2c0007(0x27c);}function _0x2071(_0x3c13b2,_0x540897){const _0x1ee9f8=_0x1ee9();return _0x2071=function(_0x2071c5,_0x1c03f1){_0x2071c5=_0x2071c5-0x1e7;let _0x436053=_0x1ee9f8[_0x2071c5];return _0x436053;},_0x2071(_0x3c13b2,_0x540897);}function genRoomCode(){const _0x2e3fe7=_0xdf9d64,_0x2a9ae3=_0x2e3fe7(0x273),_0x6698e1=_0x2e3fe7(0x244),_0x534a36=(_0x3b5afd,_0x1bfcbf)=>Array[_0x2e3fe7(0x24b)]({'length':_0x1bfcbf},()=>_0x3b5afd[Math[_0x2e3fe7(0x231)](Math['random']()*_0x3b5afd[_0x2e3fe7(0x265)])])[_0x2e3fe7(0x20b)]('');return _0x534a36(_0x6698e1,0x3)+_0x534a36(_0x2a9ae3,0x3)+_0x534a36(_0x6698e1,0x2)+_0x534a36(_0x2a9ae3,0x2);}function startInactivityTimer(){setInterval(()=>{const _0xae4fa8=_0x2071;Date[_0xae4fa8(0x22b)]()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db[_0xae4fa8(0x1ea)](_0xae4fa8(0x232)+roomCode)[_0xae4fa8(0x1e9)]({'active':![]}),alert('Session\x20expired.'),location['reload']());},0x7530);}function setupSidebarBackHandler(){const _0x86b794=_0xdf9d64;window[_0x86b794(0x1eb)](_0x86b794(0x22f),()=>{const _0xe3569e=_0x86b794,_0xbf4d6a=document[_0xe3569e(0x286)](_0xe3569e(0x269));_0xbf4d6a?.[_0xe3569e(0x233)]['contains'](_0xe3569e(0x27f))&&_0xbf4d6a['classList']['remove']('show');});}function toggleSidebar(){const _0x1754f0=_0xdf9d64,_0x2de476=document[_0x1754f0(0x286)](_0x1754f0(0x269));if(!_0x2de476[_0x1754f0(0x233)][_0x1754f0(0x2a9)](_0x1754f0(0x27f)))_0x2de476['classList'][_0x1754f0(0x246)](_0x1754f0(0x27f)),history[_0x1754f0(0x28f)]({'sidebarOpen':!![]},'');else{_0x2de476[_0x1754f0(0x233)][_0x1754f0(0x23e)](_0x1754f0(0x27f));if(history[_0x1754f0(0x297)]?.[_0x1754f0(0x2a3)])history[_0x1754f0(0x277)]();}}function setupVisibilityAttention(){const _0x1303ee=_0xdf9d64;let _0x29fa2e=0x0,_0x5c8846=document['title'];document[_0x1303ee(0x1eb)]('visibilitychange',()=>{const _0x209c14=_0x1303ee;!document[_0x209c14(0x1fd)]&&(document[_0x209c14(0x214)]=_0x5c8846,_0x29fa2e=0x0);}),window['flagPageAttention']=function(){const _0x2f0190=_0x1303ee;document['hidden']&&(_0x29fa2e++,document[_0x2f0190(0x214)]='('+_0x29fa2e+_0x2f0190(0x274)+_0x5c8846);};}function tryEditProfile(){const _0x276b91=_0xdf9d64,_0x2f792f=sanitizeUsername(username);db[_0x276b91(0x1ea)]('profiles/'+_0x2f792f)[_0x276b91(0x28a)]()[_0x276b91(0x276)](_0x311809=>{const _0x47db7d=_0x276b91,_0x2023f1=_0x311809[_0x47db7d(0x243)]();if(!_0x2023f1)return alert(_0x47db7d(0x28e));const _0x2eca41=_0x2023f1['lastChanged']||0x0,_0x5ada26=Date[_0x47db7d(0x22b)](),_0x1749c3=0x18*0x3c*0x3c*0x3e8;if(_0x5ada26-_0x2eca41<_0x1749c3){const _0x4cec97=Math[_0x47db7d(0x234)]((_0x1749c3-(_0x5ada26-_0x2eca41))/(0x3c*0x3e8));alert(_0x47db7d(0x252)+_0x4cec97+_0x47db7d(0x204));}else showScreen(_0x47db7d(0x1ff)),document['getElementById'](_0x47db7d(0x2a5))[_0x47db7d(0x216)]=username,document[_0x47db7d(0x286)](_0x47db7d(0x1f6))[_0x47db7d(0x216)]=_0x2023f1[_0x47db7d(0x288)]||'';});}function listenForUserList(){const _0x5e14cb=_0xdf9d64;db[_0x5e14cb(0x1ea)](_0x5e14cb(0x281)+roomCode)['on'](_0x5e14cb(0x216),_0x341dfe=>{const _0x8ca3b1=_0x5e14cb,_0x580834=_0x341dfe[_0x8ca3b1(0x243)]()||{},_0x49eb7c=Date[_0x8ca3b1(0x22b)]();roomUsers={},Object[_0x8ca3b1(0x225)](_0x580834)['forEach'](([_0x5bcbd2,_0x4e0ace])=>{const _0x48ca51=_0x8ca3b1;roomUsers[sanitizeUsername(_0x4e0ace[_0x48ca51(0x205)])]=_0x4e0ace;}),userListReady=!![],pendingMessages[_0x8ca3b1(0x29e)](({data:_0x491d87,sent:_0x2f4e32,key:_0x1b3783})=>{addMessage(_0x491d87,_0x2f4e32,_0x1b3783);}),pendingMessages=[];const _0x4479f4=Object['values'](_0x580834)[_0x8ca3b1(0x24e)](_0x59c0a5=>{const _0x346c30=_0x8ca3b1,_0x1dd50b=_0x59c0a5['online'],_0x399677=_0x49eb7c-_0x59c0a5[_0x346c30(0x248)]<=0x1e*0x3c*0x3e8;if(!_0x1dd50b&&!_0x399677)return'';const _0x50756f=_0x1dd50b?_0x346c30(0x217):_0x346c30(0x23d),_0x2592e7=_0x1dd50b?'üü¢':'üïí',_0x3c9935=_0x59c0a5['avatarBase64']?_0x346c30(0x280)+_0x59c0a5['avatarBase64']+'\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>':_0x346c30(0x229),_0x30179f=_0x59c0a5[_0x346c30(0x1f1)]?_0x346c30(0x260):'';return _0x346c30(0x26a)+_0x50756f+';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27'+sanitizeUsername(_0x59c0a5[_0x346c30(0x205)])+_0x346c30(0x206)+_0x3c9935+_0x2592e7+'\x20'+_0x59c0a5[_0x346c30(0x205)]+_0x30179f+'\x0a\x20\x20\x20\x20\x20\x20</li>';})[_0x8ca3b1(0x20b)]('');document['getElementById'](_0x8ca3b1(0x292))[_0x8ca3b1(0x22e)]=_0x4479f4;});}function sendTyping(_0x10afd=![]){const _0x37f114=_0xdf9d64;if(isBlocked)return;const _0x5ae7fe='rooms/'+roomCode+_0x37f114(0x212)+clientId;_0x10afd?db[_0x37f114(0x1ea)](_0x5ae7fe)['remove']():(db['ref'](_0x5ae7fe)[_0x37f114(0x1fa)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x1bfff8=_0x37f114;db[_0x1bfff8(0x1ea)](_0x5ae7fe)['remove']();},0xbb8));}function listenForTyping(){const _0x417496=_0xdf9d64,_0x4040a5=document['getElementById'](_0x417496(0x237));db[_0x417496(0x1ea)](_0x417496(0x232)+roomCode+'/typing')['on'](_0x417496(0x216),_0x5bcc3e=>{const _0x3e5917=_0x417496,_0x336fc1=_0x5bcc3e[_0x3e5917(0x243)]();if(!_0x336fc1)return _0x4040a5[_0x3e5917(0x220)]='';const _0x57f879=Object['values'](_0x336fc1)[_0x3e5917(0x1f0)](_0x5bc8e1=>_0x5bc8e1!==username);_0x4040a5[_0x3e5917(0x220)]=_0x57f879[_0x3e5917(0x265)]?_0x57f879[_0x3e5917(0x20b)](',\x20')+_0x3e5917(0x1e8):'';});}function trackPresence(){const _0x3a1c49=_0xdf9d64;if(!username||!roomCode)return;const _0x472490=sanitizeUsername(username),_0x5f4387=db[_0x3a1c49(0x1ea)](_0x3a1c49(0x281)+roomCode+'/'+_0x472490),_0x2c5a0f=localStorage[_0x3a1c49(0x227)](_0x3a1c49(0x209))||'',_0xa21c94={'username':username,'lastOnline':firebase[_0x3a1c49(0x226)][_0x3a1c49(0x289)][_0x3a1c49(0x1ef)],'online':!![],'avatarBase64':_0x2c5a0f};db[_0x3a1c49(0x1ea)](_0x3a1c49(0x1f3)+roomCode+'/'+_0x472490)[_0x3a1c49(0x255)](_0x3a1c49(0x216))[_0x3a1c49(0x276)](_0x4fc629=>{const _0x3ab9c3=_0x3a1c49;if(_0x4fc629[_0x3ab9c3(0x24f)]())_0xa21c94['admin']=!![];_0x5f4387[_0x3ab9c3(0x1fa)](_0xa21c94),_0x5f4387[_0x3ab9c3(0x228)]()[_0x3ab9c3(0x1e9)]({'online':![],'lastOnline':Date[_0x3ab9c3(0x22b)]()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0x487908){const _0x37a23c=_0xdf9d64;if(!_0x487908[_0x37a23c(0x201)][_0x37a23c(0x265)])return;const _0x25a199=new FileReader();_0x25a199[_0x37a23c(0x219)]=()=>{const _0xb51193=_0x37a23c,_0x21d155=_0x25a199[_0xb51193(0x261)][_0xb51193(0x27b)](',')[0x1];localStorage[_0xb51193(0x272)](_0xb51193(0x209),_0x21d155);const _0x4adc18=document[_0xb51193(0x286)](_0xb51193(0x290));_0x4adc18['src']='data:image/png;base64,'+_0x21d155,_0x4adc18[_0xb51193(0x25b)][_0xb51193(0x218)]=_0xb51193(0x296),trackPresence();},_0x25a199[_0x37a23c(0x26e)](_0x487908['files'][0x0]);}function muteUser(_0xc5ff32,_0x927782){const _0x4cd047=_0xdf9d64;if(!isRoomAdmin)return alert(_0x4cd047(0x251));const _0x4154c3=Date['now']()+_0x927782*0x3c*0x3e8;db[_0x4cd047(0x1ea)]('muted/'+roomCode+'/'+sanitizeUsername(_0xc5ff32))[_0x4cd047(0x1fa)](_0x4154c3);}function unmuteUser(_0xf37ab){const _0x5dd796=_0xdf9d64;if(!isRoomAdmin)return alert('Admins\x20only.');db[_0x5dd796(0x1ea)]('muted/'+roomCode+'/'+sanitizeUsername(_0xf37ab))['remove']();}function updateOnlineIndicator(){const _0x3ffec3=_0xdf9d64,_0x3e4f9c=document[_0x3ffec3(0x286)](_0x3ffec3(0x2a2));_0x3e4f9c[_0x3ffec3(0x220)]=_0x3ffec3(0x279),_0x3e4f9c[_0x3ffec3(0x25b)][_0x3ffec3(0x258)]=_0x3ffec3(0x217);}setInterval(updateOnlineIndicator,0xbb8);function viewProfile(_0x2e95ea){const _0x4d249d=_0xdf9d64;db['ref'](_0x4d249d(0x1ec)+_0x2e95ea)['get']()[_0x4d249d(0x276)](_0x5a719c=>{const _0x2087e9=_0x4d249d;if(!_0x5a719c[_0x2087e9(0x24f)]())return;const _0x357608=_0x5a719c['val'](),_0x34ca62=(_0x2087e9(0x21e)+_0x357608[_0x2087e9(0x205)]+_0x2087e9(0x29c)+(_0x357608['description']||_0x2087e9(0x270))+_0x2087e9(0x278)+(_0x357608[_0x2087e9(0x282)]||[])['join']('\x0a')+_0x2087e9(0x222)+new Date(_0x357608['lastChanged'])[_0x2087e9(0x2a8)]()+'\x0a\x20\x20\x20\x20')['trim']();document[_0x2087e9(0x286)](_0x2087e9(0x28d))[_0x2087e9(0x220)]=_0x34ca62,document[_0x2087e9(0x286)]('profileViewer')['style']['display']=_0x2087e9(0x296);});}function initUsernameFlow(){const _0x3f1e52=_0xdf9d64,_0x171c96=localStorage[_0x3f1e52(0x227)](_0x3f1e52(0x2a1));!_0x171c96?showScreen(_0x3f1e52(0x1ff)):(username=_0x171c96,document[_0x3f1e52(0x286)](_0x3f1e52(0x21a))[_0x3f1e52(0x220)]=username,showScreen('roomChoiceScreen'));}function closeProfile(){const _0x3cc195=_0xdf9d64;document[_0x3cc195(0x286)](_0x3cc195(0x247))[_0x3cc195(0x25b)][_0x3cc195(0x218)]=_0x3cc195(0x287);}