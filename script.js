const _0x1a0fc8=_0x17ea;function _0x5546(){const _0x43306a=['rooms/','\x20joined\x20the\x20room','codeEntryScreen','limitToLast','update','/typing/','substr','received','/messages/','üóëÔ∏è\x20Deleted\x20expired\x20room:','ABCDEFGHIJKLMNOPQRSTUVWXYZ','forEach','toString','248997WrQnuR','Enter\x20a\x20valid\x20room\x20code','typing','532yTvLlL','values','namePreview','3777RAEMss','messages','onload','/typing','addEventListener','display','system','random','innerText','Enter','div','ref','from','now','scrollTop','userList','add','toggle','lastOnline','chatScreen','Please\x20enter\x20your\x20name','length','msgInput','none','ServerValue','23360YGHKgJ','reload','innerHTML','TIMESTAMP','users/','entries','once','style','classList','get','#888','beforeunload','050BBB66HH','<small>','appendChild','trim','0123456789','key','join','active','push','createElement','getElementById','754446NwOkdO','AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','exists','40dgaiFw','</small>','usernameInput','\x20left\x20the\x20room','2-digit','setItem','set','985049198428','initializeApp','15205Soowgv','toLocaleTimeString','database','remove','value','onDisconnect','Session\x20expired.','roomChoiceScreen','floor','preventDefault','val','show','2457072EQNZOH','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','</li>','141145sePvBA','child_added','created','easy-chatroom.firebaseapp.com','msg','chat_username','DOMContentLoaded','usernameScreen','log','userSidebar','</span><br>'];_0x5546=function(){return _0x43306a;};return _0x5546();}(function(_0x147219,_0x3d88e1){const _0x5066b9=_0x17ea,_0x31b5a1=_0x147219();while(!![]){try{const _0x4d4df4=-parseInt(_0x5066b9(0x136))/0x1+-parseInt(_0x5066b9(0x113))/0x2+parseInt(_0x5066b9(0xfa))/0x3*(-parseInt(_0x5066b9(0xf7))/0x4)+-parseInt(_0x5066b9(0x145))/0x5+-parseInt(_0x5066b9(0x12a))/0x6+parseInt(_0x5066b9(0xf4))/0x7*(parseInt(_0x5066b9(0x12d))/0x8)+parseInt(_0x5066b9(0x142))/0x9;if(_0x4d4df4===_0x3d88e1)break;else _0x31b5a1['push'](_0x31b5a1['shift']());}catch(_0x30cf04){_0x31b5a1['push'](_0x31b5a1['shift']());}}}(_0x5546,0x190a1));const firebaseConfig={'apiKey':_0x1a0fc8(0x12b),'authDomain':_0x1a0fc8(0x148),'databaseURL':'https://easy-chatroom-default-rtdb.firebaseio.com','projectId':'easy-chatroom','storageBucket':'easy-chatroom.firebasestorage.app','messagingSenderId':_0x1a0fc8(0x134),'appId':'1:985049198428:web:d0eb7e2de39887710c9b99','measurementId':'G-QDESJ2WR42'};firebase[_0x1a0fc8(0x135)](firebaseConfig);const db=firebase['database'](),STATIC_ROOM=_0x1a0fc8(0x11f),ROOM_TTL_MS=0x2*0x3c*0x3e8;let username=localStorage['getItem']('chat_username'),roomCode='',clientId=generateClientId(),lastActivity=Date[_0x1a0fc8(0x107)](),typingTimeout;window[_0x1a0fc8(0xfc)]=()=>{const _0x25309d=_0x1a0fc8;!username?showScreen(_0x25309d(0x14c)):(document['getElementById']('namePreview')[_0x25309d(0x102)]=username,showScreen('roomChoiceScreen')),cleanupOldRooms(),!username?showScreen(_0x25309d(0x14c)):(document[_0x25309d(0x129)](_0x25309d(0xf9))[_0x25309d(0x102)]=username,showScreen(_0x25309d(0x13d)));};function saveUsername(){const _0x2150af=_0x1a0fc8;username=document[_0x2150af(0x129)](_0x2150af(0x12f))['value'][_0x2150af(0x122)]();if(!username)return alert(_0x2150af(0x10e));localStorage[_0x2150af(0x132)](_0x2150af(0x14a),username),document[_0x2150af(0x129)](_0x2150af(0xf9))['innerText']=username,showScreen(_0x2150af(0x13d));}function generateRoom(){const _0x148a06=_0x1a0fc8;roomCode=genRoomCode(),db['ref'](_0x148a06(0x150)+roomCode)[_0x148a06(0x133)]({'active':!![],'created':Date[_0x148a06(0x107)]()}),startChat();}function joinRoom(){const _0x31cf59=_0x1a0fc8;roomCode=document[_0x31cf59(0x129)]('roomCodeInput')[_0x31cf59(0x13a)][_0x31cf59(0x122)]()['toUpperCase']();if(!roomCode)return alert(_0x31cf59(0xf5));db[_0x31cf59(0x105)](_0x31cf59(0x150)+roomCode)[_0x31cf59(0x11c)]()['then'](_0x22ff6f=>{const _0x10e352=_0x31cf59;_0x22ff6f[_0x10e352(0x12c)]()&&_0x22ff6f[_0x10e352(0x140)]()[_0x10e352(0x126)]!==![]?startChat():alert(_0x10e352(0x143));});}function joinGlobalRoom(){const _0x2356d8=_0x1a0fc8;roomCode=_0x2356d8(0x11f),db[_0x2356d8(0x105)](_0x2356d8(0x150)+roomCode)[_0x2356d8(0x133)]({'active':!![],'created':Date['now']()}),startChat();}function startChat(){const _0x177b1d=_0x1a0fc8;showScreen(_0x177b1d(0x10d)),document[_0x177b1d(0x129)]('userDisplay')[_0x177b1d(0x102)]=username,document[_0x177b1d(0x129)]('roomDisplay')[_0x177b1d(0x102)]=roomCode,listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),logSystemMessage(username+_0x177b1d(0x151)),window['addEventListener'](_0x177b1d(0x11e),()=>{const _0x352c68=_0x177b1d;logSystemMessage(username+_0x352c68(0x130));});}function trackPresence(){const _0x102ca4=_0x1a0fc8,_0x950900=db[_0x102ca4(0x105)](_0x102ca4(0x117)+roomCode+'/'+clientId),_0x2b16fc={'username':username,'lastOnline':firebase[_0x102ca4(0x138)][_0x102ca4(0x112)][_0x102ca4(0x116)],'online':!![]};_0x950900[_0x102ca4(0x133)](_0x2b16fc),_0x950900[_0x102ca4(0x13b)]()[_0x102ca4(0xeb)]({'online':![],'lastOnline':Date['now']()}),listenForUserList();}function listenForUserList(){const _0x39fa2d=_0x1a0fc8;db['ref'](_0x39fa2d(0x117)+roomCode)['on'](_0x39fa2d(0x13a),_0x5cab8d=>{const _0x41c428=_0x39fa2d,_0x10d1fb=_0x5cab8d[_0x41c428(0x140)]()||{},_0xeb3c9c=Object[_0x41c428(0xf8)](_0x10d1fb),_0x2f5b80=Date[_0x41c428(0x107)](),_0x173071=_0xeb3c9c['map'](_0xcaf1eb=>{const _0x12c47c=_0x41c428,_0x45658c=_0xcaf1eb['online']===!![],_0x49437e=_0x2f5b80-_0xcaf1eb[_0x12c47c(0x10c)]<=0x1e*0x3c*0x3e8;if(_0x45658c||_0x49437e){const _0x2b7b08=_0x45658c?'#00ff88':_0x12c47c(0x11d),_0x45dd1c=_0x45658c?'üü¢':'üïí';return'<li\x20style=\x22color:'+_0x2b7b08+'\x22>'+_0x45dd1c+'\x20'+_0xcaf1eb['username']+_0x12c47c(0x144);}return'';})[_0x41c428(0x125)]('');document['getElementById'](_0x41c428(0x109))[_0x41c428(0x115)]=_0x173071;});}function _0x17ea(_0x55e64e,_0x2b0962){const _0x5546f5=_0x5546();return _0x17ea=function(_0x17ea7d,_0x1a509e){_0x17ea7d=_0x17ea7d-0xea;let _0x4fe68d=_0x5546f5[_0x17ea7d];return _0x4fe68d;},_0x17ea(_0x55e64e,_0x2b0962);}function logSystemMessage(_0x297ea6){const _0xfdf69d=_0x1a0fc8,_0x310c2b=db['ref']()[_0xfdf69d(0x127)]()[_0xfdf69d(0x124)];db['ref'](_0xfdf69d(0x150)+roomCode+_0xfdf69d(0xef)+_0x310c2b)['set']({'msg':_0x297ea6,'sender':'System','senderId':_0xfdf69d(0x100),'timestamp':Date['now']()});}function toggleSidebar(){const _0x5baf91=_0x1a0fc8,_0x1742fa=document['getElementById'](_0x5baf91(0x14e));_0x1742fa[_0x5baf91(0x11b)][_0x5baf91(0x10b)](_0x5baf91(0x141));}document[_0x1a0fc8(0xfe)](_0x1a0fc8(0x14b),()=>{const _0xd5cfc5=_0x1a0fc8,_0x5decc0=document['getElementById'](_0xd5cfc5(0x110));_0x5decc0&&_0x5decc0[_0xd5cfc5(0xfe)]('keypress',function(_0x1a353a){const _0x257acf=_0xd5cfc5;_0x1a353a[_0x257acf(0x124)]===_0x257acf(0x103)&&(_0x1a353a[_0x257acf(0x13f)](),sendMessage());});});function showScreen(_0x5845d6){const _0x152071=_0x1a0fc8;[_0x152071(0x14c),_0x152071(0x13d),_0x152071(0x152),_0x152071(0x10d)][_0x152071(0xf2)](_0x1c5e22=>{const _0x66ced7=_0x152071;document[_0x66ced7(0x129)](_0x1c5e22)['style'][_0x66ced7(0xff)]=_0x66ced7(0x111);}),document[_0x152071(0x129)](_0x5845d6)[_0x152071(0x11a)][_0x152071(0xff)]='flex';}function sendMessage(){const _0x4896e6=_0x1a0fc8,_0x3224d5=document[_0x4896e6(0x129)](_0x4896e6(0x110)),_0x343494=_0x3224d5[_0x4896e6(0x13a)][_0x4896e6(0x122)]();if(!_0x343494)return;const _0x213cf9=db[_0x4896e6(0x105)]()['push']()[_0x4896e6(0x124)];db[_0x4896e6(0x105)](_0x4896e6(0x150)+roomCode+'/messages/'+_0x213cf9)[_0x4896e6(0x133)]({'msg':_0x343494,'sender':username,'senderId':clientId,'timestamp':Date[_0x4896e6(0x107)]()}),_0x3224d5['value']='',sendTyping(!![]),lastActivity=Date[_0x4896e6(0x107)]();}function listenForMessages(){const _0x513c43=_0x1a0fc8,_0x16ede5=db[_0x513c43(0x105)](_0x513c43(0x150)+roomCode+'/messages'),_0x233ded=roomCode===STATIC_ROOM?_0x16ede5[_0x513c43(0xea)](0x50):_0x16ede5;_0x233ded['on'](_0x513c43(0x146),_0x3f7d75=>{const _0x2f3000=_0x513c43,{msg:_0x3e0234,sender:_0x4a3246,senderId:_0x37686f,timestamp:_0x508a80}=_0x3f7d75[_0x2f3000(0x140)](),_0x2b2369=_0x37686f===clientId;addMessage(_0x3e0234,_0x4a3246,_0x508a80,_0x2b2369),roomCode!==STATIC_ROOM&&db['ref'](_0x2f3000(0x150)+roomCode+'/messages/'+_0x3f7d75[_0x2f3000(0x124)])[_0x2f3000(0x139)]();});}function addMessage(_0x21766e,_0xef6503,_0xe8bbf9,_0x1755cf){const _0x308a4c=_0x1a0fc8,_0x459e67=document[_0x308a4c(0x128)](_0x308a4c(0x104));_0x459e67['classList'][_0x308a4c(0x10a)](_0x308a4c(0x149),_0x1755cf?'sent':_0x308a4c(0xee));const _0x416ce3=new Date(_0xe8bbf9)[_0x308a4c(0x137)]([],{'hour':_0x308a4c(0x131),'minute':_0x308a4c(0x131)});_0x459e67[_0x308a4c(0x115)]='<span\x20class=\x22sender-name\x22>'+_0xef6503+_0x308a4c(0x14f)+_0x21766e+_0x308a4c(0x120)+_0x416ce3+_0x308a4c(0x12e),document[_0x308a4c(0x129)]('messages')[_0x308a4c(0x121)](_0x459e67),document[_0x308a4c(0x129)](_0x308a4c(0xfb))[_0x308a4c(0x108)]=0x1869f;}function sendTyping(_0x58292b=![]){const _0x2cfe9d=_0x1a0fc8;_0x58292b?db['ref']('rooms/'+roomCode+_0x2cfe9d(0xec)+clientId)['remove']():(db[_0x2cfe9d(0x105)](_0x2cfe9d(0x150)+roomCode+_0x2cfe9d(0xec)+clientId)[_0x2cfe9d(0x133)](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x38d1c9=_0x2cfe9d;db[_0x38d1c9(0x105)](_0x38d1c9(0x150)+roomCode+_0x38d1c9(0xec)+clientId)[_0x38d1c9(0x139)]();},0xbb8));}function listenForTyping(){const _0x3aac44=_0x1a0fc8,_0x3c6182=document[_0x3aac44(0x129)](_0x3aac44(0xf6));db[_0x3aac44(0x105)](_0x3aac44(0x150)+roomCode+_0x3aac44(0xfd))['on'](_0x3aac44(0x13a),_0x5f50ee=>{const _0x26e149=_0x3aac44,_0x36eb29=_0x5f50ee[_0x26e149(0x140)]();if(!_0x36eb29)return _0x3c6182['innerText']='';const _0x3bd0be=Object[_0x26e149(0xf8)](_0x36eb29)['filter'](_0x286bcd=>_0x286bcd!==username);_0x3c6182[_0x26e149(0x102)]=_0x3bd0be[_0x26e149(0x10f)]?_0x3bd0be[_0x26e149(0x125)](',\x20')+'\x20typing...':'';});}function startInactivityTimer(){setInterval(()=>{const _0x451ef7=_0x17ea;Date[_0x451ef7(0x107)]()-lastActivity>0x5*0x3c*0x3e8&&(db[_0x451ef7(0x105)](_0x451ef7(0x150)+roomCode)[_0x451ef7(0xeb)]({'active':![]}),alert(_0x451ef7(0x13c)),location[_0x451ef7(0x114)]());},0x7530);}function genRoomCode(){const _0x1a3b3d=_0x1a0fc8,_0x41c9f8=_0x1a3b3d(0xf1),_0x17cd71=_0x1a3b3d(0x123),_0x12bea5=(_0x39d51a,_0x4cc6fa)=>Array[_0x1a3b3d(0x106)]({'length':_0x4cc6fa},()=>_0x39d51a[Math[_0x1a3b3d(0x13e)](Math[_0x1a3b3d(0x101)]()*_0x39d51a[_0x1a3b3d(0x10f)])])[_0x1a3b3d(0x125)]('');return _0x12bea5(_0x17cd71,0x3)+_0x12bea5(_0x41c9f8,0x3)+_0x12bea5(_0x17cd71,0x2)+_0x12bea5(_0x41c9f8,0x2);}function generateClientId(){const _0x4ade87=_0x1a0fc8;return'_'+Math['random']()[_0x4ade87(0xf3)](0x24)[_0x4ade87(0xed)](0x2,0x9);}function cleanupOldRooms(){const _0x413297=_0x1a0fc8;db[_0x413297(0x105)]('rooms')[_0x413297(0x119)](_0x413297(0x13a))['then'](_0x2e4d3b=>{const _0x2da62c=_0x413297,_0x43629c=_0x2e4d3b[_0x2da62c(0x140)]();if(!_0x43629c)return;const _0x2e9ba5=Date[_0x2da62c(0x107)]();Object[_0x2da62c(0x118)](_0x43629c)[_0x2da62c(0xf2)](([_0x641bf8,_0x13e129])=>{const _0x297512=_0x2da62c;if(_0x641bf8===STATIC_ROOM)return;const _0x484fff=_0x13e129[_0x297512(0x147)]||0x0,_0x314c35=_0x2e9ba5-_0x484fff>ROOM_TTL_MS;_0x314c35&&(db[_0x297512(0x105)]('rooms/'+_0x641bf8)['remove'](),console[_0x297512(0x14d)](_0x297512(0xf0),_0x641bf8));});});}