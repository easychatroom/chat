const _0x3c11e2=_0x2e51;(function(_0x35cc70,_0x116bbe){const _0x5b64df=_0x2e51,_0x2d892f=_0x35cc70();while(!![]){try{const _0xf9f564=parseInt(_0x5b64df(0x28e))/0x1*(-parseInt(_0x5b64df(0x237))/0x2)+parseInt(_0x5b64df(0x23b))/0x3+parseInt(_0x5b64df(0x2a4))/0x4*(-parseInt(_0x5b64df(0x1f8))/0x5)+-parseInt(_0x5b64df(0x252))/0x6+-parseInt(_0x5b64df(0x206))/0x7+-parseInt(_0x5b64df(0x29b))/0x8+-parseInt(_0x5b64df(0x2a5))/0x9*(-parseInt(_0x5b64df(0x217))/0xa);if(_0xf9f564===_0x116bbe)break;else _0x2d892f['push'](_0x2d892f['shift']());}catch(_0x1af5c2){_0x2d892f['push'](_0x2d892f['shift']());}}}(_0x5395,0x772c0));const firebaseConfig={'apiKey':'AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw','authDomain':_0x3c11e2(0x26b),'databaseURL':_0x3c11e2(0x208),'projectId':'easy-chatroom','storageBucket':_0x3c11e2(0x1f3),'messagingSenderId':'985049198428','appId':_0x3c11e2(0x243),'measurementId':'G-QDESJ2WR42'};firebase[_0x3c11e2(0x260)](firebaseConfig);const db=firebase[_0x3c11e2(0x238)](),roomUsers={};let messageTimestamps=[],isBlocked=![],username=null,roomCode=null,clientId='_'+Math[_0x3c11e2(0x236)]()[_0x3c11e2(0x27d)](0x24)[_0x3c11e2(0x254)](0x2,0x9),lastActivity=Date['now'](),typingTimeout,gr8stg='';const STATIC_ROOM=_0x3c11e2(0x22e),MAX_MESSAGES=0xfa,sound=new Audio('sounds/beep.mp3');sound[_0x3c11e2(0x251)]=0.3;let mediaRecorder,audioChunks=[],isRecording=![],recordingTimer,isRoomAdmin=![];function checkIfAdmin(){const _0x304e36=_0x3c11e2,_0x1b96ca=db[_0x304e36(0x241)](_0x304e36(0x264)+roomCode+'/'+sanitizeUsername(username));return _0x1b96ca[_0x304e36(0x233)](_0x304e36(0x207))['then'](_0x20e278=>{const _0x170856=_0x304e36;isRoomAdmin=_0x20e278[_0x170856(0x2aa)]();});}function toggleRecording(){const _0x1948a6=_0x3c11e2;isRecording?stopRecording():navigator[_0x1948a6(0x200)][_0x1948a6(0x209)]({'audio':!![]})['then'](_0x552ec0=>{const _0x56ed2a=_0x1948a6;mediaRecorder=new MediaRecorder(_0x552ec0),mediaRecorder['start'](),isRecording=!![],document[_0x56ed2a(0x234)]('recordBtn')[_0x56ed2a(0x240)]='⏹️',audioChunks=[],mediaRecorder['ondataavailable']=_0x354f78=>audioChunks[_0x56ed2a(0x1fc)](_0x354f78[_0x56ed2a(0x259)]),mediaRecorder[_0x56ed2a(0x262)]=()=>{const _0xf15399=_0x56ed2a;clearTimeout(recordingTimer);const _0x493a90=new Blob(audioChunks,{'type':_0xf15399(0x2ad)}),_0x5f4804=new FileReader();_0x5f4804[_0xf15399(0x25f)]=()=>{const _0x17172f=_0xf15399,_0xdba1f6=_0x5f4804[_0x17172f(0x261)][_0x17172f(0x257)](',')[0x1],_0x589572=db[_0x17172f(0x241)]()['push']()[_0x17172f(0x278)];db['ref'](_0x17172f(0x246)+roomCode+'/messages/'+_0x589572)[_0x17172f(0x269)]({'msg':_0x17172f(0x258),'audioBase64':_0xdba1f6,'sender':username,'senderId':clientId,'timestamp':Date['now']()});},_0x5f4804[_0xf15399(0x1fa)](_0x493a90);},recordingTimer=setTimeout(()=>{mediaRecorder&&isRecording&&stopRecording();},0x4e20);})[_0x1948a6(0x228)](_0x11042d=>{const _0x26f16f=_0x1948a6;alert(_0x26f16f(0x215));});}function stopRecording(){const _0x4624bf=_0x3c11e2;mediaRecorder&&isRecording&&(mediaRecorder['stop'](),isRecording=![],document[_0x4624bf(0x234)]('recordBtn')[_0x4624bf(0x240)]=_0x4624bf(0x276));}window['onload']=()=>{cleanupOldRooms(),setupSidebarBackHandler(),initUsernameFlow(),setupVisibilityAttention();};function sanitizeUsername(_0x566fa4){const _0x326e28=_0x3c11e2;return _0x566fa4[_0x326e28(0x216)](/[.#$\[\]]/g,'_');}function submitProfile(){const _0x2b709b=_0x3c11e2,_0x4d5a79=document['getElementById'](_0x2b709b(0x248))[_0x2b709b(0x207)][_0x2b709b(0x247)](),_0x3187d6=document[_0x2b709b(0x234)](_0x2b709b(0x26f))[_0x2b709b(0x207)][_0x2b709b(0x247)](),_0x583546=document[_0x2b709b(0x234)](_0x2b709b(0x211));if(!_0x4d5a79||!_0x3187d6){_0x583546[_0x2b709b(0x240)]=_0x2b709b(0x27e),_0x583546['style'][_0x2b709b(0x21e)]=_0x2b709b(0x2a1);return;}const _0xe95c75=sanitizeUsername(_0x4d5a79),_0x48f4f1=db['ref'](_0x2b709b(0x230)+_0xe95c75);_0x48f4f1[_0x2b709b(0x233)](_0x2b709b(0x207))[_0x2b709b(0x2ab)](_0x8d6d35=>{const _0x5d5e3d=_0x2b709b;if(_0x8d6d35[_0x5d5e3d(0x2aa)]()){_0x583546[_0x5d5e3d(0x240)]=_0x5d5e3d(0x27f),_0x583546['style'][_0x5d5e3d(0x21e)]=_0x5d5e3d(0x2a1);return;}});}function saveProfile(_0xe20a3,_0x1b4f3c,_0x3d3876){const _0x1da99e=_0x3c11e2,_0x1eb2cb=Date[_0x1da99e(0x239)](),_0xf77561=[_0xe20a3];db['ref'](_0x1da99e(0x230)+_0x3d3876)[_0x1da99e(0x269)]({'username':_0xe20a3,'description':_0x1b4f3c,'lastChanged':_0x1eb2cb,'usernameHistory':_0xf77561}),localStorage[_0x1da99e(0x2a6)](_0x1da99e(0x1ff),_0xe20a3),localStorage[_0x1da99e(0x2a6)](_0x1da99e(0x210),_0x1b4f3c),document['getElementById'](_0x1da99e(0x273))[_0x1da99e(0x240)]=_0xe20a3,showScreen(_0x1da99e(0x22c));}function generateRoom(){roomCode=genRoomCode(),db['ref']('rooms/'+roomCode)['set']({'active':!![],'created':Date['now']()}),startChat();}function joinRoom(){const _0x3665d8=_0x3c11e2,_0x425995=roomCode||document['getElementById'](_0x3665d8(0x285))[_0x3665d8(0x207)][_0x3665d8(0x247)]()[_0x3665d8(0x20d)]();if(!_0x425995)return alert(_0x3665d8(0x25e));roomCode=_0x425995;if(roomCode===STATIC_ROOM){showScreen('passwordScreen');return;}db['ref'](_0x3665d8(0x246)+roomCode)[_0x3665d8(0x2a9)]()[_0x3665d8(0x2ab)](_0x4e914e=>{const _0x5f03ec=_0x3665d8;_0x4e914e[_0x5f03ec(0x2aa)]()&&_0x4e914e[_0x5f03ec(0x1f7)]()[_0x5f03ec(0x291)]!==![]?startChat():alert(_0x5f03ec(0x28f));});}function startChat(){const _0x3e8912=_0x3c11e2;if(!roomCode||!username)return alert('Missing\x20room\x20or\x20user\x20information.'),showScreen('roomChoiceScreen');checkIfAdmin()[_0x3e8912(0x2ab)](()=>{const _0x1bb2fb=_0x3e8912,_0x5be8e6=sanitizeUsername(username),_0x181a28=db['ref']('users/'+roomCode+'/'+_0x5be8e6),_0x2e9798={'username':username,'lastOnline':firebase[_0x1bb2fb(0x238)][_0x1bb2fb(0x29e)]['TIMESTAMP'],'online':!![]};db['ref'](_0x1bb2fb(0x264)+roomCode+'/'+_0x5be8e6)[_0x1bb2fb(0x233)](_0x1bb2fb(0x207))[_0x1bb2fb(0x2ab)](_0x7d19f0=>{const _0x176c0a=_0x1bb2fb;_0x7d19f0[_0x176c0a(0x2aa)]()&&(_0x2e9798[_0x176c0a(0x25b)]=!![]),_0x181a28[_0x176c0a(0x269)](_0x2e9798,_0x5ac246=>{const _0x1a43a5=_0x176c0a;if(_0x5ac246)return alert(_0x1a43a5(0x286)),showScreen(_0x1a43a5(0x22c));_0x181a28['onDisconnect']()[_0x1a43a5(0x24e)]({'online':![],'lastOnline':Date['now']()}),document[_0x1a43a5(0x234)](_0x1a43a5(0x205))['innerText']=username,roomCode===STATIC_ROOM?document[_0x1a43a5(0x234)](_0x1a43a5(0x298))[_0x1a43a5(0x240)]=_0x1a43a5(0x214):document['getElementById']('roomDisplay')['innerText']=roomCode,showScreen(_0x1a43a5(0x267)),listenForMessages(),listenForTyping(),startInactivityTimer(),trackPresence(),listenForUserList();});});});}function validateStaticRoomPassword(){const _0x3a554c=_0x3c11e2,_0x71f46f=document[_0x3a554c(0x234)](_0x3a554c(0x23d))[_0x3a554c(0x207)],_0x5af15a=document['getElementById'](_0x3a554c(0x21b));db[_0x3a554c(0x241)](_0x3a554c(0x202))[_0x3a554c(0x2a9)]()[_0x3a554c(0x2ab)](_0x56a57e=>{const _0x4240d3=_0x3a554c,_0x415846=_0x56a57e[_0x4240d3(0x1f7)]();_0x71f46f===_0x415846?(_0x5af15a[_0x4240d3(0x270)][_0x4240d3(0x21e)]=_0x4240d3(0x245),startChat()):_0x5af15a[_0x4240d3(0x270)][_0x4240d3(0x21e)]=_0x4240d3(0x2a1);});}const spamTimestamps=[];function sendMessage(){const _0x15e5ee=_0x3c11e2,_0x42c6db=document[_0x15e5ee(0x234)](_0x15e5ee(0x249)),_0x56e695=_0x42c6db[_0x15e5ee(0x207)][_0x15e5ee(0x247)]();if(!_0x56e695||isBlocked)return;const _0x58b943=Date[_0x15e5ee(0x239)]();spamTimestamps['push'](_0x58b943);const _0x3670d6=spamTimestamps[_0x15e5ee(0x1fb)](_0xb19cb6=>_0x58b943-_0xb19cb6<0x1b58);if(_0x3670d6[_0x15e5ee(0x213)]>0x5){isBlocked=!![],_0x42c6db['disabled']=!![],_0x42c6db['placeholder']=_0x15e5ee(0x280),alert(_0x15e5ee(0x2a0)),setTimeout(()=>{const _0x41fb17=_0x15e5ee;isBlocked=![],_0x42c6db[_0x41fb17(0x255)]=![],_0x42c6db['placeholder']=_0x41fb17(0x29f),spamTimestamps[_0x41fb17(0x213)]=0x0;},0x7530);return;}const _0x20f50e=localStorage[_0x15e5ee(0x22a)](_0x15e5ee(0x263))||'',_0x2a76e0=db[_0x15e5ee(0x241)]()[_0x15e5ee(0x1fc)]()[_0x15e5ee(0x278)];db['ref'](_0x15e5ee(0x246)+roomCode+_0x15e5ee(0x1f9)+_0x2a76e0)['set']({'msg':_0x56e695,'sender':username,'senderId':clientId,'avatarBase64':_0x20f50e,'timestamp':_0x58b943}),_0x42c6db[_0x15e5ee(0x207)]='',sendTyping(!![]),lastActivity=_0x58b943;}function listenForMessages(){const _0x6621a1=_0x3c11e2,_0x3d0592=db[_0x6621a1(0x241)](_0x6621a1(0x246)+roomCode+_0x6621a1(0x26e)),_0x37937e=_0x3d0592[_0x6621a1(0x23c)](MAX_MESSAGES);_0x37937e['on']('child_added',_0x305a51=>{const _0x51ee14=_0x6621a1,_0x305190=_0x305a51['val'](),{msg:_0x7c9c3d,sender:_0x17869e,senderId:_0x586b6b,timestamp:_0x327a46}=_0x305190,_0x2c6348=_0x586b6b===clientId,_0x52d145=_0x305190['audioUrl']||null,_0x20dde5=_0x305190[_0x51ee14(0x268)]||null;addMessage(_0x305190,_0x2c6348,_0x305a51[_0x51ee14(0x278)]),roomCode!==STATIC_ROOM&&db['ref']('rooms/'+roomCode+_0x51ee14(0x1f9)+_0x305a51['key'])[_0x51ee14(0x1f5)](),!_0x2c6348&&(sound[_0x51ee14(0x288)](),flagPageAttention());});}function addMessage(_0x4dd215,_0x488ba2,_0x22b501=null){const _0x32c7ef=_0x3c11e2,{msg:_0x52fb63,sender:_0x577cfa,senderId:_0xc34858,timestamp:_0xd9f58d,audioUrl:_0x5fc2ab,audioBase64:_0xc5fc98,imageBase64:_0x131ddd,avatarBase64:_0x26bd5f}=_0x4dd215,_0x559201=document[_0x32c7ef(0x294)](_0x32c7ef(0x21f));_0x559201['classList'][_0x32c7ef(0x289)]('msg',_0x488ba2?_0x32c7ef(0x22f):'received');const _0x3861a5=new Date(_0xd9f58d)[_0x32c7ef(0x229)]([],{'hour':_0x32c7ef(0x265),'minute':_0x32c7ef(0x265)}),_0x17f618=sanitizeUsername(_0x577cfa),_0x52b43f=roomUsers[_0x17f618]||{},_0x2f4ca2=_0x52b43f['avatarBase64']?_0x32c7ef(0x23f)+_0x52b43f[_0x32c7ef(0x283)]+_0x32c7ef(0x299):_0x32c7ef(0x275);let _0x51a156=_0x52fb63?.['replace'](new RegExp('@'+username+'\x5cb','gi'),_0x32c7ef(0x218)),_0x35733d=_0x2f4ca2+_0x32c7ef(0x23e)+_0x577cfa+_0x32c7ef(0x24c);_0x488ba2?_0x35733d+='<small>'+_0x3861a5+_0x32c7ef(0x277):_0x35733d+='<small>'+_0x3861a5+_0x32c7ef(0x26a);if(_0x5fc2ab)_0x35733d+=_0x32c7ef(0x293)+_0x5fc2ab+_0x32c7ef(0x274);else{if(_0xc5fc98){const _0x35b652=_0x32c7ef(0x20b)+_0xc5fc98;_0x35733d+=_0x32c7ef(0x293)+_0x35b652+_0x32c7ef(0x274);}else{if(_0x131ddd){const _0x4a7232=_0x32c7ef(0x2a8)+_0x131ddd;_0x35733d+=_0x32c7ef(0x287)+_0x4a7232+_0x32c7ef(0x224);}else _0x35733d+=_0x32c7ef(0x297)+_0x51a156+_0x32c7ef(0x201);}}_0x559201[_0x32c7ef(0x27a)]=_0x35733d;if(_0x52b43f[_0x32c7ef(0x25b)]){const _0x47f8ff=_0x559201[_0x32c7ef(0x222)](_0x32c7ef(0x24b));_0x47f8ff&&(_0x47f8ff[_0x32c7ef(0x27a)]+=_0x32c7ef(0x29d));}const _0x273cb6=document[_0x32c7ef(0x234)]('messages');_0x273cb6[_0x32c7ef(0x28d)](_0x559201),_0x273cb6[_0x32c7ef(0x220)]=_0x273cb6[_0x32c7ef(0x250)];}function cleanupOldRooms(){const _0x2a2078=_0x3c11e2;db[_0x2a2078(0x241)](_0x2a2078(0x25a))['once'](_0x2a2078(0x207))[_0x2a2078(0x2ab)](_0xf88d63=>{const _0x66b49e=_0x2a2078,_0x436635=_0xf88d63[_0x66b49e(0x1f7)]();if(!_0x436635)return;const _0x257ba3=Date[_0x66b49e(0x239)]();for(const _0x55f87d in _0x436635){if(_0x55f87d===STATIC_ROOM)continue;const _0x428bb9=_0x436635[_0x55f87d];_0x257ba3-(_0x428bb9[_0x66b49e(0x203)]||0x0)>0x2*0x3c*0x3e8&&db['ref'](_0x66b49e(0x246)+_0x55f87d)[_0x66b49e(0x1f5)]();}db['ref'](_0x66b49e(0x26c))[_0x66b49e(0x233)](_0x66b49e(0x207))[_0x66b49e(0x2ab)](_0x27e474=>{const _0x2c2ea9=_0x66b49e,_0x20d76f=_0x27e474[_0x2c2ea9(0x1f7)]();if(!_0x20d76f)return;for(const _0x4b5eef in _0x20d76f){if(_0x4b5eef!==STATIC_ROOM)db[_0x2c2ea9(0x241)]('antispam/'+_0x4b5eef)[_0x2c2ea9(0x1f5)]();}}),db[_0x66b49e(0x241)]('antispamBlocked')[_0x66b49e(0x233)]('value')['then'](_0x44d3a5=>{const _0x356e1b=_0x66b49e,_0x39f8ed=_0x44d3a5[_0x356e1b(0x1f7)]();if(!_0x39f8ed)return;for(const _0x9aae9b in _0x39f8ed){if(_0x9aae9b!==STATIC_ROOM)db[_0x356e1b(0x241)]('antispamBlocked/'+_0x9aae9b)[_0x356e1b(0x1f5)]();}});});}function _0x2e51(_0x189810,_0x67f0c9){const _0x5395e3=_0x5395();return _0x2e51=function(_0x2e5188,_0xcd5e5a){_0x2e5188=_0x2e5188-0x1f2;let _0x34a144=_0x5395e3[_0x2e5188];return _0x34a144;},_0x2e51(_0x189810,_0x67f0c9);}document[_0x3c11e2(0x282)](_0x3c11e2(0x1fe),()=>{const _0x528a46=_0x3c11e2,_0x3f4872=document['getElementById'](_0x528a46(0x249));_0x3f4872&&_0x3f4872[_0x528a46(0x282)](_0x528a46(0x231),function(_0x1222e4){const _0x5accd2=_0x528a46;_0x1222e4[_0x5accd2(0x278)]===_0x5accd2(0x24a)&&(_0x1222e4['preventDefault'](),sendMessage());});});function showScreen(_0x44e064){const _0x351750=_0x3c11e2;['usernameScreen',_0x351750(0x22c),'codeEntryScreen',_0x351750(0x267),_0x351750(0x271),_0x351750(0x1fd),_0x351750(0x25c)]['forEach'](_0x20ea35=>{const _0x564d23=_0x351750;document['getElementById'](_0x20ea35)['style'][_0x564d23(0x21e)]=_0x564d23(0x245);}),document['getElementById'](_0x44e064)[_0x351750(0x270)][_0x351750(0x21e)]=_0x351750(0x256);}function genRoomCode(){const _0x5a6ad4=_0x3c11e2,_0x2138d0=_0x5a6ad4(0x225),_0x2c88ff=_0x5a6ad4(0x20f),_0x28b157=(_0x5582d3,_0x525bb9)=>Array[_0x5a6ad4(0x266)]({'length':_0x525bb9},()=>_0x5582d3[Math['floor'](Math[_0x5a6ad4(0x236)]()*_0x5582d3[_0x5a6ad4(0x213)])])['join']('');return _0x28b157(_0x2c88ff,0x3)+_0x28b157(_0x2138d0,0x3)+_0x28b157(_0x2c88ff,0x2)+_0x28b157(_0x2138d0,0x2);}function _0x5395(){const _0x2bd902=['⛔\x20You\x27re\x20blocked\x20for\x20spamming\x20(30s)','\x0aDescription:\x20','addEventListener','avatarBase64','popstate','roomCodeInput','Failed\x20to\x20register\x20user\x20in\x20room.','<img\x20src=\x22','play','add','users/','\x20typing...','\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','appendChild','86cQCJYA','Room\x20doesn\x27t\x20exist\x20or\x20is\x20inactive.','hidden','active','files','<audio\x20controls\x20src=\x22','createElement','description',')\x20New\x20message\x20•\x20','<div>','roomDisplay','\x22\x20style=\x22width:28px;height:28px;border-radius:50%;margin-right:8px;vertical-align:middle;\x22>','pushState','1470528xvYDdW','<span\x20style=\x22margin-right:5px;\x22>👤</span>','\x20<span\x20style=\x22color:red;font-weight:bold;\x22>Admin</span>','ServerValue','Type\x20a\x20message...','⛔\x20You’ve\x20been\x20muted\x20for\x20spamming.\x20Please\x20wait\x2030\x20seconds.','block','sidebarAvatarPreview','TIMESTAMP','88DvKtUb','2169oieHuD','setItem','Session\x20expired.','data:image/png;base64,','get','exists','then','/typing/','audio/webm','\x20<span\x20style=\x22color:red;\x22>Admin</span>','easy-chatroom.firebasestorage.app','\x0a\x20\x20\x20\x20\x20\x20</li>','remove','You\x20can\x20change\x20your\x20profile\x20again\x20in\x20','val','211425LHNDgb','/messages/','readAsDataURL','filter','push','profileScreen','DOMContentLoaded','chat_username','mediaDevices','</div>','gr8stg','created','Profile\x20not\x20found.','userDisplay','740271DoNOCV','value','https://easy-chatroom-default-rtdb.firebaseio.com','getUserMedia','/typing','data:audio/webm;base64,','\x0aName:\x20','toUpperCase','lastChanged','0123456789','profile_description','profileError','#888','length','No\x20room\x20code\x20available\x20for\x20private\x20rooms','Microphone\x20permission\x20denied.','replace','91360UXSRfQ','<span\x20style=\x22color:#ff4081;\x22>@$&</span>','sidebarOpen','No\x20bio\x20set','passwordError','<li\x20style=\x22color:','userList','display','div','scrollTop','\x0aHistory:\x0a','querySelector','\x20minutes.','\x22\x20style=\x22max-width:100%;margin-top:5px;border-radius:10px;\x22\x20/>','ABCDEFGHIJKLMNOPQRSTUVWXYZ','profileContent','onlineStatus','catch','toLocaleTimeString','getItem','src','roomChoiceScreen','toLocaleString','050BBB66HH','sent','profiles/','keypress','values','once','getElementById','join','random','17638HkbzFE','database','now','contains','1263255nMmGEC','limitToLast','staticPasswordInput','<span\x20class=\x22sender-name\x22>','<img\x20src=\x22data:image/png;base64,','innerText','ref','\x0a\x20\x20\x20\x20','1:985049198428:web:d0eb7e2de39887710c9b99','ceil','none','rooms/','trim','profileUsernameInput','msgInput','Enter','.sender-name','</span>','map','update','Admins\x20only.','scrollHeight','volume','938760MDZztl',';cursor:pointer;display:flex;align-items:center;gap:6px;\x22\x20onclick=\x22viewProfile(\x27','substr','disabled','flex','split','[Voice\x20message]','data','rooms','admin','profileViewer','reload','Enter\x20a\x20valid\x20room\x20code','onloadend','initializeApp','result','onstop','avatar_base64','admins/','2-digit','from','chatScreen','audioBase64','set','</small>','easy-chatroom.firebaseapp.com','antispam','username','/messages','profileDescriptionInput','style','passwordScreen','lastOnline','namePreview','\x22\x20style=\x22width:100%;\x20max-width:100%;\x20margin-top:5px;\x22></audio>','<span\x20style=\x22margin-right:8px;\x22>👤</span>','🎙️','\x20·\x20✓✓</small>','key','title','innerHTML','classList','show','toString','Please\x20enter\x20both\x20a\x20username\x20and\x20a\x20description.','❌\x20Username\x20already\x20taken.'];_0x5395=function(){return _0x2bd902;};return _0x5395();}function startInactivityTimer(){setInterval(()=>{const _0x3136e6=_0x2e51;Date['now']()-lastActivity>0x5*0x3c*0x3e8&&roomCode!==STATIC_ROOM&&(db[_0x3136e6(0x241)]('rooms/'+roomCode)[_0x3136e6(0x24e)]({'active':![]}),alert(_0x3136e6(0x2a7)),location[_0x3136e6(0x25d)]());},0x7530);}function setupSidebarBackHandler(){const _0x4b1128=_0x3c11e2;window['addEventListener'](_0x4b1128(0x284),()=>{const _0x5b8967=_0x4b1128,_0x58fc4d=document[_0x5b8967(0x234)]('userSidebar');_0x58fc4d?.['classList'][_0x5b8967(0x23a)]('show')&&_0x58fc4d[_0x5b8967(0x27b)][_0x5b8967(0x1f5)](_0x5b8967(0x27c));});}function toggleSidebar(){const _0x10c13d=_0x3c11e2,_0x5c824c=document[_0x10c13d(0x234)]('userSidebar');if(!_0x5c824c[_0x10c13d(0x27b)][_0x10c13d(0x23a)](_0x10c13d(0x27c)))_0x5c824c['classList'][_0x10c13d(0x289)](_0x10c13d(0x27c)),history[_0x10c13d(0x29a)]({'sidebarOpen':!![]},'');else{_0x5c824c[_0x10c13d(0x27b)][_0x10c13d(0x1f5)]('show');if(history['state']?.[_0x10c13d(0x219)])history['back']();}}function setupVisibilityAttention(){const _0x404a65=_0x3c11e2;let _0x58e8ac=0x0,_0x46808d=document[_0x404a65(0x279)];document[_0x404a65(0x282)]('visibilitychange',()=>{const _0x2ca19d=_0x404a65;!document[_0x2ca19d(0x290)]&&(document[_0x2ca19d(0x279)]=_0x46808d,_0x58e8ac=0x0);}),window['flagPageAttention']=function(){const _0x1aa016=_0x404a65;document[_0x1aa016(0x290)]&&(_0x58e8ac++,document[_0x1aa016(0x279)]='('+_0x58e8ac+_0x1aa016(0x296)+_0x46808d);};}function tryEditProfile(){const _0x4975b7=_0x3c11e2,_0x1106db=sanitizeUsername(username);db['ref'](_0x4975b7(0x230)+_0x1106db)[_0x4975b7(0x2a9)]()['then'](_0x2f0134=>{const _0x56be9c=_0x4975b7,_0x327cbe=_0x2f0134[_0x56be9c(0x1f7)]();if(!_0x327cbe)return alert(_0x56be9c(0x204));const _0x2580ff=_0x327cbe[_0x56be9c(0x20e)]||0x0,_0x36594c=Date[_0x56be9c(0x239)](),_0x1c49e1=0x18*0x3c*0x3c*0x3e8;if(_0x36594c-_0x2580ff<_0x1c49e1){const _0x416256=Math[_0x56be9c(0x244)]((_0x1c49e1-(_0x36594c-_0x2580ff))/(0x3c*0x3e8));alert(_0x56be9c(0x1f6)+_0x416256+_0x56be9c(0x223));}else showScreen('profileScreen'),document[_0x56be9c(0x234)]('profileUsernameInput')['value']=username,document[_0x56be9c(0x234)]('profileDescriptionInput')[_0x56be9c(0x207)]=_0x327cbe['description']||'';});}function listenForUserList(){const _0x585c5c=_0x3c11e2;db[_0x585c5c(0x241)](_0x585c5c(0x28a)+roomCode)['on'](_0x585c5c(0x207),_0x38d343=>{const _0x4c5a01=_0x585c5c,_0x282ec9=_0x38d343[_0x4c5a01(0x1f7)]()||{};Object['entries'](_0x282ec9)['forEach'](([_0x3a5cf7,_0x566362])=>{roomUsers[sanitizeUsername(_0x566362['username'])]=_0x566362;});const _0x3e62df=Date[_0x4c5a01(0x239)](),_0x40301e=Object[_0x4c5a01(0x232)](_0x282ec9)[_0x4c5a01(0x24d)](_0x1144f2=>{const _0x383312=_0x4c5a01,_0xf72d64=_0x1144f2['online'],_0x2301e1=_0x3e62df-_0x1144f2[_0x383312(0x272)]<=0x1e*0x3c*0x3e8;if(!_0xf72d64&&!_0x2301e1)return'';const _0x4c22a6=_0xf72d64?'#00ff88':_0x383312(0x212),_0x137e2e=_0xf72d64?'🟢':'🕒',_0x5ad9e8=new Date(_0x1144f2[_0x383312(0x272)])['toLocaleTimeString']([],{'hour':_0x383312(0x265),'minute':'2-digit'}),_0x311b5d=_0x1144f2[_0x383312(0x283)]?_0x383312(0x23f)+_0x1144f2[_0x383312(0x283)]+'\x22\x20style=\x22width:24px;height:24px;border-radius:50%;margin-right:5px;vertical-align:middle;\x22>':_0x383312(0x29c),_0x18b9bd=_0x1144f2[_0x383312(0x25b)]?_0x383312(0x1f2):'';return _0x383312(0x21c)+_0x4c22a6+_0x383312(0x253)+sanitizeUsername(_0x1144f2[_0x383312(0x26d)])+_0x383312(0x28c)+_0x311b5d+_0x137e2e+'\x20'+_0x1144f2[_0x383312(0x26d)]+_0x18b9bd+_0x383312(0x1f4);})[_0x4c5a01(0x235)]('');document['getElementById'](_0x4c5a01(0x21d))[_0x4c5a01(0x27a)]=_0x40301e;});}function sendTyping(_0x5f516e=![]){const _0x7fad2=_0x3c11e2;if(isBlocked)return;const _0x293f96=_0x7fad2(0x246)+roomCode+_0x7fad2(0x2ac)+clientId;_0x5f516e?db[_0x7fad2(0x241)](_0x293f96)['remove']():(db[_0x7fad2(0x241)](_0x293f96)['set'](username),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{db['ref'](_0x293f96)['remove']();},0xbb8));}function listenForTyping(){const _0x3759f7=_0x3c11e2,_0x1569d7=document[_0x3759f7(0x234)]('typing');db[_0x3759f7(0x241)](_0x3759f7(0x246)+roomCode+_0x3759f7(0x20a))['on'](_0x3759f7(0x207),_0x123d64=>{const _0x13a28c=_0x3759f7,_0x4edca4=_0x123d64[_0x13a28c(0x1f7)]();if(!_0x4edca4)return _0x1569d7[_0x13a28c(0x240)]='';const _0x490961=Object[_0x13a28c(0x232)](_0x4edca4)[_0x13a28c(0x1fb)](_0x20a20d=>_0x20a20d!==username);_0x1569d7[_0x13a28c(0x240)]=_0x490961['length']?_0x490961[_0x13a28c(0x235)](',\x20')+_0x13a28c(0x28b):'';});}function trackPresence(){const _0x3ae555=_0x3c11e2;if(!username||!roomCode)return;const _0x26f8c0=sanitizeUsername(username),_0x4020c7=db[_0x3ae555(0x241)](_0x3ae555(0x28a)+roomCode+'/'+_0x26f8c0),_0x6cc439=localStorage['getItem'](_0x3ae555(0x263))||'',_0x58fab9={'username':username,'lastOnline':firebase[_0x3ae555(0x238)][_0x3ae555(0x29e)][_0x3ae555(0x2a3)],'online':!![],'avatarBase64':_0x6cc439};db[_0x3ae555(0x241)]('admins/'+roomCode+'/'+_0x26f8c0)[_0x3ae555(0x233)]('value')[_0x3ae555(0x2ab)](_0x111eea=>{const _0xec9d3e=_0x3ae555;if(_0x111eea[_0xec9d3e(0x2aa)]())_0x58fab9[_0xec9d3e(0x25b)]=!![];_0x4020c7[_0xec9d3e(0x269)](_0x58fab9),_0x4020c7['onDisconnect']()[_0xec9d3e(0x24e)]({'online':![],'lastOnline':Date['now']()}),updateOnlineIndicator();});}function uploadSidebarAvatar(_0x3c5b7d){const _0x19bcb2=_0x3c11e2;if(!_0x3c5b7d[_0x19bcb2(0x292)][_0x19bcb2(0x213)])return;const _0xd76db=new FileReader();_0xd76db[_0x19bcb2(0x25f)]=()=>{const _0x9729a5=_0x19bcb2,_0x2ced19=_0xd76db[_0x9729a5(0x261)][_0x9729a5(0x257)](',')[0x1];localStorage[_0x9729a5(0x2a6)](_0x9729a5(0x263),_0x2ced19);const _0x1270c6=document[_0x9729a5(0x234)](_0x9729a5(0x2a2));_0x1270c6[_0x9729a5(0x22b)]=_0x9729a5(0x2a8)+_0x2ced19,_0x1270c6['style'][_0x9729a5(0x21e)]=_0x9729a5(0x2a1),trackPresence();},_0xd76db[_0x19bcb2(0x1fa)](_0x3c5b7d['files'][0x0]);}function muteUser(_0x127af0,_0x23b0f6){const _0x32e2ea=_0x3c11e2;if(!isRoomAdmin)return alert(_0x32e2ea(0x24f));const _0x5c2792=Date[_0x32e2ea(0x239)]()+_0x23b0f6*0x3c*0x3e8;db['ref']('muted/'+roomCode+'/'+sanitizeUsername(_0x127af0))[_0x32e2ea(0x269)](_0x5c2792);}function unmuteUser(_0x1b7605){const _0x3bad43=_0x3c11e2;if(!isRoomAdmin)return alert(_0x3bad43(0x24f));db[_0x3bad43(0x241)]('muted/'+roomCode+'/'+sanitizeUsername(_0x1b7605))[_0x3bad43(0x1f5)]();}function updateOnlineIndicator(){const _0x4b29d8=_0x3c11e2,_0x3c13c0=document['getElementById'](_0x4b29d8(0x227));_0x3c13c0['innerText']='●\x20Online',_0x3c13c0[_0x4b29d8(0x270)]['color']='#00ff88';}setInterval(updateOnlineIndicator,0xbb8);function viewProfile(_0x10c01c){const _0x3dc0ad=_0x3c11e2;db['ref'](_0x3dc0ad(0x230)+_0x10c01c)[_0x3dc0ad(0x2a9)]()['then'](_0x16c2af=>{const _0x3c924c=_0x3dc0ad;if(!_0x16c2af[_0x3c924c(0x2aa)]())return;const _0x1c5ee0=_0x16c2af[_0x3c924c(0x1f7)](),_0x3f67db=(_0x3c924c(0x20c)+_0x1c5ee0[_0x3c924c(0x26d)]+_0x3c924c(0x281)+(_0x1c5ee0[_0x3c924c(0x295)]||_0x3c924c(0x21a))+_0x3c924c(0x221)+(_0x1c5ee0['usernameHistory']||[])[_0x3c924c(0x235)]('\x0a')+'\x0aLast\x20Changed:\x20'+new Date(_0x1c5ee0['lastChanged'])[_0x3c924c(0x22d)]()+_0x3c924c(0x242))[_0x3c924c(0x247)]();document['getElementById'](_0x3c924c(0x226))[_0x3c924c(0x240)]=_0x3f67db,document[_0x3c924c(0x234)](_0x3c924c(0x25c))[_0x3c924c(0x270)][_0x3c924c(0x21e)]=_0x3c924c(0x2a1);});}function initUsernameFlow(){const _0x19e85c=_0x3c11e2,_0x4242c8=localStorage['getItem']('chat_username');!_0x4242c8?showScreen(_0x19e85c(0x1fd)):(username=_0x4242c8,document[_0x19e85c(0x234)]('namePreview')[_0x19e85c(0x240)]=username,showScreen('roomChoiceScreen'));}function closeProfile(){const _0x14fd8b=_0x3c11e2;document['getElementById'](_0x14fd8b(0x25c))[_0x14fd8b(0x270)][_0x14fd8b(0x21e)]=_0x14fd8b(0x245);}